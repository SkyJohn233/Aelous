Profile Management | Citrixology As mentioned, this is going to be the baseline policy-set upon which you can build yours with any special policies pertaining to your environment, Also, all the settings that I have mentioned here may not be applicable or work for you due to parameters such as AV version, XenApp version etc etc. Please note that some of the settings found in newer UPM versions aren t listed here as well. I will continue to update it as Citrix releases new UPM versions but this should give you a good start nonetheless. Exclusion List   Directories Exclusion List   Files Directories to Synchronize Files to Synchronize Folders to Mirror Log Settings Log Settings                                                                                                Enabled Enable Logging                                                                                          Enabled Maximum size of the log file                                                                  Enabled Maximum size in bytes                                                                              10485760 Profile Handling Delay before deleting cached profiles                                                  Enabled Delay(Seconds)                                                                                          0 Delete locally cached profiles on logoff                                               Enabled Local profile conflict handling                                                              Enabled If both a local Windows user profile and a  Citrix user profile in the user store both exist:                                  Delete local profile Registry Exclusion List Streamed user profiles Always cache                                                                                                 Enabled  Cache files this size or larger (megabytes):                                             1 Profile streaming                                                                                          Enabled  Streamed user profile groups                                                                    Disabled  Timeout for pending area lock files (days)                                             Enabled Timeout for pending area lock files (days)                                              1 Advanced settings Disable automatic configuration                                                              Disabled  Number of retries when accessing locked files                                     Enabled Number of retries:                                                                                       5  Process Internet cookie files on logoff                                                    Enabled  Profile Management Active write back                                                                                         Enabled  Enable Profile management                                                                      Enabled  Excluded groups                                                                                          Disabled  Path to user store                                                                                         Enabled Process logons of local administrators                                                   Enabled  Processed groups                                                                                        Disabled Issue Manifestation  Delay of 20-25 seconds on   Please wait for Citrix User Profile Manager  and this was consistent. Remediation  Turn ON Citrix Profile Streaming I am partially to blame for this issue as I had turned OFF Profile Streaming when I had my users complaining that the  logoff  was taking a little while. Now i need to figure out what is causing the logoffs to take roughly 10 seconds to complete. Already looked at the AV side of things and i have the required Exclusions. Hunt continues and will update with the findings.. So that s a quick one there for you guys and hopefully someone will find it useful. If you find it working/not working for you, let me know This command will: Close the slow logon user session and the admin logon session opened in step 2 as required. IMPORTANT: The double “-stop” call in step 5 is not a typo but is required. The first  -stop  terminates kernel tracing. The second  -stop  terminates user mode tracing. Note: You can also stop the trace by using  Switch User  to return to the admin user logon established in step #2 and running the same XPERF stop command in the elevated command prompt used to start the trace. This results in a larger, longer trace and requires that you discern the different logons encapsulated in the trace. Double Click the merged.etl file to open it in Windows Performance Analyzer ( Ensure that you have the Windows Performance Toolkit Installed on the computer that you are opening the file from) I am now going to talk about one of our customer environments where that had a Citrix XenApp 6.5 deployment and the user logons used to be around 90 sec. I agree that this isn t such a bad situation to be as I have seen even worser logon times. The customer environment consists of the below The users complain that the screen will sit at  Welcome  screen for approx 30 sec after which the logon moves faster and towards the end , there is a further delay after  Preparing the Desktop First things first, during these situations AV will be the first to be blamed. Decided to stop the AV service and turned off Real Time scanning to rule that out. Tried to login with a test account and it is the same 90 +secs Tools at my disposal ( the customer has got a platinum XenApp License, so they own a lot of good stuff)  XPerf is a super cool tool to troubleshoot slow logon/boot up times alongside Citrix UPM logs. Autoruns does help to selectively stop all or some logon processes and thus should not be overlooked when troubleshooting long logon times. I will try to include more XPerf tracing and analysis in my future blog posts. I will talk to you in my next post. Time for another quick write-up. I was asked by one of my customers to enable Excel add ins for a selected bunch of users. These users need access to TM1 and SUN Financial plugins which are a bit slow to load so it doesn t make sense to have this plugin available to all the users. The environment is based on   XenApp 7.5  site with  Windows Server 2008 R2 Hosted Shared  desktops and apps. Microsoft Excel 2010 is the where the add in needs to be integrated. create a  REG_SZ  value and name it OPEN. The value is the path of the Excel Add in in quotes. if you have multiple add ins, call it OPEN1, OPEN2 and so on Please note that if the Office software is 64 bit, the above must be done on the  WOW6432Node   and also the version # of Excel/Office changes with a different Ms Office suite. I used Excel 2010 which is 14 There might also be cases where the plugins need to be selectively removed from automatic launch in Excel and for that, the relevant registry keys could be removed via group policy preferences. This methodology can also be applied to non-Citrix environments and VDI solutions Managing user profiles  in VDI or RDS environments is challenging, but user profile management tools are here to help. Profile management packages from the major desktop virtualization vendors tend to be very robust and easy to use. Windows Active Directory comes with basic user profile management by default, and it is easy to use but not very functional. More advanced tools allow for a variety of settings, including multi-environment configurations, database back ends, intelligent profiling and much more. But there are also lesser-known tools out there   some of which are free   that always seem to come through in a pinch. In the list below, I have included extra notes for ones that I ve used personally or seen put to use, but please refer to each vendor s website for more information. Now, let us take a look at some great  user profile management  tools along with tips to keep those pesky  profiles  in line. AppSense Environment Manager . This tool is at the top of the product food chain. I have seen it used at a lot of shops, but it s very complex and comes with some administrative overhead. RES Software Workspace Manager . This tool s profile management piece is just a small part of a much larger product. It falls right in line with AppSense in terms of quality, administration and  complexity for smaller shops. Workspace Manager is a widely used product with a large feature set. TriCerat Inc. s SimplyProfiles . It is sold as a standalone product or as a component in TriCerat s SimplifySuite. This application includes some cool technology called Profile Acceleration, which basically takes your profiles and virtualizes them. Immidio Flex+ . This tool is one of the better user profile management options I have used. It s easy to administrate, comes with good support, and it s lightweight and doesn t add a lot of complexity to the environment. Citrix Systems Inc. s User Profile Management (UPM) . This is included with XenApp and was previously called Sepago Profiler. It uses shared file locations and  ADM files  (as do many others), but it is basic and pretty much focused on XenApp and XenDesktop. How to  delete user profiles Challenges with  VDI user personas Why user profiles are a  VDI annoyance Liquidware Labs Inc. s ProfileUnity FlexApp . Many administrators say this is the most scalable user profile management tool. It manages more than 10,000 profiles in a single interface and includes application and patch management features. ForensiT Ltd. s User Profile Manager . Simple and lightweight, this tool is geared more toward the small and medium-sized businesses market and has a basic feature set that will get most small shops by. Scense Live Profiles . I have not seen this tool in the wild yet, but it looks promising with low admin overhead and appears quite easy to use. VMware Inc. s View Persona Management . Persona Management came with View 5 and is only for use with VMware View. There are some smaller user profile management tools that can be used in conjunction with the more complete software packages listed above. Here is a sampling of options that can complement those packages: DelProf2 by Helge Klien . This free tool is a de facto standard for user profile management with older Windows XP-based clients. (It does not work with Windows 7 or later.) DelProf2 deletes inactive user profiles, with additional filtering if necessary, and is usually set as a scheduled task on the server. Microsoft s User Profile Hive Cleaner . If you re still running remote or virtual desktops on Windows Server 2003 (or, God forbid, Server 2000), you need this tool. It installs as a service to clean up leftover profile matter after a user logs off. Server 2008 and later versions have it built in. ForensiT User Profile Wizard . This free profile migration tool quickly and easily migrates thousands of profiles from one domain to another. Sepago GmbH s Profile Migrator . This is a trial offering with almost the same features as the ForensiT User Profile Wizard, but Sepago s has a cost. The company also has another free tool,  Profile Nurse , which performs registry and file operations across multiple or all profiles at one time. An example would be to add a registry key to a select group of profiles for one purpose, while adding a different key to others for the same purpose. TZWorks LLC  Yaru . The product s name stands for Yet Another Registry Utility (yaru). With this little utility, you can open profile registry hives and perform a multitude of tasks on them including reporting, export and forensics. It s a staple in my admin toolbox. RegShot . A free, open source project, this tool allows you to take before and after snapshots of a user profile registry to see what the differences are. Scooter Software Inc. s Beyond Compare . This is an awesome application that does more than just registry and file comparisons. I have used it a hundred different ways. Not only does it compare files, but it also compares complete directories, including users  profile directories. Please find the original article  here                      Follow                     