Using cipher.exe to decrypt EFS encrypted file N.B. Maiden post in this environment.  Please be kind to me (and I'll try to reciprocate!) >< p> This question was relocated from Microsoft Community. If there is a more appropriate location, please let me know. >I worked in IT for 40 years, some of which was in Microsoft Support in the company where I worked. So, it sort of fits here.<br >Because of my IT background I can find the easy answers myself. This question has that obscure ring. I'm having a battle with cipher.exe in my quest to decrypt all the EFS encrypted files on my system. First, let's get a list of all the encrypted files on my local disks:  cipher.exe /u /n  >  cipher.temp Inside the file cipher.temp is the line: F:\Backups\$user\tools\tee.exe In explorer, I navigate to this file where I see: tee.exe (in green, the sign of an encrypted file) So I execute the command:  cipher.exe -d F:\Backups\$user\tools\tee.exe The output is as follows C:\$User\Tools > cipher.exe -d  F:\Backups\$user\tools\tee.exe Listing C:\$User\Tools\ New files added to this directory will not be encrypted. Listing F:\Backups\$user\tools\ New files added to this directory will not be encrypted. E tee.exe C:\$User\Tools > Now, what does that  " E "  on the last line of output signify? Error? Well, the file is still encrypted, so that's probable. Let's try adding the -a switch, which causes cipher.exe to operate on files as well as directories: C:\$User\Tools > cipher.exe -d -a F:\Backups\$user\tools\tee.exe Listing C:\$User\Tools\ New files added to this directory will not be encrypted. Listing C:\$User\Tools\ New files added to this directory will not be encrypted. Listing F:\Backups\$user\tools\ New files added to this directory will not be encrypted. E tee.exe C:\$User\Tools > No progress there. Where next? Well, let's do it through the GUI, in explorer.  1. Open the properties of tee.exe 2. Click Advanced... 3. Clear the check against  " Encrypt contents to secure  data " 4. Click OK twice 5. tee.exe is no longer encrypted. So it wasn't protected in any way. So why did cipher fail? P.S.  I discovered that I could use cipher.exe to decrypt my files by working out all of the directories which contained EFS encrypted files, then using the command syntax:  cipher.exe /d [directory path]\* Since my objective was to decypher all of my EFS files (so I could make a couple of changes which might conceivably revoke my access) I no longer have any encrypted files to experiment with. So, my question(s) above are now mostly hypothetical. I'm still curious though. The circumstances that led up to this were unusual, and it would be nice to shed some light onto what happened (my userid got converted from Local Account to Microsoft Account, and that started the ball rolling) >< p> ><br > Edited by Steve.J.Swift Wednesday, July 19, 2017 4:10 PM Added P.S. section Wednesday, July 19, 2017 3:50 PM                         Reply                     |                         Quote                                     All replies             text/html 7/20/2017 2:46:45 AM Teemo Tang 0 0 Sign in to vote Hi Steve, I have tested your command on my computer for many times, no result. So I can’t reproduce your scenario for test. In my opinion, we just need to use  cipher /u  command, then it will list encrypted folders and files if system owns. Next, use  cipher /a /d /s:directory path  command to decrypt folder and files. I use this way successfully many times, there is a Microsoft document introducing detailed information, have a look. https://technet.microsoft.com/en-us/library/bb490878.aspx Regards Please remember to  mark the replies as answers  if they help. >If you have feedback for TechNet Subscriber Support, contact <a href="mailto:tnmff@microsoft.com">tnmff@microsoft.com< a>. I created a lengthy reply which contained neither images nor links, but couldn't get past the prompt reminding me that these weren't allowed until my account was verified. Then we can have a  " Spot the image or link "  game. Yes, if you want to upload a picture in the post to make explanation more clear, you need to verify your forum account. Please check the document I mentioned in last reply, smart as you, can use correct parameter to encrypt or decrypt files.  Please remember to  mark the replies as answers  if they help. >If you have feedback for TechNet Subscriber Support, contact <a href="mailto:tnmff@microsoft.com">tnmff@microsoft.com< a>. In my opinion, we just need to use  cipher /u  command, then it will list encrypted folders and files if system owns. >< span> Next, use  cipher /a /d /s:directory path  command to decrypt folder and files. >< span> I use this way successfully many times, there is a Microsoft document introducing detailed information, have a look. >< span> >< p> I used your suggestion quite a few times during this episode, so much so that I eventually created a Decrypt_All script to do it automatically. ><br >Incidentally, the background to all of this was a series of unexpected events. Read on if you're interested: ><br >1. I'd been prompted for a schedule to apply a really big Windows Update, but had yet to do anything about this. >2. When I got to my PC early one morning, it was already applying the update.<br >3. I couldn't logon to my  " Steve "  userid, as unbeknown to me it had been converted to Microsoft Account. >4. When I realised that I had to use my Microsoft Account, the password that I had for it didn't work.<br >5. When I tried to reset the password for the Microsoft Account, it repeatedly said that it had succeeded, but the new password didn't work. At this time my ISP was experiencing catastrophic session drops, followed by immediate re-connections. I didn't notice any, but this is probably related. >6. Perhaps the most unexpected event: After about three days my MS Account password was successfully reset, and access to my EFS files was intact. This marked the period where cipher.exe would not decrypt a few individual files. But the GUI worked on every one I tried. But it got tedious, hence this post.<br > >I've found a raft of documentation on cipher.exe; I'd still like to understand what that &quot;E&quot; prefix was all about. It may be documented if I'm lucky (I usually am). It accompanied every failure to decrypt, whereas the &quot;U&quot; prefix accompanied only successful un-encryptions. We can make our own choices what that might mean. :-) &nbsp;<br > >Please remember to mark the replies as answers if they help.<br >If you have feedback for TechNet Subscriber Support, contact tnmff@microsoft.com. >< div>                         Thursday, July 20, 2017 1:19 PM                         Reply                     |                         Quote                     text/html 7/21/2017 1:37:26 AM Teemo Tang 0 0 Sign in to vote Ok, thing sounds interesting, I didn’t expected that you have made it by a decrypt script, great. There are some of my understanding, for your reference only. cipher /u  This option is used to find all the encrypted files on the local drives, and will update the user's file encryption key or recovery keys of the encrypted files to use the current keys if changed since encrypted. cipher /u /n  This option is used to find all the encrypted files on the local drives, and will not  update the encryption keys. If you add this sentence after above command:  >  %UserProfile%\Desktop\EncryptedFiles.txt You will now have a EncryptedFiles.txt file on your desktop with a list of all encrypted files in system. cipher /e  : Encrypts the specified folders. Folders are marked so that files that are added to the folder later are encrypted too. Regards Please remember to  mark the replies as answers  if they help. >If you have feedback for TechNet Subscriber Support, contact <a href="mailto:tnmff@microsoft.com">tnmff@microsoft.com< a>. The syntax for the Cipher should be as below. cipher [/e | /d | /c] [/s: < Directory > ] [/b] [/h] [PathName [...]] cipher /k cipher /r: < FileName >  [/smartcard] cipher /u [/n] cipher /w: < Directory > cipher /x[:efsfile] [FileName] cipher /y cipher /adduser [/certhash: < Hash >  | /certfile: < FileName > ] [/s:Directory] [/b] [/h] [PathName [...]] cipher /removeuser /certhash: < Hash >  [/s: < Directory > ] [/b] [/h] [ < PathName >  [...]] cipher /rekey [PathName [...]] However, I noticed that the command you used to decrypt file is:  cipher.exe -d  F:\Backups\$user\tools\tee.exe Since the cipher.exe cannot recognize the -d, it ran without parameters and displayed the encryption status of each of the files and subdirectories in the current directory. Encrypted files and directories are marked with an E. Unencrypted files and directories are marked with a U Please remember to  mark the replies as answers  if they help. >If you have feedback for TechNet Subscriber Support, contact <a href="mailto:tnmff@microsoft.com">tnmff@microsoft.com< a>. please help me answering this question.. i have done data encryption for my files in windows 7 , 32bit, the files were in drive E: and i have formatted the drive C:, so I have no backup keys for the EFS, and no certificates >< p> and now am unable to decrypt my files or reach them any more. is there any way I can take my files back.. they means a lot for me. please give me a positive answer.. And I will be so thankful. regards 