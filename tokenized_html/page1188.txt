a runge–kutta discontinuous galerkin method for the euler equations sciencedirect sciencedirect this paper presents a runge–kutta discontinuous galerkin rkdg method for the euler equations of gas dynamics from the viewpoint of kinetic theory like the traditional gas-kinetic schemes our proposed rkdg method does not need to use the characteristic decomposition or the riemann solver in computing the numerical flux at the surface of the finite elements the integral term containing the non-linear flux can be computed exactly at the microscopic level a limiting procedure is carefully designed to suppress numerical oscillations it is demonstrated by the numerical experiments that the proposed rkdg methods give higher resolution in solving problems with smooth solutions moreover shock and contact discontinuities can be well captured by using the proposed methods this paper is concerned with the construction of high-order runge–kutta discontinuous galerkin rkdg methods for the euler equations of gas dynamics the euler equations governing inviscid compressible fluid flows can be written in the following compact form 1.1 ∂ u ∂ t +∑ i=1 d ∂ f i u ∂ x i =0 where d is the space dimension x x 1 … x d and the conversion vector u and flux f i u are given by 1.2 u= ρ ρu 1 ⋯ ρu d e f i u ρu i ρu 1 u i +δ 1 i p ⋯ ρu d u i +δ d i p u i e+p in 1.2 ρ is the fluid density u u 1 … u d t is the fluid velocity vector p is the fluid pressure e=ρ e+ 1 2 u 2 is the total energy u 2 u 1 2 +⋯+ u d 2 and δ i j is the kronecker delta for an ideal gas the thermal energy is related to the gas pressure through the relation 1.3 p= γ−1 ρe where γ is the ratio of the specific heats the first discontinuous galerkin dg finite element method was introduced by reed and hill 19 to solve a steady-state linear hyperbolic equation such as σu+ div a ̄ u =f where σ is a real number and ā a constant vector a major development of the dg method was carried out by cockburn and co-workers 8 9 10 13 14 in a series of papers in 8 a general framework is established for the one dimensional case an analysis of the accuracy and stability in terms of total variation is also given there in 14 the rkdg method is applied to one-dimensional systems the multidimensional extension of rkdg methods is given in 10 13 in 13 a slope limiter is first designed on general triangulations it maintains a high order of accuracy in smooth regions and guarantees maximum norm stability jiang and shu 15 proved that the dg method for the scalar case satisfies a local cell entropy inequality for the square entropy for arbitrary triangulations in any space dimension and for any order of accuracy their results with shocks imply l 2 stability of the method for non-linear problems in the scalar case in 1 atkins and shu gave a quadrature-free implementation of discontinuous galerkin methods for hyperbolic equations in order to avoid the use of discrete quadrature formulas they have shown that a quadrature-free rkdg requires less computational time and storage than conventional implementations but preserves the compactness and robustness inherent in the rkdg methods in 32 zhou et al gave a numerical comparison of weno finite volume and runge–kutta discontinuous galerkin methods when the solutions to 1.1 are smooth or have weak discontinuities they can be resolved by using the rkdg methods without further modification however if the discontinuities are strong the rkdg methods will generate significant oscillations and even non-linear instability to avoid such difficulties typically a limiting procedure is used after each runge–kutta inner stage or after some complete runge–kutta steps many types of limiters have been proposed for example the minmod type limiters used by cockburn and co-workers 8 9 10 13 14 the moment-based limiters proposed by biswas et al 3 and the more recent one given by burbeau et al 4 however when the limiters are applied to the problem containing a stronger discontinuity e.g rayleigh–taylor instability problem it may heavily diffuse the interface 18 like typical finite element methods the rkdg methods are better suited than finite difference methods to handle complicated geometries and arbitrary triangulations due to the discontinuous nature of the solution and the test function space the solution is marched explicitly in time moreover they can easily handle adaptivity strategies and parallel implementation due to their compactness and local communications for these reasons they have been widely used in practical applications some examples can be found in 3 18 we also refer the reader to several review papers and lecture notes e.g 7 11 12 and reference therein in the past few years the development of gas-kinetic schemes for compressible flow simulations such as the kinetic flux-vector splitting kfvs scheme and the bgk-type scheme has become mature the gas-kinetic schemes have provided robust and accurate numerical solutions for various unsteady compressible flows see 16 17 24 25 26 30 31 and references therein some theoretical analysis has also been carried out for the gas-kinetic schemes see e.g 27 28 etc the purpose of this paper is to construct a quadrature-free rkdg method with higher-order accuracy for the euler equations from the viewpoint of gas-kinetic theory like the traditional gas-kinetic schemes the present rkdg method does not need the characteristic decomposition and the riemann solver in computing the numerical flux at the surface of the finite elements the integral term containing the non-linear flux can be computed exactly at the microscopic level moreover a limiting procedure is carefully designed that preserves the accuracy in smooth regions and limits oscillations near the discontinuities some numerical experiments are conducted to validate the accuracy of the scheme and to demonstrate its ability in capturing discontinuities the paper is organized as follows in section 2 we give a brief review of the gas-kinetic theory that will be used in this paper in section 3 we construct the dg spatial discretization for the euler equations which is quadrature-free at both microscopic and macroscopic levels then a fully high-order accurate dg method is obtained by using higher-order runge–kutta methods to discretize the resulting semi-discrete system in time a limiting procedure is designed in section 4 numerical results will be reported in section 5 some concluding remarks will be made in section 6 fundamental to fluid mechanics is the microscopic description which is based on the particle motion or statistical description of a fluid due to the large number of particles in small volume in common situations to follow each one is impossible instead a continuous distribution f x t v is often used to describe the probability of particles to be located in a certain velocity interval and to approximate the particle number density at a certain velocity the distribution function f x t v is a basic unknown in the kinetic theory of gases and obeys a particle transport equation known as the boltzmann equation which may be written in the following form 2.1 ∂ f ∂ t +∑ d i=1 v i ∂ f ∂ x i =j f f where v v 1 … v d t denotes the particle velocity and the right-hand side term j f f represents a particle collision term which is in a complex integral form in this paper we are not interested in the detailed formulation of the collision term because it will vanish in the case we consider now the thermodynamic aspect of hydrodynamical equations is based on the assumption that departure of the gas from a local equilibrium state is sufficiently small the real distribution function f x t v is usually unknown in the real flow situation but in classical physics we know a special distribution function i.e maxwellian distribution function corresponding to a local equilibrium state if the mass momentum and energy densities of the gas are known for this distribution the collision term vanishes we refer the reader to 5 6 for a detailed description of the gas-kinetic theory the maxwellian distribution g can be defined as follows 2.2 g x t v =ρ λ π k+d /2 e −λ v − u 2 +ξ 2 where k denotes the total number of degrees of freedom in the internal degree of freedom variable ξ λ m /2 kt m denotes the particle mass k is the boltzmann constant and t is the fluid temperature and v − u 2 =∑ d i=1 v i −u i 2 ξ 2 =∑ k i=1 ξ 2 i in a two-dimensional flow of a diatomic gas with γ= 7 5 the random particle motion in the z -direction is included into the internal variable ξ and k is equal to 3 to account for the particle motion in the z -direction and two rotational degrees of freedom for an ideal gas the relations λ ρ /2 p and k =− d +2/ γ −1 are available the relation between the macroscopic variables with the distribution functions f and g is as follows 2.3 u=∫ r k+d ψf x t v d v d ξ=∫ r k+d ψg x t v d v d ξ where ψ denotes the vector of moments defined as 2.4 ψ= 1 v 1 … v d 1 2 v 2 +ξ 2 t and d v d ξ= d v 1 ⋯ d v d d ξ 1 ⋯ d ξ d denotes the volume element in the phase space thus the euler equation 1.1 can be recast as follows 2.5 ∂ ∂ t ∫ r k+d ψg x t v d v d ξ+∑ d i=1 ∂ ∂ x i ∫ r k+d v i ψg x t v d v d ξ=0 the kfvs scheme is established based on 2.5 the main idea is to integrate 2.5 over a finite control volume in the physical space and to approximate the numerical fluxes at the surface of the control volume according to the sign of the normal component of the particle velocity on the other hand as shown in 17 the kfvs scheme can also be considered as a moment in terms of ψ of the upwind scheme of the following collisionless boltzmann equation 2.6 ∂ g ∂ t +∑ d i=1 v i ∂ g ∂ x i =0 in the next section we will construct dg space discretization for the euler equation 1.1 based on 2.6 this subsection is concerned with the dg spatial discretization for 1.1 in one-space dimension i.e 3.1 ∂ u ∂ t ∂ f u ∂ x =0 where the conservative vector u and the corresponding flux f are of the form 3.2 u= ρ ρu e f u ρu ρu 2 p u e+p for this special case the moment vector is reduced to ψ= 1 v 1 2 v 2 +ζ 2 for a given partition of the physical domain x j j∈ z we set i j+ 1 2 x j x j+1 h j+ 1 2 =x j+1 −x j and x j+ 1 2 1 2 x j+1 +x j for all j∈ z our purpose is to seek an approximation u h to u such that for each time t∈ 0 t u h t belongs to the finite dimensional space 3.3 v q h v∈l 1 r v x ∈p q i j+ 1 2 if x∈i j+ 1 2 ∀j∈ z where p q i j+ 1 2 denotes the space of polynomials on i j+ 1 2 of degree at most q for the sake of simplicity we will choose the legendre polynomials p l s as local basis functions then we can exploit sufficiently their l 2 -orthogonality 3.4 ∫ 1 −1 p l s p l ′ s d s= 2 2l+1 δ l l ′ l⩽l ′ to obtain a diagonal mass matrix for x∈ r we now may express our approximate solution u h as follows 3.5 u h x t =∑ q i=0 u l j+ 1 2 t φ l j+ 1 2 x =u j+ 1 2 x t if x∈i j+ 1 2 where 3.6 φ l j+ 1 2 x =p l ξ ξ= 2 x−x j+ 1 2 h j+ 1 2 in order to get a quadrature-free dg space discretization we define for the local equilibrium distribution g the l 2 -projection g h onto v q h to obtain 3.7 g h x t v =∑ q l=0 g l j+ 1 2 t φ l j+ 1 2 x g j+ 1 2 x t v if x∈i j+ 1 2 the microscopic degrees of freedom g l j+ 1 2 t can be determined by the macroscopic degrees of freedom u l j+ 1 2 t according to the moment relation 2.3 and the l 2 -orthogonality of the local basis functions in other words we may establish a relation between the macroscopic and microscopic degrees of freedom u l j+ 1 2 t and g l j+ 1 2 t taking the moments of g h in terms of ψ gives 3.8 ∑ q l=0 u l j+ 1 2 t φ l j+ 1 2 x =∑ q l=0 ∫ r k+1 ψg l j+ 1 2 t φ l j+ 1 2 x d v d ξ multiply 3.8 by φ l ′ j+ 1 2 x and using the l 2 -orthogonality of the legendre polynomials we get 3.9 u l j+ 1 2 t =∫ r k+1 ψg l j+ 1 2 t d v d ξ l=0 … q these are implicit relations between the microscopic and macroscopic degrees of freedom u l j+ 1 2 t and g l j+ 1 2 t the microscopic degrees of freedom g l j+ 1 2 t for l ⩾1 can be considered as the corresponding slopes of g h x t v they depend on the particle velocities and can be obtained from the taylor expansion of a maxwellian see 30 31 to obtain explicit formulas we do the following first for l =0 we define 3.10 g 0 j+ 1 2 =ρ 0 j+ 1 2 t λ 0 j+ 1 2 π k+1 /2 e −λ 0 j+ 1 2 v−u 0 j+ 1 2 2 +ξ 2 next using ideas from high resolution gas-kinetic bgk schemes of xu we expand the microscopic degrees of freedom g l j+ 1 2 t for l ⩾1 in the following form 3.11 g l j+ 1 2 =g 0 j+ 1 2 1·a l 1 +v·a l 2 1 2 v 2 +ξ 2 ·a l 3 substituting this into 3.9 gives a 3 × 3 linear system 3.12 1 u e u u 2 p ̃ u e p ̃ e u e p ̃ e 2 +2 e p ̃ − p ̃ γ−1 x 1 x 2 x 3 =u l j+ 1 2 t y 1 y 2 y 3 where x i ρa l i p ̃ =p/ρ e =e/ρ its solutions can be obtained in an explicit form as follows 3.13 x 3 γ−1 p ̃ 2 u 2 2 y 1 −uy 2 +y 3 − 1 p ̃ y 1 x 2 1 p ̃ y 2 −uy 1 −ux 3 x 1 1+ u 2 p ̃ y 1 − u p ̃ y 2 − p ̃ γ−1 − u 2 2 x 3 remark 3.1 in eqs we have omitted the subscript j+ 1 2 and the superscript 0 of the macroscopic variables the expansion given in 3.11 does not influence the accuracy of the scheme it will be validated by our numerical experiments in the following we will establish a weak formulation to determine the approximate solution u h we multiply 2.6 by an arbitrary test function v h from the finite element space v g h integrate it over the finite element i j+ 1 2 j∈ z and replace the exact solution g by its approximation g h ∈ v g h 3.14 d d t ∫ i j+ 1 2 g h x t v v h x d x+∫ i j+ 1 2 v ∂ ∂ x g h x t v v h x d x=0 ∀v h x ∈ v g h using a simple formal integration by parts and taking v h x =φ l j+ 1 2 x gives 3.15 h j+ 1 2 2l+1 d d t g l j+ 1 2 +vg h φ l j+ 1 2 x x j+1 x j =∫ i j+ 1 2 vg h x t v d d x φ l j+ 1 2 x d x for all j∈ z and l =0 … q since the function g h x t v is discontinuous at the points x j j∈ z we must replace the fluxes vg h x j +1 t v and vg h x j t v by numerical fluxes that depend on the two values of g h at the points x j +1 t and x j t respectively it is more robust to give a numerical flux at the interface of the element i j+ 1 2 according to the sign of the particle velocity v for example 3.16 vg h x j t v ≈ vg j− 1 2 x j t v v 0 vg j+ 1 2 x j t v v 0 thus using the local transformation ξ= 2 x−x j+ 1 2 h j+ 1 2 and the property of the legendre polynomials that p l 1 =1 and p l −1 −1 l we have the following weak formulation at the microscopic level 3.17 h j+ 1 2 2l+1 d d t g l j+ 1 2 +v g j+ 1 2 x j+1 t v +v − g j+ 3 2 x j+1 t v − −1 l v g j− 1 2 x j t v +v − g j+ 1 2 x j t v =∫ 1 −1 vg h ξ t v d d ξ φ l j+ 1 2 ξ d ξ for all j∈ z and l =0,1 … q where v ± 1 2 v±|v| at the microscopic level the integral terms in 3.17 can be computed exactly as an example we give them for a special case of q =3 as follows 3.18 h j+ 1 2 d d t g 0 j+ 1 2 v g j+ 1 2 x j+1 t v +v − g j+ 3 2 x j+1 t v −v g j− 1 2 x j t v −v − g j+ 1 2 x j t v =0 3.19 h j+ 1 2 3 d d t g 1 j+ 1 2 v g j+ 1 2 x j+1 t v +v − g j+ 3 2 x j+1 t v +v g j− 1 2 x j t v +v − g j+ 1 2 x j t v =2vg 0 j+ 1 2 3.20 h j+ 1 2 5 d d t g 2 j+ 1 2 v g j+ 1 2 x j+1 t v +v − g j+ 3 2 x j+1 t v −v g j− 1 2 x j t v −v − g j+ 1 2 x j t v =2vg 1 j+ 1 2 3.21 h j+ 1 2 7 d d t g 3 j+ 1 2 v g j+ 1 2 x j+1 t v +v − g j+ 3 2 x j+1 t v +v g j− 1 2 x j t v +v − g j+ 1 2 x j t v =2v g 0 j+ 1 2 +g 2 j+ 1 2 finally taking the moments of in terms of ψ we get a weak formulation at the macroscopic level that is to say the approximate solution u h given by the dg space discretization is defined as the solution of the moments of 3.17 i.e 3.22 h j+ 1 2 d d t u 0 j+ 1 2 +f j+ 1 2 −f j− 1 2 +f − j+ 3 2 −f − j+ 1 2 =0 3.23 h j+ 1 2 3 d d t u 1 j+ 1 2 +f j+ 1 2 +f j− 1 2 +f − j+ 3 2 +f − j+ 1 2 =2f 0 j+ 1 2 3.24 h j+ 1 2 5 d d t u 2 j+ 1 2 +f j+ 1 2 −f j− 1 2 +f − j+ 3 2 −f − j+ 1 2 =2f 1 j+ 1 2 3.25 h j+ 1 2 7 d d t u 3 j+ 1 2 +f j+ 1 2 +f j− 1 2 +f − j+ 3 2 +f − j+ 1 2 =2 f 0 j+ 1 2 +f 2 j+ 1 2 where f ± j+ 1 2 =∫ r k+1 v ψg j+ 1 2 x j+1 t v d v d ξ=∑ q l=0 f l j+ 1 2 f − j+ 1 2 =∫ r k+1 v − ψg j+ 1 2 x j+1 t v d v d ξ=∑ q l=0 −1 l f − l j+ 1 2 and f ± l j+ 1 2 =∫ r k+1 v ± ψg l j+ 1 2 d v d ξ f l j+ 1 2 =∫ r k+1 vψg l j+ 1 2 d v d ξ the fluxes f ± l j+ 1 2 and f 0 l j+ 1 2 =f l j+ 1 2 can be represented as f ν l =ρ a l 1 v 1 ν +a l 2 v 2 ν +a l 3 v 3 ν a l 1 v 2 ν +a l 2 v 3 ν +a l 3 v 4 ν a l 1 v 3 ν +a l 2 v 4 ν +a l 3 v 5 ν where the subscript ν =− or or 0 a 0 1 a 0 2 a 0 3 1,0,0 and v 3 ν 1 2 v 3 ν v 1 ν ξ 2 v 4 ν 1 2 v 4 ν v 2 ν ξ 2 v 5 ν 1 4 v 5 ν +2 v 3 ν ξ 2 v 1 ν ξ 4 in the above the moments are given as follows ξ 2 k 2λ ξ 4 k k+2 4λ 2 v 0 0 =1 v 1 0 =u v 0 ± 1 2 erfc ∓ λ u v 1 ± =u v 0 ± ± 1 2 πλ e −λu 2 v n+2 ν =u v n+1 ν n+1 2λ v n ν n=0,1 … where the subscript ν represents 0 − or and the complementary error function erfc x is generally a given internal function in fortran or matlab this subsection will extend dg spatial discretization to two-dimensional case in order to simplify the explanation of the scheme we restrict our attention to a rectangular partition of the computational domain in the following we set x x 1 x 2 ≡ x y and i j+ 1 2 k+ 1 2 x j x j+1 × y k y k+1 for finite elements h 1 j+ 1 2 =x j+1 −x j h 2 k+ 1 2 =y k+1 −x k x j+ 1 2 1 2 x j+1 +x j and y k+ 1 2 1 2 y k+1 +y k for all j k∈ z and seek an approximation u h to u such that for each time t∈ 0 t u h belongs to the finite dimensional space 3.26 v 1 h v x ∈ span p 0 x p 1 x p 2 x x ∈i j+ 1 2 k+ 1 2 ∀j k∈ z where p 0 x =1 p 1 x =2 x−x j+ 1 2 /h 1 j+ 1 2 p 2 x =2 y−y k+ 1 2 /h 2 k+ 1 2 thus we may express our approximation solution u h as follows u h x t =u 0 j+ 1 2 k+ 1 2 t +u 1 j+ 1 2 k+ 1 2 t p 1 x +u 2 j+ 1 2 k+ 1 2 t p 2 x x ∈i j+ 1 2 k+ 1 2 and define l 2 -projection g h of the local equilibrium distribution g onto v 1 h by 3.27 g h x t v =g 0 j+ 1 2 k+ 1 2 t +g 1 j+ 1 2 k+ 1 2 t p 1 x +g 2 j+ 1 2 k+ 1 2 t p 2 x x ∈i j+ 1 2 k+ 1 2 similarly an implicit relation between the macroscopic and microscopic degrees of freedom u l j+ 1 2 k+ 1 2 t and g l j+ 1 2 k+ 1 2 t can be given as follows 3.28 u l j+ 1 2 k+ 1 2 t =∫ r k+2 ψg l j+ 1 2 k+ 1 2 t d v d ξ l=0,1,2 in order to give explicit formulas for g l j+ 1 2 k+ 1 2 t we define 3.29 g 0 j+ 1 2 k+ 1 2 t =ρ 0 j+ 1 2 k+ 1 2 λ 0 j+ 1 2 k+ 1 2 π k+2 /2 e −λ 0 j+ 1 2 k+ 1 2 v − u 0 j+ 1 2 k+ 1 2 2 +ξ 2 and expand the microscopic degrees of freedom g l j+ 1 2 k+ 1 2 t for l ⩾1 in the following form 3.30 g l j+ 1 2 k+ 1 2 t =g 0 j+ 1 2 k+ 1 2 t 1·a l 1 +v 1 ·a l 2 +v 2 ·a l 3 1 2 v 2 +ξ 2 ·a l 4 from we may derive a 4×4 linear system 1 u 1 u 2 e u 1 u 1 2 p ̃ u 1 u 2 u 1 e p ̃ u 2 u 1 u 2 u 2 2 p ̃ u 2 e p ̃ e u 1 e p ̃ u 2 e p ̃ e 2 +2 e p ̃ − p ̃ γ−1 x 1 x 2 x 3 x 4 =u l j+ 1 2 k+ 1 2 t y 1 y 2 y 3 y 4 solving it gives 3.31 x 4 γ−1 p ̃ 2 u 2 2 y 1 −u 1 y 2 −u 2 y 3 +y 4 − 1 p ̃ y 1 x 3 1 p ̃ y 3 −u 2 y 1 −u 2 x 4 x 2 1 p ̃ y 2 −u 1 y 1 −u 1 x 4 x 1 1+ u 2 p ̃ y 1 − u 1 p ̃ y 2 − u 2 p ̃ y 3 − p ̃ γ−1 − u 2 2 x 4 where x i ρa l i p ̃ =p/ρ e =e/ρ in the following we will establish a weak formulation for the approximate solution u h we multiply 2.6 by an arbitrary test function v h from the finite element space v 1 h integrate it over the finite element i j+ 1 2 k+ 1 2 j k∈ z and replace the exact solution g by its approximation g h ∈ v 1 h 3.32 ∂ ∂ t ∫ i j+ 1 2 k+ 1 2 v h x g h x t v d x +∫ i j+ 1 2 k+ 1 2 v 1 ∂ g h x t v ∂ x +v 2 ∂ g h x t v ∂ y v h x d x =0 ∀v h x ∈ v 1 h using a simple formal integration by parts gives 3.33 ∂ ∂ t ∫ i j+ 1 2 k+ 1 2 v h x g h x t v d x +∫ ∂ i j+ 1 2 k+ 1 2 v n g h x t v v h x d s=∫ i j+ 1 2 k+ 1 2 g h x t v v 1 ∂ v h x ∂ x +v 2 ∂ v h x ∂ y d x or equivalently 3.34 ∂ ∂ t ∫ i j+ 1 2 k+ 1 2 v h x g h x t v d x +∫ y k+1 y k v 1 g h x j+1 y t v v h x j+1 y d y−∫ y k+1 y k v 1 g h x j y t v v h x j y d y+∫ x j+1 x j v 2 g h x y k+1 t v v h x y k+1 d x−∫ x j+1 x j v 2 g h x y k t v v h x y k d x=∫ i j+ 1 2 k+ 1 2 g h x t v v 1 ∂ v h x ∂ x +v 2 ∂ v h x ∂ y d x for all j k∈ z where v n v 1 n x v 2 n y and n n x n y denotes the outward unit normal to d s according to the sign of the particle velocity v i we may approximate the fluxes v 1 g h x j y t v and v 2 g h x y k t v as follows v 1 g h x j y t v ≈ v 1 g j− 1 2 k+ 1 2 x j y t v v 1 0 v 1 g j+ 1 2 k+ 1 2 x j y t v v 1 0 v 2 g h x y k t v ≈ v 2 g j+ 1 2 k− 1 2 x y k t v v 2 0 v 2 g j+ 1 2 k+ 1 2 x y k t v v 2 0 taking v h x p i x i =0,1,2 respectively we have the following weak formulation at the microscopic level 3.35 h 1 j+ 1 2 h 2 k+ 1 2 d d t g 0 j+ 1 2 k+ 1 2 +h 2 k+ 1 2 v 1 g 0 +g 1 j+ 1 2 k+ 1 2 +v − 1 g 0 −g 1 j+ 3 2 k+ 1 2 −v 1 g 0 +g 1 j− 1 2 k+ 1 2 −v − 1 g 0 −g 1 j+ 1 2 k+ 1 2 +h 1 j+ 1 2 v 2 g 0 +g 2 j+ 1 2 k+ 1 2 +v − 2 g 0 −g 2 j+ 1 2 k+ 3 2 −v 2 g 0 +g 2 j+ 1 2 k− 1 2 +v − 2 g 0 −g 2 j+ 1 2 k+ 1 2 =0 3.36 h 1 j+ 1 2 h 2 k+ 1 2 3 d d t g 1 j+ 1 2 k+ 1 2 +h 2 k+ 1 2 v 1 g 0 +g 1 j+ 1 2 k+ 1 2 +v − 1 g 0 −g 1 j+ 3 2 k+ 1 2 +v 1 g 0 +g 1 j− 1 2 k+ 1 2 +v − 1 g 0 −g 1 j+ 1 2 k+ 1 2 h 1 j+ 1 2 3 v 2 g 1 j+ 1 2 k+ 1 2 +v − 2 g 1 j+ 1 2 k+ 3 2 −v 2 g 1 j+ 1 2 k− 1 2 −v − 2 g 1 j+ 1 2 k+ 1 2 =2h 2 k+ 1 2 v 1 g 0 j+ 1 2 k+ 1 2 3.37 h 1 j+ 1 2 h 2 k+ 1 2 3 d d t g 2 j+ 1 2 k+ 1 2 +h 1 j+ 1 2 v 2 g 0 +g 2 j+ 1 2 k+ 1 2 +v − 2 g 0 −g 2 j+ 1 2 k+ 3 2 +v 2 g 0 +g 2 j+ 1 2 k− 1 2 +v − 2 g 0 −g 2 j+ 1 2 k+ 1 2 h 2 j+ 1 2 3 v 1 g 2 j+ 1 2 k+ 1 2 +v − 1 g 2 j+ 3 2 k+ 1 2 −v 1 g 2 j− 1 2 k+ 1 2 −v − 1 g 2 j+ 1 2 k+ 1 2 =2h 1 j+ 1 2 v 2 g 0 j+ 1 2 k+ 1 2 finally taking their moments in terms of ψ we get a weak formulation at the macroscopic level as follows 3.38 h 1 j+ 1 2 h 2 k+ 1 2 d d t u 0 j+ 1 2 k+ 1 2 +h 2 k+ 1 2 f 1 0 +f 1 1 j+ 1 2 k+ 1 2 f 1 − 0 −f 1 − 1 j+ 3 2 k+ 1 2 − f 1 0 +f 1 1 j− 1 2 k+ 1 2 − f 1 − 0 −f 1 − 1 j+ 1 2 k+ 1 2 +h 1 j+ 1 2 f 2 0 +f 2 2 j+ 1 2 k+ 1 2 f 2 − 0 −f 2 − 2 j+ 1 2 k+ 3 2 − f 2 0 +f 2 2 j+ 1 2 k− 1 2 − f 2 − 0 −f 2 − 2 j+ 1 2 k+ 1 2 =0 3.39 h 1 j+ 1 2 h 2 k+ 1 2 3 d d t u 1 j+ 1 2 k+ 1 2 +h 2 k+ 1 2 f 1 0 +f 1 1 j+ 1 2 k+ 1 2 f 1 − 0 −f 1 − 1 j+ 3 2 k+ 1 2 f 1 0 +f 1 1 j− 1 2 k+ 1 2 f 1 − 0 −f 1 − 1 j+ 1 2 k+ 1 2 h 1 j+ 1 2 3 f 2 1 j+ 1 2 k+ 1 2 f 2 − 1 j+ 1 2 k+ 3 2 − f 2 1 j+ 1 2 k− 1 2 − f 2 − 1 j+ 1 2 k+ 1 2 =2h 2 k+ 1 2 f 1 0 j+ 1 2 k+ 1 2 3.40 h 1 j+ 1 2 h 2 k+ 1 2 3 d d t u 2 j+ 1 2 k+ 1 2 +h 1 j+ 1 2 f 2 0 +f 2 2 j+ 1 2 k+ 1 2 f 2 − 0 −f 2 − 2 j+ 1 2 k+ 3 2 f 2 0 +f 2 2 j+ 1 2 k− 1 2 f 2 − 0 −f 2 − 2 j+ 1 2 k+ 1 2 h 2 j+ 1 2 3 f 1 2 j+ 1 2 k+ 1 2 f 1 − 2 j+ 3 2 k+ 1 2 − f 1 2 j− 1 2 k+ 1 2 − f 1 − 2 j+ 1 2 k+ 1 2 =2h 1 j+ 1 2 f 2 0 j+ 1 2 k+ 1 2 where f i ± l j+ 1 2 k+ 1 2 =∫ r k+2 v ± i ψg l j+ 1 2 k+ 1 2 d v d ξ f i l j+ 1 2 k+ 1 2 =∫ r k+2 v i ψg l j+ 1 2 k+ 1 2 d v d ξ i=1,2 the fluxes f i ± l and f i 0 l f l i can be represented as f ν l 1 =ρ a l 1 v 1 1 ν +a l 2 v 1 2 ν +a l 3 v 1 1 ν v 1 2 0 +a l 4 v 1 3 ν a l 1 v 1 2 ν +a l 2 v 1 3 ν +a l 3 v 1 2 ν v 1 2 0 +a l 4 v 1 4 ν a l 1 v 1 1 ν v 1 2 0 +a l 2 v 1 2 ν v 1 2 0 +a l 3 v 1 1 ν v 2 2 0 +a l 4 v 1 3 ν v 1 2 0 a l 1 v 1 3 ν +a l 2 v 1 4 ν +a l 3 v 1 3 ν v 1 2 0 +a l 4 v 1 5 ν and f ν l 2 =ρ a l 1 v 2 1 ν +a l 2 v 2 1 ν v 1 1 0 +a l 3 v 2 2 ν +a l 4 v 2 3 ν a l 1 v 2 1 ν v 1 1 0 +a l 2 v 2 1 ν v 2 1 0 +a l 3 v 2 2 ν v 1 1 0 +a l 4 v 2 3 ν v 1 1 0 a l 1 v 2 2 ν +a l 2 v 2 2 ν v 1 1 0 +a l 3 v 2 3 ν +a l 4 v 2 4 ν a l 1 v 2 3 ν +a l 2 v 2 3 ν v 1 1 0 +a l 3 v 2 4 ν +a l 4 v 2 5 ν where the subscript ν =− or or 0 a 0 1 a 0 2 a 0 3 a 0 4 1,0,0,0 and v 1 3 ν 1 2 v 1 3 ν v 1 1 ν v 2 2 0 ξ 2 v 1 4 ν 1 2 v 1 4 ν v 1 2 ν v 2 2 0 ξ 2 v 1 5 ν 1 4 v 1 5 ν +2 v 1 3 ν v 2 2 0 ξ 2 v 1 1 ν v 2 4 0 +2 v 2 2 0 ξ 2 ξ 4 the definition of v 2 k ν can be given similarly which will be omitted here to discretize our systems of ordinary differential equations ode e.g or we use the higher-order runge–kutta time discretizations as shown by cockburn in 7 when polynomials of degree q are used a runge–kutta method of order q +1 must be used in order to guarantee that the scheme is stable in this paper we will use a third-order tvd runge–kutta scheme of shu and osher 21 when solving a non-smooth problem and a fourth-order non-tvd runge–kutta scheme for solving smooth problems more precisely if we rewrite ode system in a compact form u ′ t l u then the third-order tvd runge–kutta scheme is of the form 3.41 u 1 =u n δ tl u n u 2 3 4 u n 1 4 u 1 1 4 δ tl u 1 u n+1 1 3 u n 2 3 u 2 2 3 δ tl u 2 while the fourth-order non-tvd runge–kutta scheme is of the form 3.42 u 1 =u n 1 2 δ tl u n u 2 =u n 1 2 δ tl u 1 u 3 =u n δ tl u 2 u n+1 1 3 u 1 +2u 2 +u 3 −u n 1 2 δ tl u 3 it is known that if the solution discontinuities are strong then the rkdg methods will generate significant oscillations and even non-linear instability to fix this typically a local projection or non-linear limiter should be used after each runge–kutta inner stage or after some complete runge–kutta steps a limiter in a higher-order numerical scheme should satisfy the following two requirements • non-oscillatory sharp resolution of discontinuities and recover the full formal order of accuracy away from the discontinuities thus we can approximate the degrees of freedom for u l j+ 1 2 by using the differences of the lower degrees of freedom as follows u 1 j+ 1 2 − 3 2 u 3 j+ 1 2 1 2 h ∂ u h ∂ x x j+ 1 2 t ≈ 1 2 ψ δ u 0 j+ 1 2 δ − u 0 j+ 1 2 u 2 j+ 1 2 h 6 ∂ ∂ x h 2 ∂ u h ∂ x x j+ 1 2 t ≈ 1 6 ψ δ u 1 j+ 1 2 − 3 2 u 3 j+ 1 2 δ − u 1 j+ 1 2 − 3 2 u 3 j+ 1 2 u 3 j+ 1 2 h 10 ∂ ∂ x h 2 12 ∂ 2 u h ∂ x 2 x j+ 1 2 t ≈ 1 10 ψ δ u 2 j+ 1 2 δ − u 2 j+ 1 2 where ψ a b is a suitable weight function δ and δ − denote the forward and backward difference operators respectively because u l j+ 1 2 o h l l =0 … q we can simplify the above approximation to the degrees of freedom u l j+ 1 2 our limiting procedure is given as follows following shu x27 s tvb idea 20 for l =0 … q we define 4.2 u l new j+ 1 2 u l old j+ 1 2 if u l old j+ 1 2 ⩽m l h l+1 ψ 1 u l old j+ 1 2 u l j+ 1 2 otherwise where m l is a problem-dependent constant and 4.3 u l j+ 1 2 1 2 2l−1 ψ 2 δ u l−1 j+ 1 2 δ − u l−1 j+ 1 2 in the weight or limiter functions ψ 1 a b and ψ 2 a b are chosen as ψ 1 a b 0 ab⩽0 sign a min |a| |b| ab 0 ψ 2 a b 0 ab⩽0 sign a max min α|a| |b| min |a| α|b| ab 0 where α is a given constant taken generally as 1 or 2 for our computations in this section we will use our rkdg method to solve the euler equations of gas dynamics throughout our computations we take γ =1.4 in 1.3 we first test the accuracy of the schemes for the one-dimensional system the fourth-order runge–kutta method 3.42 will be employed in this case m l =50∼160 and the time step size δ t n is determined by the following cfl restriction 5.1 δ t n ⩽ 1 2q+1 min j h j+ 1 2 max j u n j+ 1 2 +c n j+ 1 2 where c= γp/ρ denotes the sound speed example 5.1 the first problem we consider is to solve initial value problem of the euler equation 2.2 with the initial data ρ x,0 =1+0.2 sin π x u x,0 =0.7 p x,0 =1 the computational domain is taken as 0,2 and the periodic boundary condition is used this problem has the exact solution in the following form ρ x t =1+0.2 sin π x−ut u x t =0.7 p x t =1 we compute the solution up to t =2 the errors and numerical orders of accuracy for the density ρ obtained by using the present rkdg method without limiters are shown in table 1 table 2 table 3 table 4 table 5 the errors of the solution are measured here by a very refined quadrature inside each cell the results show that a q +1 th-order rate of convergence can be obtained for q =1,2 even though the limiting procedure is used see e.g table 3 the rate of convergence for q =3 seems unsatisfactory which will be further investigated our code can be downloaded from ftp //162.105.69.120/tanghz/dg1d02.zip table 1 the errors and convergence order for solutions at t =2 calculated by using p 0 based rkdg method table 2 same as table 1 except for q =1 table 3 same as table 2 except with limiter table 4 same as table 1 except for q =2 table 5 same as table 1 except for q =3 next we check the ability of shock capturing for the proposed schemes the third-order runge–kutta method 3.41 will be adopted example 5.2 this example is to solve sod x27 s shock tube problem the domain is taken as 0,1 which is divided into 100 cells the initial data are ρ u p 1,0,1 x 0.4 0.125,0,0.1 x⩾0.4 we output the solutions at t =0.2 which consists of a left rarefaction wave a contact discontinuity and a right moving weak shock fig 1 fig 2 fig 3 show the density the pressure the velocity and the internal energy obtained by the rkdg method with or without using a limiting procedure it is seen that the shock is resolved almost exactly by our rkdg method and the resolution of the contact discontinuous is improved as q is increased although numerical oscillation becomes serious in the same time after a limiting procedure is used the numerical oscillation can been essentially suppressed while the shock is still well-resolved although the resolution of the contact waves is slightly decreased fig 1 comparison of the computed solutions circle with the exact solutions the solution at t =0.2 is obtained by p 1 based rkdg method with 100 grid cells top the limiter is not used bottom a limiter is used fig 2 same as fig 1 except for q =2 fig 3 same as fig 1 except for q =3 example 5.3 this example is to solve the lax shock tube problem within the domain 0,1 with the following initial data ρ ρu e 0.445,0.311,8.928 x 0.5 0.5,0,1.4275 x⩾0.5 the final solution output is at t =0.14 with 100 cells it consists of a left rarefaction wave a contact discontinuity and a right moving shock since the shock in this example is stronger than that in the sod x27 s shock tube problem the numerical oscillation becomes more serious without using a limiting procedure fig 4 shows the solutions of the density pressure velocity and internal energy obtained by using the rkdg method with a limiting procedure fig 4 comparison of the computed solutions circle with the exact solutions the solution at t =0.14 is obtained by p q based rkdg method with 100 grid cells top q =1 middle q =2 and bottom q =3 example 5.4 the third example is to solve the problem of shu and osher 22 which describes the interaction of an entropy sine wave with a mach 3 righting moving shock the domain is taken as −5,5 and the initial data are ρ u p 3.857143,2.629369,10.33333 x −4 1+0.2 sin 5x ,0,1 x⩾−4 as in 22 the final time is t =1.8 since the exact solution for this problem is unknown we consider the numerical solution with 3000 cells as the exact solution it is obtained by the muscl kfvs finite volume method with van leer limiter fig 5 shows the density the pressure the velocity and the internal energy calculated by the p q q =1,2,3 based rkdg method with a limiting procedure and 400 cells we can see that the high frequencies are well-represented and the compression waves and the shock are well-captured fig 5 comparison of the computed solutions circle with the exact solutions the solution at t =1.8 is obtained by p q based rkdg method with 400 grid cells top q =1 middle q =2 bottom q =3 finally we implement the rkdg method for two-dimensional ramp problem this problem has been solved by several authors see e.g. 10 29 example 5.5 the ramp problem is solved on the domain x ∈ 0,4 × 0,1 with t running from 0 to 0.2 the point 1 6 ,0 corresponds to the corner of the ramp and points x ,0 with x 1 6 lie on the sloping part of the ramp initially a mach 10 planar shock at an angle of 60° with the x -axis is located at h x t 3 x− 1 6 −20t the left and right states are taken as u l 8,57.1597 −33.0012,563.544 t u r 1.4,0,0,2.5 t the boundary conditions are u 0 y t =u l u 4 y t =u r u x,1 t u l x ⩽ x s u r x x s the reflecting boundary condition is specified for the points x ,0 with x 1 6 fig 6 shows density contours with 30 equally spaced contour lines that are obtained on uniform meshes with h 1 =h 2 1 120 and h 1 =h 2 1 240 respectively fig 6 density contours for the ramp problem top h 1 =h 2 1 120 bottom h 1 =h 2 1 240 the results reported in this section can be compared favorably with those obtained by using other high resolution schemes see e.g. 29 32 and the adaptive grid methods see e.g. 2 18 23 in this paper we have presented a runge–kutta discontinuous galerkin rkdg method for the euler equations of gas dynamics from the viewpoint of gas-kinetic theory like the traditional gas-kinetic schemes the proposed rkdg method is characteristic decomposition free and riemann solver free since the integral term containing the non-linear flux can be computed exactly at the microscopic level when the solutions to the euler equations are either smooth or have weak discontinuities they can be resolved by our rkdg methods very efficiently without using any limiting procedure however if the discontinuities are strong then the rkdg methods will generate significant oscillations and even non-linear instability a limiting procedure is added in our rkdg methods to fix this problem the accuracy and efficiency of the proposed methods are demonstrated by several numerical examples we would like to thank professor chi-wang shu of brown university and dr tie zhou of peking university for numerous discussions during the preparation of this work and the referees for many useful suggestions this research was partially supported by the special funds for major state basic research projects of china the national natural science foundation of china the alexander von humboldt foundation and the project longtime behavior of non-linear hyperbolic systems of conservation laws and their numerical approximation contract dfg wa 633/7-2 elsevier we use cookies to help provide and enhance our service and tailor content and ads by continuing you agree to the use of cookies copyright © 2019 elsevier b.v. or its licensors or contributors sciencedirect ® is a registered trademark of elsevier b.v