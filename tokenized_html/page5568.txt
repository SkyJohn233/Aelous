profile management citrixology as mentioned this is going to be the baseline policy-set upon which you can build yours with any special policies pertaining to your environment also all the settings that i have mentioned here may not be applicable or work for you due to parameters such as av version xenapp version etc etc please note that some of the settings found in newer upm versions aren t listed here as well i will continue to update it as citrix releases new upm versions but this should give you a good start nonetheless exclusion list directories exclusion list files directories to synchronize files to synchronize folders to mirror log settings log settings enabled enable logging enabled maximum size of the log file enabled maximum size in bytes 10485760 profile handling delay before deleting cached profiles enabled delay seconds 0 delete locally cached profiles on logoff enabled local profile conflict handling enabled if both a local windows user profile and a citrix user profile in the user store both exist delete local profile registry exclusion list streamed user profiles always cache enabled cache files this size or larger megabytes 1 profile streaming enabled streamed user profile groups disabled timeout for pending area lock files days enabled timeout for pending area lock files days 1 advanced settings disable automatic configuration disabled number of retries when accessing locked files enabled number of retries 5 process internet cookie files on logoff enabled profile management active write back enabled enable profile management enabled excluded groups disabled path to user store enabled process logons of local administrators enabled processed groups disabled issue manifestation delay of 20-25 seconds on please wait for citrix user profile manager and this was consistent remediation turn on citrix profile streaming i am partially to blame for this issue as i had turned off profile streaming when i had my users complaining that the logoff was taking a little while now i need to figure out what is causing the logoffs to take roughly 10 seconds to complete already looked at the av side of things and i have the required exclusions hunt continues and will update with the findings.. so that s a quick one there for you guys and hopefully someone will find it useful if you find it working/not working for you let me know this command will close the slow logon user session and the admin logon session opened in step 2 as required important the double -stop call in step 5 is not a typo but is required the first -stop terminates kernel tracing the second -stop terminates user mode tracing note you can also stop the trace by using switch user to return to the admin user logon established in step 2 and running the same xperf stop command in the elevated command prompt used to start the trace this results in a larger longer trace and requires that you discern the different logons encapsulated in the trace double click the merged.etl file to open it in windows performance analyzer ensure that you have the windows performance toolkit installed on the computer that you are opening the file from i am now going to talk about one of our customer environments where that had a citrix xenapp 6.5 deployment and the user logons used to be around 90 sec i agree that this isn t such a bad situation to be as i have seen even worser logon times the customer environment consists of the below the users complain that the screen will sit at welcome screen for approx 30 sec after which the logon moves faster and towards the end there is a further delay after preparing the desktop first things first during these situations av will be the first to be blamed decided to stop the av service and turned off real time scanning to rule that out tried to login with a test account and it is the same 90 +secs tools at my disposal the customer has got a platinum xenapp license so they own a lot of good stuff xperf is a super cool tool to troubleshoot slow logon/boot up times alongside citrix upm logs autoruns does help to selectively stop all or some logon processes and thus should not be overlooked when troubleshooting long logon times i will try to include more xperf tracing and analysis in my future blog posts i will talk to you in my next post time for another quick write-up i was asked by one of my customers to enable excel add ins for a selected bunch of users these users need access to tm1 and sun financial plugins which are a bit slow to load so it doesn t make sense to have this plugin available to all the users the environment is based on xenapp 7.5 site with windows server 2008 r2 hosted shared desktops and apps microsoft excel 2010 is the where the add in needs to be integrated create a reg_sz value and name it open the value is the path of the excel add in in quotes if you have multiple add ins call it open1 open2 and so on please note that if the office software is 64 bit the above must be done on the wow6432node and also the version of excel/office changes with a different ms office suite i used excel 2010 which is 14 there might also be cases where the plugins need to be selectively removed from automatic launch in excel and for that the relevant registry keys could be removed via group policy preferences this methodology can also be applied to non-citrix environments and vdi solutions managing user profiles in vdi or rds environments is challenging but user profile management tools are here to help profile management packages from the major desktop virtualization vendors tend to be very robust and easy to use windows active directory comes with basic user profile management by default and it is easy to use but not very functional more advanced tools allow for a variety of settings including multi-environment configurations database back ends intelligent profiling and much more but there are also lesser-known tools out there some of which are free that always seem to come through in a pinch in the list below i have included extra notes for ones that i ve used personally or seen put to use but please refer to each vendor s website for more information now let us take a look at some great user profile management tools along with tips to keep those pesky profiles in line appsense environment manager this tool is at the top of the product food chain i have seen it used at a lot of shops but it s very complex and comes with some administrative overhead res software workspace manager this tool s profile management piece is just a small part of a much larger product it falls right in line with appsense in terms of quality administration and complexity for smaller shops workspace manager is a widely used product with a large feature set tricerat inc. s simplyprofiles it is sold as a standalone product or as a component in tricerat s simplifysuite this application includes some cool technology called profile acceleration which basically takes your profiles and virtualizes them immidio flex+ this tool is one of the better user profile management options i have used it s easy to administrate comes with good support and it s lightweight and doesn t add a lot of complexity to the environment citrix systems inc. s user profile management upm this is included with xenapp and was previously called sepago profiler it uses shared file locations and adm files as do many others but it is basic and pretty much focused on xenapp and xendesktop how to delete user profiles challenges with vdi user personas why user profiles are a vdi annoyance liquidware labs inc. s profileunity flexapp many administrators say this is the most scalable user profile management tool it manages more than 10,000 profiles in a single interface and includes application and patch management features forensit ltd. s user profile manager simple and lightweight this tool is geared more toward the small and medium-sized businesses market and has a basic feature set that will get most small shops by scense live profiles i have not seen this tool in the wild yet but it looks promising with low admin overhead and appears quite easy to use vmware inc. s view persona management persona management came with view 5 and is only for use with vmware view there are some smaller user profile management tools that can be used in conjunction with the more complete software packages listed above here is a sampling of options that can complement those packages delprof2 by helge klien this free tool is a de facto standard for user profile management with older windows xp-based clients it does not work with windows 7 or later delprof2 deletes inactive user profiles with additional filtering if necessary and is usually set as a scheduled task on the server microsoft s user profile hive cleaner if you re still running remote or virtual desktops on windows server 2003 or god forbid server 2000 you need this tool it installs as a service to clean up leftover profile matter after a user logs off server 2008 and later versions have it built in forensit user profile wizard this free profile migration tool quickly and easily migrates thousands of profiles from one domain to another sepago gmbh s profile migrator this is a trial offering with almost the same features as the forensit user profile wizard but sepago s has a cost the company also has another free tool profile nurse which performs registry and file operations across multiple or all profiles at one time an example would be to add a registry key to a select group of profiles for one purpose while adding a different key to others for the same purpose tzworks llc yaru the product s name stands for yet another registry utility yaru with this little utility you can open profile registry hives and perform a multitude of tasks on them including reporting export and forensics it s a staple in my admin toolbox regshot a free open source project this tool allows you to take before and after snapshots of a user profile registry to see what the differences are scooter software inc. s beyond compare this is an awesome application that does more than just registry and file comparisons i have used it a hundred different ways not only does it compare files but it also compares complete directories including users profile directories please find the original article here follow