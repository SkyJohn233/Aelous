oracle service bus java callouts with xmlobjects oracle .. java .. opensource .. soa jmmate javablog bookmark in the oracle service bus we can make use of java callouts to invoke plain java basically there aren t any restrictions on the the input and output parameters of the static methods there are 2 situations which will differ in the way we get the data returned back from the java callout see this return primitives strings or xmlobjects from the java callout in this case we can just retrieve the data from the body variable and execute xpath expressions on it to immediately get the value of the payload return anything else in this case we will get back a java ref identifier back from the java callout executing xpath expressions on the body will only give use a reference to the java object to be able to use the data in the java object we can only pass it to other java callouts in this blog i will show an example of how to generate a xmlobject mentioned as one of the return types in case 1 if we re able to generate this kind of object from the java callout osb will just be able to retrieve this in the body variable and let us execute xpath expression on it we will be using xml beans to generate the java artifacts based on a employee schema definition these artificats we will be using in our static method to generate the employee java objects which represents our employee entity definition from the xsd schema read this and this to get a quickstart on xml beans run the ant build script based on the xml namespace of the employee xsd object it will generate the same package structure for the java objects verify if it generated the next list of objects and if it also generated the file employeexmlbeans.jar in the lib folder now we re able to retrieve data from the variable just by using the xpath expressions and re-use it in the rest of the message flow source url http //www.xenta.nl/blog/2011/08/29/oracle-service-bus-java-callouts-with-xmlobjects/ awesome thank a lot for sharing your knowlegde hi eric thanks for the nice blog i was trying to do the same as done by you i did the same till step 6 and was able to generate all the artifacts required i am coming up with a problem at the 7 step while testing the java callout to have xml return fault coming bea-382515 callout to java method public static org.apache.xmlbeans.xmlobject nl.xenta.services.employeeservice.retrieveemployee java.lang.string resulted in exception null java.lang.reflect.invocationtargetexception at sun.reflect.nativemethodaccessorimpl.invoke0 native method at sun.reflect.nativemethodaccessorimpl.invoke nativemethodaccessorimpl.java:39 at sun.reflect.delegatingmethodaccessorimpl.invoke delegatingmethodaccessorimpl.java:25 at java.lang.reflect.method.invoke method.java:597 at stages.transform.runtime.javacalloutruntimestep 1.run javacalloutruntimestep.java:173 at weblogic.security.acl.internal.authenticatedsubject.doas authenticatedsubject.java:363 at weblogic.security.service.securitymanager.runas securitymanager.java:146 at weblogic.security.security.runas security.java:61 at stages.transform.runtime.javacalloutruntimestep.processmessage javacalloutruntimestep.java:195 at com.bea.wli.sb.pipeline.debug.debuggerruntimestep.processmessage debuggerruntimestep.java:74 at com.bea.wli.sb.stages.stagemetadataimpl wrapperruntimestep.processmessage stagemetadataimpl.java:346 at com.bea.wli.sb.stages.impl.sequenceruntimestep.processmessage sequenceruntimestep.java:33 at com.bea.wli.sb.pipeline.pipelinestage.processmessage pipelinestage.java:84 at com.bea.wli.sb.pipeline.pipelinecontextimpl.execute pipelinecontextimpl.java:1055 at com.bea.wli.sb.pipeline.pipeline.processmessage pipeline.java:141 at com.bea.wli.sb.pipeline.pipelinecontextimpl.execute pipelinecontextimpl.java:1055 at com.bea.wli.sb.pipeline.pipelinenode.dorequest pipelinenode.java:55 at com.bea.wli.sb.pipeline.node.processmessage node.java:67 at com.bea.wli.sb.pipeline.pipelinecontextimpl.execute pipelinecontextimpl.java:1055 at com.bea.wli.sb.pipeline.router.processmessage router.java:214 at com.bea.wli.sb.pipeline.messageprocessor.processrequest messageprocessor.java:96 at com.bea.wli.sb.pipeline.routermanager 1.run routermanager.java:593 at com.bea.wli.sb.pipeline.routermanager 1.run routermanager.java:591 at weblogic.security.acl.internal.authenticatedsubject.doas authenticatedsubject.java:363 at weblogic.security.service.securitymanager.runas securitymanager.java:146 at com.bea.wli.sb.security.wlssecuritycontextservice.runas wlssecuritycontextservice.java:55 at com.bea.wli.sb.pipeline.routermanager.processmessage routermanager.java:590 at com.bea.wli.sb.test.service.servicemessagesender.send0 servicemessagesender.java:332 at com.bea.wli.sb.test.service.servicemessagesender.access 000 servicemessagesender.java:79 at com.bea.wli.sb.test.service.servicemessagesender 1.run servicemessagesender.java:137 at com.bea.wli.sb.test.service.servicemessagesender 1.run servicemessagesender.java:135 at weblogic.security.acl.internal.authenticatedsubject.doas authenticatedsubject.java:363 at weblogic.security.service.securitymanager.runas securitymanager.java:146 at com.bea.wli.sb.security.wlssecuritycontextservice.runas wlssecuritycontextservice.java:55 at com.bea.wli.sb.test.service.servicemessagesender.send servicemessagesender.java:140 at com.bea.wli.sb.test.service.serviceprocessor.invoke serviceprocessor.java:454 at com.bea.wli.sb.test.testserviceimpl.invoke testserviceimpl.java:172 at com.bea.wli.sb.test.client.ejb.testserviceejbbean.invoke testserviceejbbean.java:167 at com.bea.wli.sb.test.client.ejb.testservice_sqr59p_eoimpl.__wl_invoke unknown source at weblogic.ejb.container.internal.sessionremotemethodinvoker.invoke sessionremotemethodinvoker.java:40 at com.bea.wli.sb.test.client.ejb.testservice_sqr59p_eoimpl.invoke unknown source at com.bea.wli.sb.test.client.ejb.testservice_sqr59p_eoimpl_wlskel.invoke unknown source at weblogic.rmi.internal.serverrequest.sendreceive serverrequest.java:174 at weblogic.rmi.cluster.clusterableremoteref.invoke clusterableremoteref.java:345 at weblogic.rmi.cluster.clusterableremoteref.invoke clusterableremoteref.java:259 at com.bea.wli.sb.test.client.ejb.testservice_sqr59p_eoimpl_1035_wlstub.invoke unknown source at com.bea.alsb.console.test.testserviceclient.invoke testserviceclient.java:174 at com.bea.alsb.console.test.actions.defaultrequestaction.invoke defaultrequestaction.java:117 at com.bea.alsb.console.test.actions.defaultrequestaction.execute defaultrequestaction.java:70 at com.bea.alsb.console.test.actions.servicerequestaction.execute servicerequestaction.java:143 at org.apache.struts.action.requestprocessor.processactionperform requestprocessor.java:431 at org.apache.beehive.netui.pageflow.pageflowrequestprocessor.access 201 pageflowrequestprocessor.java:97 at org.apache.beehive.netui.pageflow.pageflowrequestprocessor actionrunner.execute pageflowrequestprocessor.java:2044 at org.apache.beehive.netui.pageflow.interceptor.action.internal.actioninterceptors.wrapaction actioninterceptors.java:91 at org.apache.beehive.netui.pageflow.pageflowrequestprocessor.processactionperform pageflowrequestprocessor.java:2116 at com.bea.alsb.console.common.base.sbconsolerequestprocessor.processactionperform sbconsolerequestprocessor.java:91 at org.apache.struts.action.requestprocessor.process requestprocessor.java:236 at org.apache.beehive.netui.pageflow.pageflowrequestprocessor.processinternal pageflowrequestprocessor.java:556 at org.apache.beehive.netui.pageflow.pageflowrequestprocessor.process pageflowrequestprocessor.java:853 at com.bea.alsb.console.common.base.sbconsolerequestprocessor.process sbconsolerequestprocessor.java:191 at org.apache.beehive.netui.pageflow.autoregisteractionservlet.process autoregisteractionservlet.java:631 at org.apache.beehive.netui.pageflow.pageflowactionservlet.process pageflowactionservlet.java:158 at com.bea.console.internal.consoleactionservlet.process consoleactionservlet.java:262 at org.apache.struts.action.actionservlet.doget actionservlet.java:414 at com.bea.console.internal.consoleactionservlet.doget consoleactionservlet.java:134 at com.bea.alsb.console.common.base.sbconsoleactionservlet.doget sbconsoleactionservlet.java:49 at org.apache.beehive.netui.pageflow.pageflowutils.strutslookup pageflowutils.java:1199 at org.apache.beehive.netui.pageflow.pageflowutils.strutslookup pageflowutils.java:1129 at com.bea.portlet.adapter.scopedcontent.scopedcontentcommonsupport.executeaction scopedcontentcommonsupport.java:687 at com.bea.portlet.adapter.scopedcontent.scopedcontentcommonsupport.processactioninternal scopedcontentcommonsupport.java:142 at com.bea.portlet.adapter.scopedcontent.strutsstubimpl.processaction strutsstubimpl.java:76 at com.bea.portlet.adapter.netuiactionhandler.raisescopedaction netuiactionhandler.java:111 at com.bea.netuix.servlets.controls.content.netuicontent.raisescopedaction netuicontent.java:181 at com.bea.netuix.servlets.controls.content.netuicontent.raisescopedaction netuicontent.java:167 at com.bea.netuix.servlets.controls.content.netuicontent.handlepostbackdata netuicontent.java:225 at com.bea.netuix.nf.controllifecycle 2.visit controllifecycle.java:180 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:324 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walkrecursive controltreewalker.java:334 at com.bea.netuix.nf.controltreewalker.walk controltreewalker.java:130 at com.bea.netuix.nf.lifecycle.processlifecycles lifecycle.java:395 at com.bea.netuix.nf.lifecycle.processlifecycles lifecycle.java:361 at com.bea.netuix.nf.lifecycle.processlifecycles lifecycle.java:352 at com.bea.netuix.nf.lifecycle.runinbound lifecycle.java:184 at com.bea.netuix.nf.lifecycle.run lifecycle.java:159 at com.bea.netuix.servlets.manager.uiservlet.runlifecycle uiservlet.java:388 at com.bea.netuix.servlets.manager.uiservlet.dopost uiservlet.java:258 at com.bea.netuix.servlets.manager.uiservlet.service uiservlet.java:199 at com.bea.netuix.servlets.manager.singlefileservlet.service singlefileservlet.java:251 at javax.servlet.http.httpservlet.service httpservlet.java:820 at weblogic.servlet.asyncinitservlet.service asyncinitservlet.java:130 at weblogic.servlet.internal.stubsecurityhelper servletserviceaction.run stubsecurityhelper.java:227 at weblogic.servlet.internal.stubsecurityhelper.invokeservlet stubsecurityhelper.java:125 at weblogic.servlet.internal.servletstubimpl.execute servletstubimpl.java:300 at weblogic.servlet.internal.tailfilter.dofilter tailfilter.java:26 at weblogic.servlet.internal.filterchainimpl.dofilter filterchainimpl.java:56 at oracle.security.jps.ee.http.jpsabsfilter 1.run jpsabsfilter.java:111 at java.security.accesscontroller.doprivileged native method at oracle.security.jps.util.jpssubject.doasprivileged jpssubject.java:313 at oracle.security.jps.ee.util.jpsplatformutil.runjaasmode jpsplatformutil.java:413 at oracle.security.jps.ee.http.jpsabsfilter.runjaasmode jpsabsfilter.java:94 at oracle.security.jps.ee.http.jpsabsfilter.dofilter jpsabsfilter.java:161 at oracle.security.jps.ee.http.jpsfilter.dofilter jpsfilter.java:71 at weblogic.servlet.internal.filterchainimpl.dofilter filterchainimpl.java:56 at oracle.dms.servlet.dmsservletfilter.dofilter dmsservletfilter.java:136 at weblogic.servlet.internal.filterchainimpl.dofilter filterchainimpl.java:56 at weblogic.servlet.internal.requesteventsfilter.dofilter requesteventsfilter.java:27 at weblogic.servlet.internal.filterchainimpl.dofilter filterchainimpl.java:56 at weblogic.servlet.internal.webappservletcontext servletinvocationaction.wraprun webappservletcontext.java:3715 at weblogic.servlet.internal.webappservletcontext servletinvocationaction.run webappservletcontext.java:3681 at weblogic.security.acl.internal.authenticatedsubject.doas authenticatedsubject.java:321 at weblogic.security.service.securitymanager.runas securitymanager.java:120 at weblogic.servlet.internal.webappservletcontext.securedexecute webappservletcontext.java:2277 at weblogic.servlet.internal.webappservletcontext.execute webappservletcontext.java:2183 at weblogic.servlet.internal.servletrequestimpl.run servletrequestimpl.java:1454 at weblogic.work.executethread.execute executethread.java:209 at weblogic.work.executethread.run executethread.java:178 caused by java.lang.noclassdeffounderror could not initialize class nl.xenta.crm.employee.employeedocument at nl.xenta.crm.employee.employeedocument factory.newinstance employeedocument.java:45 at nl.xenta.services.employeeservice.retrieveemployee employeeservice.java:19 … 140 more pipelinepairnode1 pipelinepairnode1_request stage1 request-pipeline then i tried to test the retrieveemployee in eclipse by adding a main and calling the retrieveemployee method and running it but ended up with error like exception in thread main thread java.lang.exceptionininitializererror at nl.xenta.crm.employee.employeedocument factory.newinstance employeedocument.java:45 at nl.xenta.services.employeeservice.retrieveemployee employeeservice.java:19 would you please guide me cheers abhinav gupta at nl.xenta.services.employeeservice.main employeeservice.java:29 caused by java.lang.runtimeexception can not load schematypesystem unable to load class with name schemaorg_apache_xmlbeans.system.s272538d6da7facdb8de110c0be3f1ca4.typesystemholder make sure the generated binary files are on the classpath at org.apache.xmlbeans.xmlbeans.typesystemforclassloader xmlbeans.java:783 at nl.xenta.crm.employee.employeedocument employeedocument.java:20 … 3 more caused by java.lang.classnotfoundexception schemaorg_apache_xmlbeans.system.s272538d6da7facdb8de110c0be3f1ca4.typesystemholder at java.net.urlclassloader 1.run urlclassloader.java:202 at java.net.urlclassloader.findclass urlclassloader.java:190 at java.lang.classloader.loadclass classloader.java:305 at sun.misc.launcher appclassloader.loadclass launcher.java:308 at java.lang.classloader.loadclass classloader.java:246 at org.apache.xmlbeans.xmlbeans.typesystemforclassloader xmlbeans.java:770 at nl.xenta.crm.employee.employeedocument employeedocument.java:20 at nl.xenta.crm.employee.employeedocument factory.newinstance employeedocument.java:45 at nl.xenta.services.employeeservice.retrieveemployee employeeservice.java:20 at nl.xenta.services.employeeservice.main employeeservice.java:30 hi eric i got it working actually the build jar was not added to the classpath thanks for nice blog would be happy to see more in future from you related to osb and jms abhinav gupta hi eric very good article t s so helpful me.i have query.i m able to publish the event with java class by adding the liabraries like java ee1.5 jrf api oracle xml parserv2 and weblogic10.3remote-client.but i would like to publish the event with samee java class from the eclipse but i didn t find how to add the libraries in eclipse.and one more thing is when i create the java project in eclipse it s not come to the osb configuration due to this i m unable to invoke the java method by using the java call out.thanks in advance don t you just need to add the libraries to the build path in eclipse like this http //help.eclipse.org/galileo/index.jsp topic=/org.eclipse.jdt.doc.user/reference/ref-properties-build-path.htm when you created a java project in eclipse you can rightmouseclick on it export jar this jar you just need to store in your osb project make sure you package also all the generated xml beans objects in the jar otherwise it wont help the ant build will package the jar with the generated xmlbean resources i think you re missing those in yours hi eric can u plz tel me how to create build.xml for above schema thanks mani you can download it from one of the samples of the xmlbeans site http //xmlbeans.apache.org/samples/index.html getting+the+samples hi eric thanks for reply i copy the code from blog when i open the build.xml nothing is there but when i open it in editplus it s visible after build.xml how to run antbuild based on xml namespace give me guideline thanks mani this blog on how to send the java object to a java callout and return a xmlobject back i added the hello eric do you mind if i suggest this solution http //oraclesoasuite11g.blogspot.com/2012/01/osb-java-object-to-xmlobject-or-string.html thank you lara fernandes i need return a collection list in java callout action i recive only this content in any variable how i do for read or convert to list in osb message flow my escenary is excecute un method in java callout this method recive a colection and return a collection i cant view estructur in message flow only view con java-content….. can any help me i need your help regards jgamboita gmail.com i think you need to create a static method with a xmlboject for this to be able to retrieve the list and the xsd will contain the maxoccurs or your array/list element eric tks i have static method this method return a list in message flow proxy service i need read this collection i only view con java-content… in body how i do for view list content you can t read the java content..you can only pass it on to some other java callout or for example to a file jca adapter..but you can t edit this data in your proxy service flow can t you change the static method so it returns an xml object which contains the array structure i dont know how i do this need i convert list to xmlobject how or cant return collection to proxy service and after get data cant with java callout what do you want to do with the collection in the proxy service flow you do the callout and you receive back a list whether or not it s a java collection or a xml array but what s the next step in your process in proxy service i have a stage with a java callout the metho in java c. need receive a list after transforming and generate a new list with new data after i need return this list in proxy services message flow after i need send this list to a route node web services legacy the problem is in java callout response variable in proxy s. i cant view data i view this i cant read data when you do the call to the web services legacy you re talking xml again i assume soap http so for that you need to java list response transformed back to the xml representive knowing this it s easier to start with a xsd like this comment describing your root element and use this to generate your xml beans java code with these generated artifacts you can eassily generate your xmlobject in which the list exists ok erik im trying undestand you in resumen i never cant read directly java list collection in java callout response variable i need generate a xmlobject in java callout for return list in xml format. eric talking about http soap for send list to web service that is correct i will send list content in a soap message well you can read the java response directly but you can execute any xpath expressions on it and since you need to transform the java representive to the xml-representive to be able to call the legacy webservice i would not return a java list collection but a xmlobject because then when you arrive back in the proxy service from the java callout you already have a xml representive of your list so you can use xslt/xquery directly to transform the input of your legacy webservice erik thank you for your coments and your help for finish the java callout response variable have this content con java-content ref= jcid 716fca9e:135e8409ebb -7f6b can i convert this you can t convert it from java to xml in the proxy service itself by use of xslt or xquery i read this as well….and it worries me if true osb uses xmlbeans to materialize payload in memory… this is not a very memory-efficient framework because each payload is represented as a xmlobject a self describing hence redundant object my experience is that with the text representation of the object occupying 1 mb you can occasionally take 100 mb or memory but this also depends on the structural complexity of the payload in any case osb is not a etl tool it s not meant to handle large 10mb payloads it behaves well for small 100k messages but above the 5mb i would be cautious thanks true it s not really ment to transform big chunks of data is all the data in the payload needed for transformation or just parts of it and do you expect a constant stream of big data payload or is this just occuring once in a while if you expect a lot of big payloads you could think of other better solutions of oracle products which process these kind of message flows in a more performed way thanks for the answer.yes i need t modify the request…to merge some results from several backends…unfortunqatey no time and money now for a new oracle product.. so some workaround i will do…stil 4mb payload to become 400 mb in memory what it is behind it is from time to time for certain user profiles what worries me is that we do not really need to transform the message rather then merge some responses in a split join insert splitjoinresponse1/tag1/tag2 into finalresponse tag 2 has hundreds of occurences but the whole payload response from each split join business service is around 4mb 4 mb 4 split join == 1.6gb when doing this create a huge consumption of memory cpu usage cheers cristian c. you don t have the option to use for example a bpel process to do some orchestration and enrichments otherwise try using some other library instead of xmlbeans and see how it performs since you re a java callout atm you re free to go on that side see http //mail-archives.apache.org/mod_mbox/xmlbeans-user/200411.mbox/ 3c4159586400014efe mta12.wss.scd.yahoo.com 3e what s causing the memory footprint will do that and post my findings here in case others will be interested thanks ok great if you need any help just leave a comment again have a nice weekend custom xquery functions blue clouds in osb oracle service bus 11g and db adapter a more integrated approach enjoy it soa java event-driven computing and integration in osb restful services with oracle service bus soa thinker in osb your email address will not be published required fields are marked comment name email website notify me of new comments via email notify me of new posts via email view full site blog at wordpress.com