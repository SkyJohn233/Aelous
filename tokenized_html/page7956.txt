stopping hackers with iptables asterisk support asterisk community i m implementing iptables rules to stop hacking attempts following this document https //www.voip-info.org/wiki/view/asterisk+firewall+rules iptables -i input -p udp -m udp dport 5060 -m string string user-agent vaxsipuseragent algo bm to 65535 -j drop iptables -i input -p udp -m udp dport 5060 -m string string user-agent friendly-scanner algo bm to 65535 -j reject reject-with icmp-port-unreachable why is the first user agent dropped and the second rejected is there a resource to list user agents to block other than http //blog.kolmisoft.com/sip-attack-friendly-scanner/ how to determine which user agents to reject and which to drop why dont you use fail2ban after 3 or any attempt it can ban any ip if you want you can define own filter rule i m not permitted to use fail2ban and would rather do this in iptables i m just wondering about the difference in treatment of different user agants lol when fail2ban is great for this job it is reading non-stop asterisk s logs and if it see more than x failed attempts of login or unathorized calls it set iptables rule when you use f2b as the first messages are answer the remote scanner knows there is an ipbx and some start bruteforcing your server causing your ressources to be consumed iptables blocks the scan at the earliest and does not hint the remote scanner that you are running an ipbx from my experience 3 agents are commonly used and these rules will stop them of course you also need f2b and monitor when someone is banned which user agent is used and add it to iptables fail2ban uses iptables the distinction you are making are between static rules and self adapting rules they dynamic rules will still work if the attacker changes the user agent to get round the static rules the second agent is just rejected so that a friendly scanner in this case would be allowed the get a reply of some sort the vaxsipuseragent gets dropped because in the example the admin does not want any response sent at all when dealing with that user agent i have to concur with everyone fail2ban which is a log parser that then applies dynamic iptables rules against hosts used along with iptables-persistent or your own method of regularly saving iptables rules and then loading them at startup fail2ban s dynamic method to creating firewall rules on the fly is superior this is especially since you can change the settings as needed to catch newly discovered methods of attacking an asterisk or other service system additionally the notifications can be useful i often discover the same ip or ip blocks trying to gain access to a system over and over and over so i contact the abuse email from the whois report if i don t get satisfaction i.e the attacks stop i create a rule to drop all packets from the offending ip you can also get into using iptables with geographic ip checking and block particular countries this comes in handy just my 0.02 s mcgowan powered by discourse best viewed with javascript enabled