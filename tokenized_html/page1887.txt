stockitemrepository gets wrong product id if a product has been deleted issue 7057 magento/magento2 github github is home to over 40 million developers working together to host and review code manage projects and build software together have a question about this project sign up for a free github account to open an issue and contact its maintainers and the community by clicking sign up for github you agree to our terms of service and privacy statement we ll occasionally send you account related emails already on github sign in to your account 3 after looking in the cataloginventory_stock_item table i can see that the stock of the item is being referenced against the item_id see cataloginventory_stock_item image to get round this issue i have used the \magento\cataloginventory\model\stockstate model and getstockqty function to reference against as this uses the cataloginventory_stock_status table which does reference the product_id hi lhsatch fourth step contain issue this- _stockitemrepository- get product_id you must pass stock_item_id instead of product_id for obtain stock_item object by product use stockitem product- getextensionattributes getstockitem or configure search criteria \magento\cataloginventory\api\stockstatuscriteriainterface and use \magento\cataloginventory\api\stockstatusrepositoryinterface :getlist hi miakusha thank you for getting back to me although i have managed to get the stock qty using the stockstate class i have n't been able to find a function that will get the product stock state in stock out of stock by product_id as this- _stockitemrepository- get product_id is used by referencing the stock_item_id what can be used to get the product stock status i have n't found anywhere in the catalog_inventory module where i could get the stock status of a product by product_id any help would be great hi lhsatch actually \magento\cataloginventory\api\data\stockstatusinterface should answer to all your questions long story short magento has stockitem entity which represents amount qty of specific product productid on a concrete stock stockid stockiteminterface should be used when you would like to write data into the data storage like update amount of products to sync up magento with your erp system or to make deduction of stock during the checkout process stockstatusinterface is opposite to it it should be used to read data for representation on front-end consider stockstatus as an index which contains aggregated stock data for each specific product so if you would like to get product stock status in stock out of stock by product_id you need using stockstatusrepositoryinterface :getlist stockstatuscriteriainterface searchcriteria get stockstatus entity for specified product hi maghamed you are a legend that has worked perfectly and the getstockstatus function works for both 0 quantities and for stock status out of stock thank you i 'm closing this report as issue was solved hi maghamed as of magento open source 2.3 \magento\cataloginventory\api\data\stockstatusinterface is apparently now deprecated despite also being marked as api in favor of the msi i tried to consult the links provided but one of the pages linked near the deprecation notice says i should be using the read-only interface stockitem to check if a product is in or out of stock while the other says that stockitem-related classes and methods got deprecated for example stockitemrepositoryinterface :getlist i am now a bit confused what would be the direct or nearest replacement to the code you provided above but using the new apis provided by msi