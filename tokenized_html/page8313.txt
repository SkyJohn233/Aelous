a study on maneuvering obstacle motion state estimation for intelligent vehicle using adaptive kalman filter based on current statistical model by using this website you consent to the use of cookies as described in our privacy policy indexed in science citation index expanded to receive news and publication updates for mathematical problems in engineering enter your email address in the box below 1 state key laboratory of automobile simulation and control jilin university changchun 130022 china sup 2 sup ford motor research engineering nanjing co. ltd. nanjing 210000 china received 2 may 2015 revised 7 august 2015 accepted 9 august 2015 academic editor raffaele solimene copyright © 2015 bao han et al this is an open access article distributed under the creative commons attribution license which permits unrestricted use distribution and reproduction in any medium provided the original work is properly cited the obstacle motion state estimation is an essential task in intelligent vehicle the ascl group has developed such a system that uses a radar and gps/ins when running on the road the acceleration of the vehicle is always changing so it is hard for constant velocity cv model and constant acceleration ca model to describe the motion state of the vehicle this paper introduced current statistical cs model from military field which uses the modified rayleigh distribution to describe acceleration the adaptive kalman filter based on cs model was used to estimate the motion state of the target we conducted simulation experiments and real vehicle tests and the results showed that the estimation of position velocity and acceleration can be precise in recent years the lane departure warning system front collision warning system adaptive cruise control system and other automotive advanced driver assistance systems which are based on the radar and computer vision have become hot research topics in the international automotive safety technology 1 – 4 in order to obtain the motion state information of the front vehicle comprehensively and achieve target identification effectively and accurately the researchers of bosch delphi and other institutions proposed obstacle motion state estimation algorithm 5 6 and most of the studies use maneuvering target tracking methods from the military field which are used to detect the aircraft missile and other flyers 7 – 11 friedland assumed that the target maintains a constant velocity relative to the radar and the relative acceleration is considered to be the random interference in which the mean is zero he established a two-order kalman filter based on cv model 12 the position and velocity estimation error are small when the velocity of the target is constant but these estimation errors are larger when speed of the target changes hampton assumed that the target maintains a constant acceleration relative to the radar and the change of the relative acceleration is considered to be the random interference in which the mean is zero he established a three-order kalman filter based on ca model 13 the position and velocity estimation error are small when the velocity or the acceleration of the target is constant but these estimation errors are larger when the acceleration changes singer proposed singer model 14 singer model is a zero-mean model for motor acceleration which is not reasonable to maneuvering target with mutative velocity and acceleration it is generally agreed that the data range of next moment acceleration is limited blom and bar-shalom proposed the interactive multiple model imm algorithm 15 – 18 it allows for several parallel models which are combined to a weighted estimate choosing models for different driving modes such as constant velocity constant acceleration and strong acceleration changes the target state estimation can be optimized for highly dynamic maneuvers but the amount of processing is large and if the weight set is not accurate enough the estimation performance will decrease hou of tsinghua university assumed that the change rate of the acceleration is constant and he established a four-order kalman filter 19 when the acceleration of the target changes often the position velocity and acceleration estimation is more accurate compared to the kalman filter based on cv model or ca model but it is a prior model and it is not an adaptive system according to the change of the acceleration and if the change rate of the acceleration changes the position velocity and acceleration estimation will be less precise in order to improve the accuracy of target state estimation this paper introduces cs model 20 21 from military and aerospace field which is using the modified rayleigh distribution to describe acceleration compared to the ca model the cs model is more aligned with the actual acceleration change laws the author established the adaptive kalman filter based on the cs model it uses the variance of the modified rayleigh distribution to adjust the optimal kalman gain at the next time which improved the accuracy of the target motion state estimation in addition the motion modeling and filtering are based on absolute motion in absolute coordinate by using the gps/ins which can improve the accuracy the paper is organized as follows in section 1 a brief introduction on the target state estimation and modeling method is given section 2 presents the method for the target state estimation in sections 3 and 4 the simulation experiments and real vehicle test results are compared for ca model conclusions are presented in section 5 in this paper the object state estimation is to use the estimation algorithm based on the target motion model to identify the state position velocity and acceleration accurately and in real time the key element is to find a suitable model for target and an appropriate estimation algorithm when driving on the road the time that the vehicle maintains constant velocity and acceleration is always short and the acceleration changes a lot such as overtaking so when using the kalman filtering algorithm based on the cv model or the ca model to estimate the state of real vehicle the error is large but that of the adaptive kalman filtering algorithm based on the cs model is not probability density function of rayleigh distribution is expressed as follows figure 1 shows that if is determined we can completely determine the statistical properties of rayleigh distribution when a target is maneuvering with a certain acceleration at present the region of acceleration which can be taken in the next instant is limited and is around the current acceleration hence it is unnecessary to take all possible values of maneuvering acceleration into consideration when modeling the target acceleration probability density in this situation the reasonable statistical model is a maneuvering acceleration probability distribution function that is time-varying and using the current acceleration of the target as the center which is the modified rayleigh distribution function as shown in figure 2 1 when the acceleration of the obstacle is positive the probability density function of the acceleration can be written as follows where is positive maximum value of acceleration that the target can reach is the acceleration of the target and is a positive constant mean value and variance of are given as follows 2 when the acceleration of the obstacle is negative the probability density function of the acceleration can be written as follows where is negative maximum value of acceleration that the target can reach is the acceleration of the target and is a positive constant mean value and variance of are given as follows 3 when the acceleration of the obstacle is zero the probability density function of the acceleration can be written as follows where is the dirac delta function in general the maximum value of the target acceleration can be predicted so when the mean value of the target acceleration is measured can be written as follows and the variance of the acceleration is therefore as long as the mean value of the target acceleration is obtained the variance of the target acceleration can be obtained the modified rayleigh distribution is introduced to establish an appropriate relation between the mean and variance of the acceleration so that the adaptive filtering algorithm is easy to implement under the concept of current statistical model when the target is maneuvering at a certain acceleration the zero-mean model is obviously unreasonable so the non-zero-mean time-correlation model of the acceleration can be used where is the position is the acceleration that the variance is and mean is is the colored noise that the mean value is zero is the maneuvering efficiency is the white noise that the mean value is zero and the variance is let and from 7 and 8 the following formulae can be deduced where is the acceleration state variable and is the white noise in which the mean is from the estimation theory the optimal estimation of the acceleration state variable is the conditional mean of the whole historical observed value and the variance of is from 10 the following formula can be deduced let be the sampling time and through the discrete processing the discrete system state equation is where the state transition matrix is where is the sampling step the input matrix is where is the mean value of acceleration is the process noise which is the discrete-time white noise sequence that the covariance matrix is is the acceleration variance in direction of the target and is the acceleration variance in direction of the target where where is the autocorrelation time constant equation 20 shows the self-adaptive adjusting method of modified rayleigh distribution variance which can reflect the change law of acceleration the observation equation is where is the observation noise which is the gaussian white noise 1 the initial values of the state and estimate covariance 2 updated state estimate 3 optimal kalman gain 4 updated state estimate 5 updated estimate covariance 6 predicted state estimate 7 the acceleration variances and use 17 and 18 and uses 16 8 predicted estimate covariance 9 return to 2 and continue the iteration when the mean of the modified rayleigh distribution is small the next time the acceleration value is in a wide range which implies that the change of can be larger so the kalman gain should be larger to make the accuracy of filtering results not decline conversely when the mean of the modified rayleigh distribution is large the next time the acceleration value is in a small range which implies that the change of can be smaller so the kalman gain should be smaller from 18 and 20 it can be found that when the acceleration limit values and are determined and if the acceleration of the target changes in a small range especially around zero the tracking performance changes with the change of the process noise covariance matrix therefore in order to ensure the tracking accuracy the acceleration limit values and can not be very large and if and are too small when the acceleration of target exceeds the range the filtering performance will be worse so the value of and can not be too small or large in tracking the status of target with different motions there are different measurement results when using two different methods the kalman filter based on the ca model and the adaptive kalman filter based on the cs model when driving on the road there are three kinds of motions uniform motion uniform acceleration motion and varying acceleration motion so these three simulation scenarios are selected and we compare the two measurement results as follows figure 3 shows the gaussian white noise added in and direction in each simulation in which the mean is 0 and the variance is 1 sampling step is 0.1 s sampling time is 40 s. the position velocity and acceleration estimation and the estimation error of uniform moving target are as follows figure 4 shows the path of the uniform moving target including the actual value the results of kalman filtering estimation based on ca model and the results of adaptive kalman filtering estimation based on cs model in figure 5 a the rmse of the position of the ca model in direction is 0.1119 and the rmse of the position of the cs model in direction is 0.1854 the rmse error of the position of the ca model in direction is 0.1015 and the rmse of the position of the cs model in direction is 0.1212 in figure 5 b the rmse of the velocity of the ca model in direction is 0.5429 and the rmse of the velocity of the cs model in direction is 0.7292 the rmse of the velocity of the ca model in direction is 0.0935 and the rmse of the velocity of the cs model in direction is 0.0057 in figure 5 c the rmse of the acceleration of the ca model in direction is 0.8933 and the rmse of the acceleration of the cs model in direction is 0.7017 the rmse of the acceleration of the ca model in direction is 0.5534 and the rmse of the acceleration of the cs model in direction is 0.0498 figure 6 shows the trends of adaptive parameters and the acceleration of the target in direction is 3 m/s and in direction is 0.3 m/s the position velocity and acceleration estimation and the estimation error of moving target with constant acceleration are as follows figure 7 shows the path of the moving target with constant acceleration including the actual value the results of kalman filtering estimation based on ca model and the results of adaptive kalman filtering estimation based on cs model in figure 8 a the rmse of the position of the ca model in direction is 0.1197 and the rmse of the position of the cs model in direction is 0.1493 the rmse of the position of the ca model in direction is 0.1090 and the rmse of the position of the cs model in direction is 0.1062 in figure 8 b the rmse of the velocity of the ca model in direction is 0.2899 and rmse of the velocity of the cs model in direction is 0.3070 the rmse of the velocity of the ca model in direction is 0.1324 and the rmse of the velocity of the cs model in direction is 0.1222 in figure 8 c the rmse of the acceleration of the ca model in direction is 0.5742 and rmse of the acceleration of the cs model in direction is 0.5503 the rmse of the acceleration of the ca model in direction is 0.0948 and the rmse of the acceleration of the cs model in direction is 0.0773 figure 9 shows the trends of adaptive parameters and the position velocity and acceleration estimation and the estimation error of moving target with variable acceleration are as follows figure 10 shows the path of the moving target with variable acceleration including the actual value the results of kalman filtering estimation based on ca model and the results of adaptive kalman filtering estimation based on cs model in figure 11 a the rmse of the position of the ca model in direction is 2.4554 and the rmse of the position of the cs model in direction is 0.2102 the rmse of the position of the ca model in direction is 1.9182 and the rmse of the position of the cs model in direction is 0.6944 in figure 11 b the rmse of the velocity of the ca model in direction is 4.1254 and rmse of the velocity of the cs model in direction is 0.8365 the rmse of the velocity of the ca model in direction is 3.1801 and the rmse of the velocity of the cs model in direction is 1.5912 in figure 11 c the rmse of the acceleration of the ca model in direction is 2.2319 and rmse of the acceleration of the cs model in direction is 1.5602 the rmse of the acceleration of the ca model in direction is 1.0856 and the rmse of the acceleration of the cs model in direction is 1.4816 table 1 shows the rmse for ca and cs model in the three simulation conditions figure 12 shows the trends of adaptive parameters and regarding comprehensive comparison of these results we can conclude the following 1 when the target does uniform motion or constant acceleration motion the results of kalman filtering estimation on position velocity and acceleration based on the ca model and the adaptive kalman filtering estimation on position velocity and acceleration based on the cs model can quickly converge but the filtering estimation results of the former are closer to the exact value this is because of the fact that in the kalman filtering estimation process when the system process noise covariance matrix is larger the filtering estimation is more biased in favor of the predicted value which may cause the estimation results to not follow the actual change when the observation noise covariance matrix is larger the filtering estimation is more inclined to the observations in which the observation noise filtering effect will reduce in terms of the adaptive kalman filtering algorithm based on the cs model when the acceleration limit values and are determined if the acceleration of the target changes in a small range especially near zero the tracking performance becomes worse as the system process noise covariance matrix is larger conversely higher tracking performance 2 when the target does the varying acceleration motion the results of the kalman filtering estimation on position velocity and acceleration based on the ca model are divergent but that of the adaptive kalman filtering estimation based on cs model can quickly converge and the errors are smaller figure 13 shows the intelligent vehicle platform audi q5 that is equipped with the ibeo four-layer laser radar gps/ins system and industrial computer figure 14 shows the target vehicle buick gl8 that is equipped with gps/ins system we used the gps/ins system equipped on the intelligent vehicle to measure the position and heading angle of the radar operating and the ibeo radar to measure the relative position between the target vehicle and the intelligent vehicle the gps/ins system equipped on target vehicle recorded the absolute motion states which we take as the accurate motion state of the target vehicle and the gps/ins systems equipped on both vehicles are span-cpt system that uses the professional level oemv technology in which the precision can reach 0.01 meters we compared the algorithm introduced in this paper with the kalman filter based on ca model sampling step is 0.1 s sampling time is 55 s. sampling condition is as follows the target vehicle moves in front of the intelligent vehicle figure 15 shows the path of the target vehicle including the actual value the results of kalman filtering estimation based on ca model and the results of adaptive kalman filtering estimation based on cs model in figure 16 a the rmse of the position of the ca model in direction is 1.8468 and the rmse of the position of the cs model in direction is 1.6330 the rmse of the position of the ca model in direction is 0.1728 and the rmse of the position of the cs model in direction is 0.1440 in figure 16 b the rmse of the velocity of the ca model in direction is 3.8322 and rmse of the velocity of the cs model in direction is 2.1996 the rmse of the velocity of the ca model in direction is 0.4923 and the rmse of the velocity of the cs model in direction is 0.2345 in figure 16 c the rmse of the acceleration of the ca model in direction is 2.9796 and rmse of the acceleration of the cs model in direction is 1.3044 the rmse of the acceleration of the ca model in direction is 0.2808 and the rmse of the acceleration of the cs model in direction is 0.2153 table 2 shows the rmse for ca and cs model in the real vehicle test figure 17 shows the trends of adaptive parameters and figures 16 a 16 b and 16 c show that the error of the position velocity and acceleration of the adaptive kalman filter based on the cs model is smaller than that of the kalman filter based on the ca model when the target runs on the road the acceleration varies with time which is as the varying acceleration motion in the simulation respectively using kalman filter based on ca model and adaptive kalman filter based on cs model to estimate the position velocity and acceleration the errors of the latter are smaller the purpose of this paper is to estimate the motion state of the maneuvering obstacle in front of the intelligent vehicle we used adaptive kalman filter based on cs model which can identify the target position velocity and acceleration in real time through the sensor data with observation noise in this paper we built a vehicle experimental platform which consists of an intelligent vehicle equipped with the laser radar gps/ins and so forth and a tracking target obstacle vehicle equipped with inertial navigation system and in this paper the motion modeling and filtering are based on absolute motion in absolute coordinate by using the gps/ins which can improve the accuracy by decreasing the influence from the moving measuring bases the simulation and experiments showed that the adaptive kalman filter based on cs model can accurately estimate the target motion state when the targets are doing the uniform motion constant acceleration motion or varying acceleration motion the authors declare that there is no conflict of interests regarding the publication of this paper this paper is supported by program for chang jiang scholars and innovative research team in university no irt0626 china thanks are due to them © 2018 hindawi limited unless otherwise stated