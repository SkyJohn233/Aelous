34||m < 10)||window.opera||t.addEventListener("progress",function(t){n.lastSize=t.loaded},!1)}),d.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),d.on("open-xhr-end",function(t,n){"loader_config"in NREUM & & "xpid"in NREUM.loader_config & & ("X-NewRelic-ID",NREUM.loader_config.xpid);var e=!1;if("init"in NREUM & & "distributed_tracing"in NREUM.init & & (e=!!NREUM.init.distributed_tracing.enabled),e & ){var r=u();r & & & (n.setRequestHeader("newrelic",r.header),this.dt=r)}}),d.on("send-xhr-start",function(t,n){var e=this.metrics,r=t[0],o=this;if(e & ){var i=w(r);i & & (e.txSize=i)}this.startTime=s.now(),this.listener=function(t){try{"abort"!==t.type||o.loadCaptureCalled||(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs & & (o.onloadCalled||"function"!=typeof n.onload)) & (n)}catch(e){try{d.emit("internal-error",[e])}catch(r){}}};for(var a=0;a 1?t[1]=a:t.push(a)}else t[0] & [0].headers & & (t[0].headers.append("newrelic",i),this.dt=o)}})}},{}],13:[function(t,n,e){n.exports=function(t){var n=document.createElement("a"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split("://");!r.port & [1] & & (r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port & & "0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0) & & (r.pathname="/"+r.pathname);var i=!n.protocol||":"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain & ===e.port;return r.sameOrigin=i & & (!n.hostname||a),r}},{}],14:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t("handle"),a=t(20),s=t(21),c=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic & & (newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,n){u[n]=o(l+n,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o="function"==typeof n;return i(p+"tracer",[f.now(),t,e],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}catch(t){throw c.emit("fn-err",[arguments,this,t],e),t}finally{c.emit("fn-end",[f.now()],e)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t,n){"string"==typeof t & & (t=new Error(t)),i("err",[t,f.now(),!1,n])}},{}],15:[function(t,n,e){n.exports=function(t){if("string"==typeof t & )return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer &  instanceof ArrayBuffer & )return t.byteLength;if("undefined"!=typeof Blob &  instanceof Blob & )return t.size;if(!("undefined"!=typeof FormData &  instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],16:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o & & (r=+o[1]),n.exports=r},{}],17:[function(t,n,e){function r(t,n){var e=t.getEntries();e.forEach(function(t){"first-paint"===t.name?a("timing",["fp",Math.floor(t.startTime)]):"first-contentful-paint"===t.name & ("timing",["fcp",Math.floor(t.startTime)])})}function o(t){if(t instanceof c & & !u){var n,e=Math.round(t.timeStamp);n=e>1e12?Date.now()-e:s.now()-e,u=!0,a("timing",["fi",e,{type:t.type,fid:n}])}}if(!("init"in NREUM & & "page_view_timing"in NREUM.init & & "enabled"in NREUM.init.page_view_timing & _view_timing.enabled===!1)){var i,a=t("handle"),s=t("loader"),c=NREUM.o.EV;if("PerformanceObserver"in window & & "function"==typeof window.PerformanceObserver){i=new PerformanceObserver(r);try{i.observe({entryTypes:["paint"]})}catch(f){}}if("addEventListener"in document){var u=!1,d=["click","keydown","mousedown","pointerdown","touchstart"];d.forEach(function(t){document.addEventListener(t,o,!1)})}}},{}],18:[function(t,n,e){function r(){function t(){return n?15 [e++]:16*Math.random()|0}var n=null,e=0,r=window.crypto||window.msCrypto;r & & & (n=r.getRandomValues(new Uint8Array(31)));for(var o,i="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",a="",s=0;s < 16;i++)o.push(t().toString(16));return o.join("")}n.exports={generateUuid:r,generateCatId:o}},{}],19:[function(t,n,e){function r(t,n){if(!o)return!1;if(t!==o)return!1;if(!n)return!0;if(!i)return!1;for(var e=i.split("."),r=n.split("."),a=0;a < 0?0:o);++r .side-menu{position:fixed;top:0;overflow:auto;width:280px;height:100%;z-index:202}.side-menu.side-menu--left{left:-280px;transition:left .5s ease}.side-menu--left--open .side-menu.side-menu--left.side-menu--left{left:0;box-shadow:1px 2px 4px rgba(0,0,0,.2)}.side-menu.side-menu--right{right:-280px;transition:right .5s ease}.side-menu--right--open .side-menu.side-menu--right.side-menu--right{right:0;z-index:1001}.side-menu.side-menu--mobile{right:-280px;transition:right .5s ease}.side-menu--mobile--open .side-menu.side-menu--mobile.side-menu--mobile{right:15px;z-index:1001}.overlay__container{display:none}.hidden{display:none!important}.upcase{text-transform:uppercase}.hide-text{text-indent:100%;white-space:nowrap;overflow:hidden;position:absolute}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.visuallyhidden{position:absolute;overflow:hidden;clip:rect(0 0 0 0);height:1px;width:1px;margin:-1px;padding:0;border:0}.quote__after{text-decoration:none}.quote__after:after{content:' \00BB '}.quote__before{text-decoration:none}.quote__before:before{content:'\00AB '}.v-hidden{visibility:hidden}body,html{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}html{line-height:1}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,button,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{margin:0;padding:0;border:0;font:inherit;font-size:100%;vertical-align:baseline}ol,ul{list-style:none}table{border-collapse:collapse;border-spacing:0}caption,td,th{text-align:left;vertical-align:middle}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}a img{border:none}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section,summary{display:block}body,html{width:100%;height:100%;background-color:#f3f3f3}body{font-family:"YP Local",sans-serif;font-size:90%;color:#333;font-weight:100;line-height:140%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,:after,:before{box-sizing:border-box}a{text-decoration:underline;color:#333}a:hover{text-decoration:none}.italic,em,i{font-style:italic}b,strong{font-weight:300}input{font-weight:100}button,input{font-family:"YP Local",sans-serif}::selection{color:#333;background-color:#ffcd00}input[type=text]::-ms-clear{display:none}figure{margin:0}form{margin:0}button{border:0;margin:0;padding:0;cursor:pointer}address{font-style:normal}ul{padding:0;margin:0;list-style:none}.page__wrapper{display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;-ms-flex-negative:0;flex-shrink:0;-ms-flex-direction:column;flex-direction:column;margin:0;padding:0;height:100%}#cobrand .page__wrapper{height:calc(100vh - 88px)}.page__footer,.page__header{-ms-flex:0 0 auto;flex:0 0 auto}.page-CONTACT_US .page__header,.page-MERCHANT_DIRECTIONS .page__header{margin-bottom:10px}.ypg_mediative_smart_tips{margin-bottom:20px;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.ypg_mediative_smart_tips>div{overflow:hidden}.page__container{-ms-flex:1 0 auto;flex:1 0 auto}@media (min-width:851px){.page__container:not(.page__container--mapview) .page__sidebar{width:296px}}@media (min-width:600px){.page__container .page__sidebar--left{margin-right:20px}}@media (min-width:851px){.page__container .page__sidebar--right{margin-left:50px;padding-top:72px}}.page__container .page__content-wrap{margin-bottom:30px;background-color:#fff;border-radius:2px;box-shadow:0 2px 2px -1px rgba(0,0,0,.2);line-height:130%}.page__container .page__content-wrap:after,.page__container .page__content-wrap:before{content:" ";display:table}.page__container .page__content-wrap:after{clear:both}@media (min-width:851px){.page__container .page__content-wrap{padding:25px 30px 30px}}@media (min-width:0) and (max-width:850px){.page__container .page__content-wrap{padding:25px 20px}.page__container .page__content-wrap .box-title{margin-top:-10px;margin-left:-10px;margin-right:-10px;margin-bottom:10px}}.page__container .page__content-wrap .boxTitle,.page__container .page__content-wrap h1{font-size:18px;font-size:1.125rem;margin-bottom:10px;font-weight:300;padding:0;display:block}.page__container .page__content{min-width:0}.page__container--full{padding-top:20px}.page__container--full .page__content{margin:0 auto}@media (min-width:851px){.page__container--full .page__content{max-width:1180px;padding-right:20px;padding-left:20px;padding-bottom:20px}}@media (min-width:0) and (max-width:850px){.page__container--full .page__content{padding-right:10px;padding-left:10px}}@media (min-width:0) and (max-width:599px){.page__container--full{padding:0;width:100%}.context-shopwise .page__container--full{padding-top:20px}}.page__container--left-sidebar{padding-top:20px}@media (min-width:851px){.page__container--left-sidebar{margin-left:auto;margin-right:auto;display:-ms-flexbox;display:flex;max-width:1200px;padding-left:20px;padding-right:20px;width:100%}.page__container--left-sidebar .page__content{-ms-flex:1;flex:1}}@media (min-width:0) and (max-width:850px){.page__container--left-sidebar{padding-right:10px;padding-left:10px}}.page__container--right-sidebar{padding-top:25px}@media (min-width:851px){.page__container--right-sidebar{margin-left:auto;margin-right:auto;display:-ms-flexbox;display:flex;max-width:1180px;padding-left:20px;padding-right:20px;width:100%}.page__container--right-sidebar .page__content{-ms-flex:1;flex:1}.page__container--right-sidebar .page__container_wrap{display:-ms-flexbox;display:flex}}.searchBodyClass .page__container--right-sidebar{display:block}@media (min-width:0) and (max-width:850px){.page__container--right-sidebar{padding-right:10px;padding-left:10px}.page__container--right-sidebar .page__sidebar:not(.page__sidebar--visible){display:none}.mobileSearch .page__container--right-sidebar{padding:0}}.page__container--mapview .page__container_wrap{z-index:1;display:-ms-flexbox;display:flex;-ms-flex-line-pack:stretch;align-content:stretch;-ms-flex:1 0 auto;flex:1 0 auto}.page__container-title{font-size:23px;font-size:1.4375rem;padding:10px 0}.devicePhone .page__container-title{padding:10px}.mobile-filters .page__container-title{display:none}.page__container--mapview{z-index:1;display:-ms-flexbox;display:flex;-ms-flex-line-pack:stretch;align-content:stretch}.page__container--mapview .page__footer{display:none}.page__container--mapview .mapResult{width:100%;border:0}.page__container--mapview .page__content{background-color:#fff}.ypg_dealers .page__container--mapview .page__content,.ypg_search .page__container--mapview .page__content{background-color:transparent}.page__container--mapview .page__sidebar{display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;-ms-flex:1;flex:1}.page__container--mapview .page__container-title{display:none}@media (min-width:851px){.page__container--mapview{height:calc(100% - 110px)}.page__container--mapview .page__content{width:435px;overflow-y:auto;box-shadow:1px 2px 4px rgba(0,0,0,.4);position:relative;z-index:401}.deviceTablet .page__container--mapview .page__content{width:350px}.ypg_dealers.expandMap .page__container--mapview,.ypg_merchantDirections .page__container--mapview{height:calc(100% - 169px)}}@media (min-width:0) and (max-width:850px){body:not(.expandMap) .page__container--mapview .page__sidebar{display:none}.ypg_dealers.expandMap .page__container--mapview .page__sidebar{display:none}.ypg_dealers.expandMap .page__container--mapview .page__content{-ms-flex:1;flex:1}.ypg_search.expandMap .page__container--mapview .page__content{display:none}}.expandMap .page__container--mapview .mapWrap{display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;background-color:transparent;width:100%}.action-bar__close{display:none}@media (min-width:851px){.action-bar__form-wrapper{background-color:#ffcd00;padding:15px;border-radius:0 2px 2px 2px;box-shadow:0 2px 2px -1px rgba(0,0,0,.2)}}@media (min-width:0) and (max-width:850px){.action-bar__form-wrapper{margin-left:10px;margin-right:10px}}.ypg-searchform{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.ypg-searchform ::-webkit-input-placeholder{font-weight:100}.ypg-searchform .actionWrap{display:-ms-flexbox;display:flex}.ypg-searchform .inputFormWhat,.ypg-searchform .inputFormWhere{-ms-flex:1;flex:1}.ypg-searchform .inputFormFind{position:relative;width:58px;cursor:pointer}@media (min-width:0) and (max-width:350px){.ypg-searchform .inputFormWhat{display:-ms-inline-flexbox;display:inline-flex;max-width:300px}}@media (min-width:351px) and (max-width:850px){.ypg-searchform .inputFormWhat{display:-ms-inline-flexbox;display:inline-flex;max-width:330px}}.ypg-searchform .searchFormMobileDisplay{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;position:relative}@media (min-width:0) and (max-width:350px){.ypg-searchform .searchFormMobileDisplay{display:-ms-inline-flexbox;display:inline-flex;width:300px}}@media (min-width:351px) and (max-width:850px){.ypg-searchform .searchFormMobileDisplay{display:-ms-inline-flexbox;display:inline-flex;max-width:330px}}.dineHubBodyClass .searchFormMobileDisplay{display:block;width:100%}@media (min-width:0) and (max-width:850px){.dineHubBodyClass .searchFormMobileDisplay{display:-ms-inline-flexbox;display:inline-flex;width:100%}}.search-field-outer{text-align:left;background-color:#f8f8f8;position:relative;margin:0;transition:background-color .5s ease}.search-field-outer input[type=text]{font-size:16px;font-size:1rem;color:#333;background-color:transparent;margin-bottom:0;border:0;padding:9px 0 9px 5px;width:100%;-webkit-appearance:none;-moz-appearance:none;appearance:none;height:50px}@media (min-width:0) and (max-width:850px){.search-field-outer input[type=text]{height:50px}}.search-form__button{-webkit-appearance:none;-moz-appearance:none;appearance:none;height:100%;display:block;width:100%;border:1px solid transparent;transition:background-color .3s ease;cursor:pointer;background-color:#000}@media (min-width:0) and (max-width:850px){.search-form__button{height:40px}}.search-form__button:hover{background-color:#000}.search-form__button .search__icon{position:relative;display:block;margin:auto;margin-top:0;width:25px;height:25px;background-image:url(//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/images/searchIcon.svg)}.page-SERP.expandMap .height40{height:50px!important}.ypg-header__wrapper{background-color:#ffcd00;overflow:visible;width:100%;box-shadow:none}@media (min-width:0) and (max-width:850px){.ypg-header__wrapper{padding:10px}}.homeBodyClass .ypg-header__wrapper{transition:all .3s ease;box-shadow:none}.homeBodyClass .yp-header__wrapper__home{transition:all .3s ease;padding:10px}@media (min-width:851px){.homeBodyClass .yp-header__wrapper__home{padding-top:15px;padding-bottom:15px}}.open-left{position:relative}.modal{display:none}.topnav__cta img{height:24px;width:auto;margin-top:16px}.homeservices-topMenu a{padding-top:16px}@media (min-width:600px){.ypg-connect--login .avatarName{display:inline-block;text-decoration:underline}}@media (min-width:0) and (max-width:599px){.ypg-connect--login .avatarName{display:none}}.ypg-connect--login .open-right{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;text-decoration:none}.ypg-connect--login .avatarImage{overflow:hidden;margin-left:10px;line-height:40px;text-decoration:none}.ypg-connect--login .avatarImage img{max-width:100%;border-radius:50%}.ypg-connect--login .noAvatar .avatarImage{text-align:center;background-color:#f3f3f3;border-radius:50%}.ypg-connect--login .noAvatar .ypicon{color:#333}@media (min-width:600px){.ypg-connect--login .open-right{padding-right:10px}.ypg-connect--login .avatarImage{width:40px;height:40px}.ypg-connect--login .noAvatar .ypicon{font-size:20px;font-size:1.25rem}}@media (min-width:0) and (max-width:599px){.ypg-connect--login .open-right{line-height:30px}.ypg-connect--login .avatarImage{height:30px;width:30px;line-height:30px;top:0}.ypg-connect--login .noAvatar .ypicon{font-size:15px;font-size:.9375rem}}.module--ads{margin-bottom:30px;background-color:#fff;border-radius:2px;box-shadow:0 2px 2px -1px rgba(0,0,0,.2);line-height:130%;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center}.module--ads .boxTitle,.module--ads h1{font-size:18px;font-size:1.125rem;margin-bottom:10px;font-weight:300;padding:0;display:block}.ypbtn.searchFromHere{display:none}.sharemenu__root{position:relative}.shares__submenu{opacity:0;position:absolute;top:100%;min-width:120px;-ms-transform:scale(0) translateX(-50%);transform:scale(0) translateX(-50%)}.sharemenu__root{position:relative}.shares__submenu{opacity:0;position:absolute;top:100%;min-width:120px;-ms-transform:scale(0) translateX(-50%);transform:scale(0) translateX(-50%)}@media (min-width:600px){.page__content .module~.module{margin-bottom:40px}}@media (min-width:0) and (max-width:599px){.page__content .module~.module{margin-bottom:20px}}@media (min-width:600px){.page__content .module .module__title{font-size:22px;font-size:1.375rem}}@media (min-width:0) and (max-width:599px){.page__content .module .module__title{font-size:16px;font-size:1rem}}.page__sidebar .module .module__title{font-size:15px;font-size:.9375rem}.page__sidebar .module~.module{margin-top:30px}.module .module__title{font-weight:300;-ms-flex:1;flex:1;line-height:100%}.module.module--expandable{padding-bottom:0}.ypg_strat .module .sideTitle{margin-top:0}.module.ads .mediatve--ad>div{text-align:center;background-color:#fff;padding:30px 0}.devicePhone .module.ads .mediatve--ad>div{padding-top:10px;padding-bottom:10px}.module__content__mediative-ad{margin-bottom:10px}.module__expand{position:relative;margin-top:10px}.module--hide .module__expand:before{content:'';position:absolute;top:-30px;left:1px;right:1px;display:block;height:30px;background-image:linear-gradient(to bottom,rgba(255,255,255,0) 0,#f1f1f1)}@media (min-width:600px){.module__expand{padding:10px 30px}}@media (min-width:0) and (max-width:599px){.module__expand{padding:5px 0 0;text-align:center}}.module__header{border-bottom:1px solid transparent;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.module__header .module__title{font-weight:300;-ms-flex:1;flex:1;line-height:100%}.page__content .module__header.module__header--noMarginSide{margin-left:0;margin-right:0}@media (min-width:851px){.page__content .module__header{padding-bottom:15px;padding-top:25px;margin-left:30px;margin-right:30px}}@media (min-width:0) and (max-width:850px){.page__content .module__header{padding-top:20px;padding-bottom:20px;margin-left:20px;margin-right:20px}}.page__sidebar .module__header{margin-bottom:10px;border-bottom-color:#d0d0d0;padding-bottom:10px}@media (min-width:851px){.page__content .module__content{margin-left:30px;margin-right:30px;padding-bottom:20px}}@media (min-width:0) and (max-width:850px){.page__content .module__content{margin-left:20px;margin-right:20px;padding-bottom:20px}}@media (min-width:851px){.module__footer{padding:10px 30px 30px}}@media (min-width:0) and (max-width:850px){.module__footer{padding:10px 20px 20px}}.ypStars{position:relative;display:inline-block;top:0;margin:0 5px;font-size:0;white-space:nowrap}.merchantStar .ypStars__item{position:relative;display:inline-block;width:13.4px;height:15px}.ypStars__item{position:relative;display:inline-block;width:16px;height:16px}.ypStars__item+.ypStars__item{margin-left:2px}.ypStars__item:before{content:'';display:inline-block;width:15px;height:15px;margin:0}.single-step{display:none}.search-form__item input[type=text]{padding-left:15px;padding-right:15px;overflow:hidden;text-overflow:ellipsis}@media (min-width:0) and (max-width:1024px){.search-form__item input[type=text]{padding-right:33px}}.search-form__item #searchwhat{display:-ms-flexbox;display:flex;margin-right:5px}@media (min-width:0) and (max-width:850px){.search-form__item #searchwhat{margin-right:0}}.search-form__item #searchwhere{margin-left:5px}@media (min-width:0) and (max-width:850px){.search-form__item #searchwhere{margin-left:0}}.merchantImageUploadPreviewBodyClass .search-form__item #searchwhat{height:40px}.merchantImageUploadPreviewBodyClass .search-form__item #searchwhere{height:40px}.ypg-header{width:100%}@media (min-width:851px){.deviceDesktop .ypg-header{min-height:75px}}@media (min-width:0) and (max-width:850px){.deviceDesktop .ypg-header{min-height:44px}}@media (min-width:851px){.deviceDesktop.permissionOverlay .ypg-header{min-height:146px}}.homeBodyClass .ypg-header{min-height:0}.ypg-header__holder{width:100%;position:relative;z-index:107}.ypg-header__top{background-color:#fff;height:50px;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}.ypg-header__top ul{display:-ms-flexbox;display:flex}.ypg-header__top a{display:block;color:inherit;font-weight:300;text-decoration:none}.ypg-header__top--left li{color:#333}.ypg-header__top--left li:first-child a{min-width:48px;padding:0}.ypg-header__top--left a{padding-left:30px;padding-right:30px;min-height:50px;background-color:#fff;transition:background-color .3s ease}.ypg-header__top--left a.active,.ypg-header__top--left a:hover{background-color:#ffcd00}.ypg-header__top--right{color:#404040;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.ypg-header__top--right a{padding-left:15px;padding-right:15px;color:inherit}.topnav__cta{position:relative;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;height:100%}.topnav__cta.active,.topnav__cta:hover{background-color:#ffcd00}.deviceDesktop .ypg-header__top__root{height:50px}.deviceDesktop .ypg-header__root{will-change:transform;position:fixed;left:0;width:100%;z-index:201;transform:translateZ(0);transition:transform .5s}@media (min-width:851px){.header-search-toggle{-ms-flex-pack:justify;justify-content:space-between;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}body:not(.mobileSearch) .header-search-toggle{position:relative;text-align:left;padding:0;color:#333}body:not(.mobileSearch) .header-search-toggle li{border-radius:2px 2px 0 0;transition:all .3s ease;color:inherit;font-size:14px;font-size:.875rem;background-color:rgba(255,255,255,.95)}body:not(.mobileSearch) .header-search-toggle li+li{margin-left:2px}body:not(.mobileSearch) .header-search-toggle li.active,body:not(.mobileSearch) .header-search-toggle li:hover{background-color:#ffcd00}body:not(.mobileSearch) .header-search-toggle li>a,body:not(.mobileSearch) .header-search-toggle li>span{display:block;color:inherit;padding:12px 25px;text-decoration:none}body:not(.mobileSearch) .page__content .header-search-toggle li:not(.active){background-color:#e3e3e3}.ypg-header .header-search-toggle{display:none}.mobileSearch .header-search-toggle{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;margin-bottom:10px;font-size:13px;font-size:.8125rem;font-weight:300}.mobileSearch .header-search-toggle li{text-transform:uppercase;margin:0 10px;color:#6e6c6c}.mobileSearch .header-search-toggle li.active{color:#fff}.mobileSearch .mobileSearch .header-search-toggle li.active{color:#333}.mobileSearch .header-search-toggle a{display:block;text-align:center;border-bottom:3px solid transparent;color:inherit;text-decoration:none}.mobileSearch .header-search-toggle .select-search__advanced{display:none}}.header-search-toggle .select-search__advanced{text-transform:lowercase;color:#fff}.header-search-toggle .select-search__advanced a{font-weight:300;padding-right:0!important;color:inherit}@media (min-width:1140px){.action-bar__form{width:700px}.noTopSearch .action-bar__form{max-width:674px;width:auto}.searchBodyClass .action-bar__form{max-width:674px;width:auto}}.searchBodyClass .action-bar__form{max-width:674px;width:auto}body:not(.homeBodyClass) .action-bar__form{max-width:60%}.action-bar__form #searchwhat{display:-ms-flexbox;display:flex;margin-right:5px}.action-bar__form #searchwhere{margin-left:5px}@media (min-width:851px){.header-container .action-bar__form{margin-left:auto;margin-right:auto;width:852px;max-width:none}}.deviceDesktop .homeBodyClass{margin-left:100px} (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?' ='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-M3TSKZ2'); (function(){var c = document.getElementsByTagName('html')[0];c.className = c.className.replace(/no-js/, 'js');})() Icon Nails Hair Salon  &  Spa - 3-89 King St N, Waterloo, ON function logRequest(){try{var t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}t & & (t.open("GET","/ajax/utilities/frame?referrer="+document.referrer,!0),t.send())}catch(e){}};function checkIfWhiteListed(){var obj=[".*urbanizer.yp.ca.*",".*urbanizer.ca.*",".*urbanizer.qa.yp.ca.*",".*urbanizer.com.*"];var testurl="";if(this.top.location!==this.location){testurl=document.referrer}else{testurl=this.top.location}for(var i=0;i @font-face {font-family: 'YP Local';src: url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Book.woff2') format('woff2'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Book.woff') format('woff'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Book.ttf') format('truetype');font-weight: 100;font-style: normal;font-display: swap;}@font-face {font-family: 'YP Local';src: url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Medium.woff2') format('woff2'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Medium.woff') format('woff'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Medium.ttf') format('truetype');font-weight: 300;font-style: normal;font-display: swap;}@font-face {font-family: 'YP Local';src: url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Bold.woff2') format('woff2'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Bold.woff') format('woff'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-Bold.ttf') format('truetype');font-weight: 600;font-style: normal;}@font-face {font-family: 'YP Local';src: url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-BookItalic.woff2') format('woff2'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-BookItalic.woff') format('woff'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yplocal/YPLocalWeb-BookItalic.ttf') format('truetype');font-style: italic;}@font-face {font-family: 'YP Hand';src: url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yphand/YPHandWeb-Regular.woff2') format('woff2'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yphand/YPHandWeb-Regular.woff') format('woff'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/yphand/YPHandWeb-Regular.ttf') format('truetype');font-weight: normal;font-style: normal;}@font-face {font-family: 'yp-icons';src: url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/ypicons/ypca-icons.woff2') format('woff2'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/ypicons/ypca-icons.woff') format('woff'),url('//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/fonts/ypicons/ypca-icons.ttf') format('truetype');font-weight: normal;font-style: normal;font-display: swap;} var aJsFiles = []; "use strict";var $YPCA=jQuery.noConflict(),YP=window.YP||{};YP.PermissionOverlay=(function($,window,document){var permissionOverlay={$permissionOverlay:$('#permissionOverlay'),$body:$('body'),$ypgHeader:$('.jsHeader'),$cobrandHeaderIsPresent:!!$('.cobrandHeader:visible').length,_init:function(){permissionOverlay._showOverlay();permissionOverlay._addEventListeners();$(document).on('PermissionOverlay/LoggedIn',permissionOverlay._addEventListeners);},_showOverlay:function(){if($YPCA("jsPermissionOverlayActive").length>0){setTimeout(function(){$YPCA(".jsPermissionOverlayActive").removeClass("hidden");},1000);}},_addEventListeners:function(){if($YPCA('.jsPermissionOverlayActive').length>0){YPCA.Analytics.sendCustomPageView(window.tc_vars_ribbon,'WIDGET');permissionOverlay._removePermissionOverlayEvents();$(document).on('PermissionOverlay/LoggedOut',permissionOverlay._removePermissionOverlayClassName);$(document).on('breakpoint-change/js-xlarge breakpoint-change/js-xxlarge',permissionOverlay._addPermissionOverlayClassName);$(document).on('breakpoint-change/js-small breakpoint-change/js-smedium breakpoint-change/js-medium breakpoint-change/js-xmedium breakpoint-change/js-large',permissionOverlay._removePermissionOverlayClassName);}},_removePermissionOverlayEvents:function(){permissionOverlay.$permissionOverlay.on("click",".jsPermissionOverlayButton",function(e){e.preventDefault();YPCA.Analytics.resendCurrentPageView();$.post($(this).data('href'),function(data){if(data.code===1){permissionOverlay._deletePermissionOverlay();}}).fail(function(){permissionOverlay._deletePermissionOverlay();});});},_deletePermissionOverlay:function(){permissionOverlay.$permissionOverlay.remove();permissionOverlay._removePermissionOverlayClassName();},_removePermissionOverlayClassName:function(){$('#permissionOverlay').hide();permissionOverlay.$body.removeClass('permissionOverlay');permissionOverlay._onPermissionOverlayClassNameToggle();$(document).trigger('Banner/recalculateBanner');},_addPermissionOverlayClassName:function(){var cookie=$.cookie('yp.prefs'),prefPo=cookie & (cookie).po;if(prefPo===null||prefPo){permissionOverlay.$body.addClass('permissionOverlay');}permissionOverlay._onPermissionOverlayClassNameToggle();$(document).trigger('Banner/recalculateBanner');},_onPermissionOverlayClassNameToggle:function(){permissionOverlay._resizeMap();$(document).trigger('Banner/recalculateBanner');},_resizeMap:function(){if(permissionOverlay.$body.hasClass('jsMap')){$(document).trigger('Header/resized');}}};$(function(){permissionOverlay._init();});})($YPCA,window,document);"use strict";var YP=window.YP||{};YP.SetRecentSearches=(function(){var searches={alreadyShowed:false,recentSearches:[]},localStorageName='recentSearch',maxRecentSearch=3;var setRecentSearches={setRecentSearch:function(what,where,url){var search=setRecentSearches._createRecentSearchObject(what,where,url);setRecentSearches._checkIfSearchExistAndRemoveIt(search);setRecentSearches._addRecentSearch(search);setRecentSearches.setRecentSearchesInLocalStorage();},getSearches:function(){return searches;},getRecentSearchesInLocalStorage:function(){return YPCA.Utils.storageAPI.getJSON('local',localStorageName)||searches;},_checkIfSearchExistAndRemoveIt:function(search){var posElem=setRecentSearches._checkIfSearchExist(search);setRecentSearches.removeSearch(posElem);},_checkIfSearchExist:function(search){var posElem=-1;var searchText;if(search.text.normalize===undefined){searchText=setRecentSearches.normalizeInternetExplorer(search.text);searchText=searchText.replace(/[\u0300-\u036f]/g,"").toLocaleLowerCase();}else{searchText=search.text.normalize('NFD').replace(/[\u0300-\u036f]/g,"").toLocaleLowerCase();}var searchSplit=searchText.split(",");var searchWhat=searchSplit[0];var searchWhere=searchSplit[1];searches.recentSearches.forEach(function(item,index){var itemText;if(item.text.normalize===undefined){itemText=setRecentSearches.normalizeInternetExplorer(item.text);itemText=itemText.replace(/[\u0300-\u036f]/g,"").toLocaleLowerCase();}else{itemText=item.text.normalize('NFD').replace(/[\u0300-\u036f]/g,"").toLocaleLowerCase();}var itemSplit=itemText.split(",");var itemWhat=itemSplit[0];var itemWhere=itemSplit[1];if(item.text===search.text){posElem=index;return;}if(searchWhat+"s"===itemWhat||searchWhat===itemWhat+"s"||searchWhat===itemWhat & ===itemWhere){posElem=index;return;}});return posElem;},normalizeInternetExplorer:function(str){var accents='ÀÁÂÃÄÅàáâãäåÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëðÇçÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž';var accentsOut="AAAAAAaaaaaaOOOOOOOooooooEEEEeeeeeCcDIIIIiiiiUUUUuuuuNnSsYyyZz";str=str.split('');var strLen=str.length;var i,x;for(i=0;i maxRecentSearch){searches.recentSearches.pop();}},_createRecentSearchObject:function(what,where,url){var today=moment(new Date());if(YP.Utils.isDefined(where) & !==''){return{text:what+', '+where,url:url,date:today.toString()};}return{text:what,url:url,date:today.toString()};}};$YPCA(function(){searches=YPCA.Utils.storageAPI.getJSON('local',localStorageName)||searches;});var testObject={createRecentSearchObject:setRecentSearches._createRecentSearchObject}return{setRecentSearch:setRecentSearches.setRecentSearch,setRecentSearchesInLocalStorage:setRecentSearches.setRecentSearchesInLocalStorage,getRecentSearchesInLocalStorage:setRecentSearches.getRecentSearchesInLocalStorage,removeSearch:setRecentSearches.removeSearch,getSearches:setRecentSearches.getSearches,testObject:testObject};})($YPCA);"use strict";YP.Autocomplete=(function($YPCA,window,document){var cachedElements={acWhatFlag:false,acWhereFlag:false,whatUser:'',whatSelected:'',whatIndex:-1,whereUser:'',whereSelected:'',whereIndex:-1,nearMeEn:["near me","nearby","around me","close by"],nearMeFr:["près de moi","proche de moi","près d'ici","proche d'ici","proche","près","alentours","aux alentours","tout près","tout proche"]};var isShiftOn=false,autocomplete={},listeners={_addListeners:function(){autocomplete._validateForm();listeners._addWhatListener('#whatwho',function(event,suggestion){cachedElements.whatSelected=suggestion.value;autocomplete.$whatEl.removeData('suggestion');if(suggestion.code!==''){cachedElements.whatSelected=suggestion.alt;autocomplete.$whatEl.data('suggestion',suggestion);}cachedElements.whatIndex=autocomplete._getPositionInArray(cachedElements.whatSuggestedValues,cachedElements.whatSelected);cachedElements.acWhatFlag=true;YP.Analytics.searchWhat(cachedElements.whatUser,cachedElements.whatSelected,cachedElements.whatIndex,suggestion.merchantDetail);YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhatClearInput'),autocomplete.$whatEl);cachedElements.whatIsSelected=true;});listeners._addWhereListener('#where, #whereModal',function(obj,datum){var $input=$YPCA(obj.currentTarget),isDiscoverModal=$input.closest("#ypModalLocation").length!==0;if($YPCA('#ypModalLocation:visible').length>0||$YPCA('#ypModal:visible').length>0){if(autocomplete.settings.IS_HOMEPAGE & & $input.val()!=='' & ){YP.Discover.callNewDiscover($input.val(),$input.data("ajax")+$input.val()+'/'+datum.geoCode.latitude+'/'+datum.geoCode.longitude,datum.geoCode.latitude,datum.geoCode.longitude);}else if(autocomplete.settings.IS_DEALSPAGE & & $input.val()!==''){YP.Deals.goToLocation(datum.value,datum.geoCode.latitude,datum.geoCode.longitude);}}else{if($YPCA.trim($YPCA('#whatwho').val()).length!==0){autocomplete._search();}else{autocomplete._validateForm();autocomplete.$whatEl.select().focus();}}},{});if(!autocomplete.settings.isWhereSuggestedLocation){listeners._addLocationListener();}listeners._addKeyListener();listeners._addWhatEventsListener();listeners._addWhereEventsListener();},_addKeyListener:function(){$YPCA(document).on('typeahead:selected',function(event,suggestion){autocomplete.settings.whatVal=suggestion.value;autocomplete.settings.whereVal=suggestion.value;if(suggestion.merchantDetail){location.href=suggestion.merchantDetail;}});$YPCA('.ypCreate input').on('keydown',function(e){if(YP.Utils.isShiftKeyPressed(e)){isShiftOn=YP.Utils.isShiftKeyPressed(e);}}).on('keyup',function(e){if(YP.Utils.isShiftKeyPressed(e)){isShiftOn=false;}});},_addLocationListener:function(){autocomplete.$locationLink.on('click',function(e){e.preventDefault();YP.LocationService.fetchGeoIPLocation(function(data){autocomplete._processCurrentLocationData(data);});});$YPCA(document).on('LocationService/locationTranslated',function(event,locationTranslated){cachedElements.locationSettings=locationTranslated;});$YPCA(document).on('click','.jsBtnSearchForm',function(){if($YPCA('.jsWhere').is(':visible') & & $YPCA('.jsWhere').val()!==''){$YPCA(document).trigger('LocationService/locationTranslated',{label:YPCA.Utils.storageAPI.get('session','locationTranslated'),useGeoIp:false});}});},_addWhatEventsListener:function(){autocomplete.$whatEl.on('keydown',function(e){if(YP.Utils.isTabKeyPressed(e)){e.preventDefault();autocomplete._removeForcedSuggestion(autocomplete.settings.whatVal,autocomplete.$whatEl);autocomplete._checkWhatError();}YP.Autocomplete.navigateDropdownKey(e,'#searchwhat');});autocomplete.$whatEl.on('keyup',function(){autocomplete.settings.whatVal=autocomplete.$whatEl.typeahead('val');YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhatClearInput'),autocomplete.$whatEl);});},_addWhatListener:function(selector,callback){var remoteSuggestions=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace('value'),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:'/tools/ac/what/%QUERY/',wildcard:'%QUERY',transform:function(data){cachedElements.whatUser=$YPCA('#whatwho').val();cachedElements.whatSuggestedValues=data.suggestedValues;return data.suggestedValues;}}});return $YPCA(selector).typeahead({highlight:true,minLength:1,classNames:{menu:'tt-dropdown-menu'}},{name:'what',display:'alt',templates:{suggestion:Handlebars.compile(' '+$YPCA('#autocompleteTemplate').html()+' ')},source:remoteSuggestions,limit:10}).on('typeahead:select',function(event,suggestion){callback(this,suggestion);});},_addWhereEventsListener:function(){autocomplete.$whereEl.on('keydown',function(e){if(YP.Utils.isTabKeyPressed(e)){$YPCA('#searchwhere .tt-is-under-cursor').trigger("click");autocomplete._removeForcedSuggestion(autocomplete.settings.whereVal,autocomplete.$whereEl);autocomplete._skipTabKey();}YP.Autocomplete.navigateDropdownKey(e,'#searchwhere');});autocomplete.$whereEl.on('keyup',function(){autocomplete.settings.whereVal=autocomplete.$whereEl.typeahead('val');});$YPCA('#whereModal').on('keydown',function(e){if(YP.Utils.isEnterKeyPressed(e)){$YPCA('#ypModalLocation .tt-suggestion:first').trigger("click");}if(YP.Utils.isUpOrDownArrowKeyPressed(e)){$YPCA('.inputFormWhere').removeClass("firstSelected");}});$YPCA(document).on('LocationService/locationTranslated/Near',function(){var whereValue=YPCA.Utils.storageAPI.get('session','locationTranslated');$YPCA('#where').val(whereValue);YP.Autocomplete.triggerSearch();});},_addWhereListener:function(selector,callback,options){var remoteCitySuggestions=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace('value'),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:YP.Utils.isDefined(options.url) & !==''?options.url:'/tools/ac/where/%QUERY/',wildcard:'%QUERY',transform:function(data){cachedElements.whereUser=$YPCA('#where').val();cachedElements.whereSuggestedValues=data.suggestedValues;return data.suggestedValues;}}});return $YPCA(selector).typeahead({highlight:true,minLength:1,classNames:{menu:'tt-dropdown-menu'}},{name:'where',display:'value',templates:{suggestion:Handlebars.compile(' '+"{{value}}"+' ')},source:remoteCitySuggestions,limit:10}).on('typeahead:asyncreceive',function(){autocomplete._fetchTemplateForCurrentLocation(options.parentContainer);}).on('typeahead:select',function(event,suggestion){cachedElements.whereSelected=suggestion.value;cachedElements.whereIndex=autocomplete._getPositionInArray(cachedElements.whereSuggestedValues,cachedElements.whereSelected);cachedElements.acWhereFlag=true;YP.Analytics.searchWhere(cachedElements.whereUser,cachedElements.whereSelected,cachedElements.whereIndex);YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhereClearInput'),autocomplete.$whereEl);callback(this,suggestion);});}};autocomplete={settings:{whatVal:'',isWhereSuggestedLocation:false,WHAT:'whatwho',WHERE:'where',WHERE_DISCOVER:'whereModal',hasValidSearchForm:false,whereVal:''},dataHTMLTemplate:{currentLocationLabel:'',isLocationFound:false},_init:function(){listeners._addListeners();autocomplete.publicFunctions.toggleClearSearchIcon($YPCA('.jsWhatClearInput'),autocomplete.$whatEl);},_checkWhatError:function(){if(!$YPCA('#searchwhat label:visible').hasClass('error')){$YPCA('#searchwhat .tt-is-under-cursor').trigger("click");if(autocomplete.$whereEl.hasClass('hidden')){$YPCA('.jsWhere').select().focus();}else{autocomplete.$whereEl.select().focus();}}},_getErrorMsgWhat:function(){switch(autocomplete.$form.attr('data-search-type')){case"reverse":return YP.Common.getMessage("header.whatInput.empty.phone.error");case"person":return YP.Common.getMessage("header.whatInput.empty.person.error");default:return YP.Common.getMessage("header.whatInput.empty.error");}},_fetchTemplateForCurrentLocation:function(parentContainer){var template=Handlebars.compile(' '+$YPCA('#autocompleteTemplateForCurrentLocation').html()+' '),ttDataSetWhere=$YPCA('.tt-dataset-where:visible'),currentLocationTypeAhead=$YPCA('.jsCurrentLocationForTypeahead');autocomplete.dataHTMLTemplate=YP.PreviousLocation.setWhereDropdownCurrentLocation();if(YP.Utils.isDefined(parentContainer)){if(YP.LocationService.userAcceptedLocation() & & $YPCA('#search-action-resource').length>0 & & $YPCA('body').hasClass('merchantDirectionsBodyClass')){var jsonConfig=YP.Utils.convertDataToJSON($YPCA('#search-action-resource'));autocomplete.dataHTMLTemplate.currentLocation=jsonConfig.maskedLocationLabelGetDirections;}ttDataSetWhere=$YPCA(parentContainer+' .tt-dataset-where:visible');currentLocationTypeAhead=$YPCA(parentContainer+' .jsCurrentLocationForTypeahead');}if(currentLocationTypeAhead.length===0){ttDataSetWhere.prepend(template(autocomplete.dataHTMLTemplate));}else if(currentLocationTypeAhead.is(':hidden')){ttDataSetWhere.prepend(template(autocomplete.dataHTMLTemplate));}},_processCurrentLocationData:function(data){if(data.label & >0){autocomplete.$whereEl.typeahead('val',data.label);}else{autocomplete.$whereEl.typeahead('val','');}autocomplete.validator.element(autocomplete.$whereEl);},_validateForm:function(){if(YP.Utils.isUndefined(autocomplete.validator)){autocomplete.validator=autocomplete.$form.validate({invalidHandler:function(event,validator){for(var i=0;i 2){where=transformedWhere;}return where;},_search:function(){var disambiguation,disambiguationParam='',whatwho=YP.Utils.doubleEncoding($YPCA('#whatwho').val()),where=encodeURIComponent(autocomplete.$whereEl.val().replace(/\//g,'%2F').replace(/\\/g,'%5C').replace(/\?/g,'%3F')),expandMap='',latLong='',newLocation,config=autocomplete._setPageResultToShow(),searchType='/si/',isGeolocation=YP.Utils.isDefined(cachedElements.locationSettings) & & !cachedElements.locationSettings.useGeoIp & ===autocomplete.$whereEl.val();if(YP.Utils.isDefined($YPCA('#whatwho').data('suggestion'))){disambiguation=$YPCA('#whatwho').data('suggestion');if(whatwho===encodeURIComponent(disambiguation.alt.replace(/\//g,'%2F').replace(/\\/g,'%5C').replace(/\?/g,'%3F').replace(/\;/,'%3B'))){disambiguationParam='/'+disambiguation.code;whatwho=encodeURIComponent(disambiguation.value.replace(/\//g,'%2F').replace(/\\/g,'%5C').replace(/\?/g,'%3F').replace(/\;/,'%3B'));}}if(!cachedElements.acWhatFlag){YP.Analytics.searchWhat(whatwho,'',-1,false,'');}if(!cachedElements.acWhereFlag){YP.Analytics.searchWhere(where,'',-1);}if(config.mapSearch & & !config.isCobrand){expandMap=' =list';searchType='/si/';}if(isGeolocation & $form.data('search-type')==='business'){var oCoordinates=YPCA.Utils.storageAPI.get('session','latLong');if(oCoordinates!==null){latLong=YP.LocationService.getLatLongURL(' & ');}}var ua=navigator.userAgent;var is_ie=ua.indexOf("MSIE ")>-1||ua.indexOf("Trident/")>-1;if(!is_ie){var what=$YPCA('#whatwho').val();var where=$YPCA('#where').val();var nearMeTerm=cachedElements.nearMeEn;if(YP.Utils.isFrenchSite()){nearMeTerm=cachedElements.nearMeFr;}for(var i=0;i =0||where.search(regExp)>=0){if(YP.LocationService.userAcceptedLocation()){$YPCA(document).trigger('LocationService/locationTranslated/Near',{label:YPCA.Utils.storageAPI.get('session','locationTranslated'),useGeoIp:false});return false;}else if(!YP.LocationService.userDeniedLocation() & & !YP.LocationService.userAcceptedLocation()){$YPCA(document).trigger('LocationService/triggerLocation');return false;}}}}if($YPCA(".searchNearMerchant").length>0){var oCoordinatesMerchant=YPCA.Utils.storageAPI.get('merchant','latLong');if(oCoordinatesMerchant!==null){var link='/tools/rl/{{latitude}}/{{longitude}}'.replace('{{latitude}}',JSON.parse(oCoordinatesMerchant).latitude).replace('{{longitude}}',JSON.parse(oCoordinatesMerchant).longitude);$YPCA.ajax({type:'GET',url:link,async:false,success:function(data){where=data.displayableLabel;}});latLong='?latitude='+JSON.parse(oCoordinatesMerchant).latitude+' ='+JSON.parse(oCoordinatesMerchant).longitude;}var url=" ="+$YPCA('#where').val();}YPCA.Analytics.submit(autocomplete.$form,function(){var urlWhereTransform="/ajax/resolveLocation?address="+where;$YPCA.ajax({url:urlWhereTransform,type:"GET",success:function(res){where=autocomplete._normalizeWhere(res,where);if(url==null){newLocation=autocomplete.$form.attr('data-action').replace('{{what}}',whatwho).replace('{{where}}',where).replace(/\/si\//,searchType)+disambiguationParam+latLong+expandMap;}else{newLocation=autocomplete.$form.attr('data-action').replace('{{what}}',whatwho).replace('{{where}}',where).replace(/\/si\//,searchType)+disambiguationParam+latLong+expandMap+url;}if(autocomplete.$form.data('search-type')==='person'){location.href=newLocation;return false;}if(newLocation.indexOf('?')===-1){newLocation=newLocation.replace(' & ','?');}if(newLocation.indexOf(':')!==-1){newLocation=newLocation.replace(/\:/g,'%3A');}if(newLocation.indexOf(' ')!==-1){newLocation=newLocation.replace(/\s/g,'+');}YPCA.Utils.storageAPI.remove('mapBounds');if(isNaN(autocomplete.$whatEl.val())){YP.SetRecentSearches.setRecentSearch(autocomplete.$whatEl.val(),autocomplete.$whereEl.val(),newLocation);}location.href=newLocation;}})});},_normalizeString:function(str){var accents='ÀÁÂÃÄÅàáâãäåÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëðÇçÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž';var accentsOut="AAAAAAaaaaaaOOOOOOOooooooEEEEeeeeeCcDIIIIiiiiUUUUuuuuNnSsYyyZz";str=str.split('');var strLen=str.length;var i,x;for(i=0;i 0){var config=YP.Utils.convertDataToJSON($YPCA('.jsSuggestedLocationsConfig'));autocomplete.settings=$YPCA.extend(autocomplete.settings,config);return autocomplete.settings.suggestedLocationLabel;}},_setPageResultToShow:function(){var config=this._convertDataToJSON($YPCA('.jsPageConfigurationResource'));return{"mapSearch":config.mapSearch,"isCobrand":config.isCobrand};},_convertDataToJSON:function(data){var json;try{json=JSON.parse(data.html());}catch(e){console.log(e.toString());}return json;},_getPositionInArray:function(whatSuggestedValues,whatSelected){var pos=-1;for(var i=0;i 0){$YPCA('.jsBtnSearchForm').focus();return false;}},_removeForcedSuggestion:function(initialValue,target){if(initialValue!==target.typeahead('val')){target.typeahead('val',initialValue);}},publicFunctions:{placeholderValue:function(){var whatwhoElVal=$YPCA('#whatwho').val(),whatwhoElPlaceHolder=$YPCA('#whatwho').attr('placeholder'),whereElVal=$YPCA('#where').val(),whereElPlaceHolder=$YPCA('#where').attr('placeholder');if(whatwhoElVal===whatwhoElPlaceHolder||whatwhoElVal===whatwhoElPlaceHolder.replace(/\?/g,'')){$YPCA('#whatwho').val('');}if(whereElVal===whereElPlaceHolder||whereElVal===whereElPlaceHolder.replace(/\?/g,'')){$YPCA('#where').val('');}},addWhereListener:function(selector,callback,options){return listeners._addWhereListener(selector,callback,options);},addWhatListener:function(selector,callback){return listeners._addWhatListener(selector,callback);},clearSearchInputField:function(icon,searchInput,callback){searchInput.focus();searchInput.typeahead('close');searchInput.typeahead("val",'');icon.addClass('hidden');searchInput.val('');if(callback){callback();}},navigateDropdownKey:function(keyCode,parentSelector){if(YP.Utils.isUpOrDownArrowKeyPressed(keyCode) & & $YPCA(parentSelector+' .tt-suggestion.tt-cursor').length>0){$YPCA(parentSelector+" .tt-dataset").scrollTop(0);$YPCA(parentSelector+" .tt-dataset").scrollTop($YPCA(parentSelector+' .tt-suggestion.tt-cursor').position().top);}},removeForcedSuggestion:function(initialValue,target){autocomplete._removeForcedSuggestion(initialValue,target);},toggleClearSearchIcon:function(icon,searchInput){if(icon.length>0){icon.toggleClass('hidden',searchInput.val().length < 1);}},triggerSearch:function(){autocomplete._search();},normalizeWhereForJasmine:function(res,where){return autocomplete._normalizeWhere(res,where);}}};$YPCA.extend($YPCA.validator.messages,{maxlength:$YPCA.validator.format(YP.Common.getMessage("header.input.maxlength"))});$YPCA(function(){autocomplete.$whatEl=$YPCA('#'+autocomplete.settings.WHAT);autocomplete.$whereEl=$YPCA('#'+autocomplete.settings.WHERE);if(autocomplete.$whatEl.length>0 & $whereEl.length>0){autocomplete.$locationLink=$YPCA('#ypgHeaderLocationLink');autocomplete.$form=$YPCA("#inputForm");autocomplete.settings.IS_HOMEPAGE=$YPCA('body.desktop').hasClass('ypg_home');autocomplete.settings.IS_DEALSPAGE=$YPCA('body').hasClass('ypg_deals');autocomplete._init();}});return autocomplete.publicFunctions;})($YPCA,window,document);"use strict";var $YPCA=jQuery.noConflict(),YP=window.YP||{};YP.Analytics=(function($YPCA){var analyticSettings={analytics:{},analyticsOverlay:{},analyticsShare:{},analyticsAutocomplete:{},analyticsReview:{},analyticsSmarttips:{},analyticsSubscriptionWidget:{},analyticsSendEventOnceList:["star1","star2","star3","star4","star5"]};var uiAnalyticsCallback={click:function(event,analyticsJson){tc_events_3(event,'LINK',analyticsJson);},page:function(analyticsJson,type){tc_events_3(null,type,analyticsJson);}};YPCA.Analytics.init(uiAnalyticsCallback);var analytics={_initAnalyticsOverlay:function(){var $configAnalytic=$YPCA('#analytics-resource-overlay');if($configAnalytic.length>0 & & $YPCA.isEmptyObject(analyticSettings.analyticsOverlay)){analyticSettings.analyticsOverlay=JSON.parse($configAnalytic.html());}},_initAnalyticsAutocomplete:function(){var $configAnalytic=$YPCA('#autocomplete-analytics-resource');if($configAnalytic.length>0 & & $YPCA.isEmptyObject(analyticSettings.analyticsAutocomplete)){analyticSettings.analyticsAutocomplete=JSON.parse($configAnalytic.html());}},_initAnalyticsReview:function(){var $configAnalytic=$YPCA('#analytics-resource-review');if($configAnalytic.length>0 & & $YPCA.isEmptyObject(analyticSettings.analyticsReview)){analyticSettings.analyticsReview=JSON.parse($configAnalytic.html());}},_initAnalyticsSubscriptionWidget:function(){var $configAnalytic=$YPCA('#subscription-widget'),$subscriptionContainer=$YPCA('.jsSubscriptionContainer');if($subscriptionContainer.length>0 & (window.tc_vars_subscription_widget)){setTimeout(function(){YPCA.Analytics.sendCustomPageView(window.tc_vars_subscription_widget,'WIDGET');},1500);}if($configAnalytic.length>0 & & $YPCA.isEmptyObject(analyticSettings.analyticsSubscriptionWidget)){analyticSettings.analyticsSubscriptionWidget=JSON.parse($configAnalytic.html());}},_initAnalyticsSmarttips:function(){var $configAnalytic=$YPCA('#analytics-resource-smarttips');if($configAnalytic.length>0 & & $YPCA.isEmptyObject(analyticSettings.analyticsSmarttips)){analyticSettings.analyticsSmarttips=JSON.parse($configAnalytic.html());$YPCA.each(analyticSettings.analyticsSmarttips,function(selector,json){$YPCA(selector).attr("data-analytics",JSON.stringify(json));});$YPCA("div.post_recent article.post_short a").on("mousedown",function(){var curData=$YPCA(this).data("analytics");curData.lk_name=$YPCA(this).attr('href');$YPCA(this).attr("data-analytics",JSON.stringify(curData));});}},setDataAnalytics:function(data){$YPCA.each(data,function(selector,json){$YPCA(selector).attr("data-analytics",JSON.stringify(json));});},buildAnalytic:function(key,value){return"'"+key+"':'"+value+"'";},publicFunctions:{showMapOverlay:function(){YPCA.Analytics.triggerPageView('analytics-map-resource');},showSelectLocationOverlay:function(){YPCA.Analytics.triggerPageView('analytics-select-location-resource');},showOverlay:function(overlayName,type){var typeAnalytics=YP.Utils.isDefined(type) & !==''?type:'VIEW';YPCA.Analytics.triggerPageView('analytics-overlay-resource',null,overlayName,typeAnalytics);},hideOverlay:function(){var hideOverlayJson={'tags':{'anametrix':'true'}};$YPCA.extend(hideOverlayJson,tc_vars);YPCA.Analytics.pageView(hideOverlayJson);},showRateResults:function(formQuestion){YPCA.Analytics.triggerPageView('rateResultsAnalytics',null,formQuestion);},setAnalyticTopBar:function(){analytics.setDataAnalytics($YPCA('body').hasClass('expandMap')?analyticSettings.analytics.merchandSmallCardAnalytics:analyticSettings.analytics.merchandCardAnalytics);},callShareAnalytic:function(provider){YPCA.Analytics.clicks(this,analyticSettings.analyticsShare[provider]);},callOverlayAnalytic:function(handle){YPCA.Analytics.clicks(this,analyticSettings.analyticsOverlay[handle]);},callReviewAnalytic:function(handle){YPCA.Analytics.clicks(this,analyticSettings.analyticsReview[handle]);},callSubscriptionWidgetAnalytic:function(isSuccess){if(isSuccess){YPCA.Analytics.clicks(this,analyticSettings.analyticsSubscriptionWidget.analytics);}else{var $subscriptionWidgetAnalyticsData=$YPCA.extend(analyticSettings.analyticsSubscriptionWidget.analytics,{"lk_name":"email-error","event_name":"click - Newsletter Widget RHS - Error"});YPCA.Analytics.clicks(this,$subscriptionWidgetAnalyticsData);}},searchWhat:function(user,txt,idx,isMerchantDetail,mid){if(YP.Utils.isDefined(analyticSettings.analyticsAutocomplete.autocomplete_what)){$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_what["data-analytics"],{"lk_what_user":user});$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_what["data-analytics"],{"lk_what_ac_txt":txt});$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_what["data-analytics"],{"lk_what_ac_idx":idx});if(isMerchantDetail){$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_what["data-analytics"],{"lk_name":"busnameautocomplete-mp"});$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_what["data-analytics"],{"lk_listing_id":mid});$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_what["data-analytics"],{"lk_directory_heading":"[]"});}YPCA.Analytics.clicks(this,analyticSettings.analyticsAutocomplete.autocomplete_what);}},searchWhere:function(user,txt,idx){if(YP.Utils.isDefined(analyticSettings.analyticsAutocomplete.autocomplete_where)){$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_where["data-analytics"],{"lk_where_user":user});$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_where["data-analytics"],{"lk_where_ac_txt":txt});$YPCA.extend(analyticSettings.analyticsAutocomplete.autocomplete_where["data-analytics"],{"lk_where_ac_idx":idx});YPCA.Analytics.clicks(this,analyticSettings.analyticsAutocomplete.autocomplete_where);}},analyticsForMap:function($elemSelector,dataAttr,newData){$elemSelector.each(function(index,elem){$YPCA(elem).attr('data-analytics',JSON.stringify($YPCA.extend($YPCA(elem).data(dataAttr),newData)));});},initAnalytics:function(){var $configAnalytic=$YPCA('#analytics-resource');if($configAnalytic.length>0 & & $YPCA.isEmptyObject(analyticSettings.analytics)){analyticSettings.analytics=JSON.parse($configAnalytic.html());analytics.setDataAnalytics(analyticSettings.analytics.multimediaAnalytics);}}}};$YPCA(function(){analytics._initAnalyticsOverlay();analytics._initAnalyticsAutocomplete();analytics._initAnalyticsReview();analytics._initAnalyticsSmarttips();analytics._initAnalyticsSubscriptionWidget();});return analytics.publicFunctions;})($YPCA);"use strict";YP.Modal=(function($YPCA,window,document){var modal={publicFunctions:{hideBackdrop:function(){var backdrops=$YPCA('.modal-backdrop');if(backdrops.length>1){$YPCA(backdrops[0]).remove();}},show:function(target,url,callbackSuccess,callbackError){var $modal=null;$YPCA.ajax({type:'get',url:url,async:false,headers:{'X-Requested-With':'XMLHttpRequest'},xhrFields:{withCredentials:true}}).done(function(html){var $target=$YPCA(target);if($target.length>0){var $previousModal=$target.find('[role="dialog"]');if($previousModal.length>0){$previousModal.modal('hide');}$target.html(html);$modal=$target.find('[role="dialog"]');if($modal.length!==0){$modal.trigger({type:'loaded',url:url,modal:$modal});$modal.modal('show');if(callbackSuccess){callbackSuccess($modal);}}}}).fail(function(jqXHR,textStatus){YP.Common.traceLog("Request failed: "+textStatus);if(callbackError){callbackError();}});return $modal;},trigger:function($source){if(YP.Utils.isDefined($source.attr('data-modal-url')) & ($source.attr('data-target'))){modal.publicFunctions.show($source.attr('data-target'),$source.attr('data-modal-url'));}}}};$YPCA(function(){$YPCA(document).on('click',"[data-toggle='ajax-modal']",function(){modal.publicFunctions.trigger($YPCA(this));});});return modal.publicFunctions;})($YPCA,window,document);YP.Events={LoginHeaderUpdated:'LoginHeaderUpdatedEvent',OAuthProcessCompleted:'OAuthProcessCompletedEvent'};"use strict";YP.PreviousLocation=(function($YPCA,window,document){var dataHTMLTemplate={currentLocationLabel:'',isLocationFound:false};var previousLocation={settings:{cssClassItemHover:"search-dropdown__list__item--hover",deleteCookiesURL:'',displayBoxIndex:-1,hasAcceptedLocation:false,isWhereSuggestedLocation:false,isCurrentLocation:false,isWhereFocus:false,$what:$YPCA('#whatwho'),$whereAndSuggestedLocation:$YPCA("#where, .jsSuggestedLocation"),$where:$YPCA('#where'),$newWhere:$YPCA('.jsWhere'),$whereWrapper:$YPCA("#searchwhere, #searchwhere"),$whereWrapperInner:$YPCA(".suggested-location__wrapper--inner"),$curlocIcon:$YPCA('.jsIconCurloc')},_init:function(){previousLocation._getConfigFeature();previousLocation._prefilWhereOnLoad();},_animationSlideDropdownLocation:function(){$YPCA(".jsSuggestedLocationList").slideUp(250,function(){$YPCA('.jsSuggestedLocationMsgSuccess').slideDown().addClass("active");});},_clearPreviousLocation:function(url){return $YPCA.ajax({type:"GET",url:url});},_getConfigFeature:function(){if($YPCA('#feature-where-smart-autocomplete').length>0){var config=YP.Utils.convertDataToJSON($YPCA('#feature-where-smart-autocomplete'));previousLocation.settings=$YPCA.extend(previousLocation.settings,config);previousLocation._addWhereListener();YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhereClearInput'),previousLocation.settings.$where);dataHTMLTemplate.currentLocationLabel=previousLocation.settings.messages.locationLabel;}},_prefilWhereOnLoad:function(){if(YPCA.Utils.isLocalStorageNameSupported() & $where.val()===YPCA.Utils.storageAPI.get('session','locationTranslated') & ()){previousLocation._addRemoveHidden(previousLocation.settings.$where,previousLocation.settings.$newWhere);previousLocation.settings.$curlocIcon.removeClass('hidden');}},_displayWhereSuggestion:function(){var templateHandlebars=$YPCA("#whereFieldTemplate").html(),theTemplate=Handlebars.compile(templateHandlebars);previousLocation.settings.$whereWrapper.append(theTemplate(dataHTMLTemplate));},_onClickWhere:function(event){if(previousLocation.settings.$where.prop('value')===''){var cookie=$YPCA.cookie('yp.prefs'),showToggle=YP.Utils.isEnterKeyPressed(event) & & $YPCA("#searchwhere label.error").css('display')==="block"?false:true;previousLocation.publicFunctions.attributeCookieValues(cookie);previousLocation.publicFunctions.setWhereDropdownCurrentLocation();if($YPCA(".jsSuggestedLocation").length===0){previousLocation._displayWhereSuggestion();}else{$YPCA(".jsSuggestedLocation").appendTo(previousLocation.settings.$whereWrapper).toggle(showToggle);}if($YPCA('.jsCurrentLocationItem').text()===previousLocation.settings.messages.currentLocationLabelForMap){$YPCA('.jsCurrentLocationItem').text(YP.LocationService.getMaskedTranslatedLatLong());$YPCA("#previousLocation").show();}}},_onKeyUp:function(e){var inputValue=$YPCA(e.target).val();if(YP.Utils.isKeyPressed(e,40)){previousLocation._navigateDropdownKey(1);}else if(YP.Utils.isKeyPressed(e,38)){previousLocation._navigateDropdownKey(-1);}else if(YP.Utils.isEnterKeyPressed(e) & _isPreviousLocationVisible()){var activeElement=$YPCA('.jsSuggestedLocationItem.'+previousLocation.settings.cssClassItemHover);if(activeElement.hasClass('jsSuggestedLocationItemCurrent')){previousLocation._onClickCurrentLocation(activeElement,e);}else{previousLocation._submitTextIntoField(activeElement,previousLocation.settings.isCurrentLocation);}}else if(inputValue===''){previousLocation._onClickWhere(e);}else{previousLocation._hidePreviousLocation();}},_clickPreviousLocationItem:function(){var valueWhat=previousLocation.settings.$what.val(),valueWhere=previousLocation.settings.$where.val();previousLocation._hidePreviousLocation();if(valueWhat===''){previousLocation.settings.$what.focus();previousLocation.settings.$where.val(valueWhere);}else{YP.Autocomplete.triggerSearch();}},_hidePreviousLocation:function(){$YPCA(".jsSuggestedLocation").hide();previousLocation.settings.isCurrentLocation=false;},_hideMessageSucess:function(){if($YPCA('.jsSuggestedLocationMsgSuccess').hasClass('active')){$YPCA('.jsSuggestedLocationMsgSuccess').removeClass('active');$YPCA('.suggested-location__previous').hide();}},_submitTextIntoField:function(elem,isCurrentLocationSearch){var valueClicked=elem.text();previousLocation.settings.$where.val($YPCA.trim(valueClicked));if(YPCA.Utils.isLocalStorageNameSupported() & & $YPCA.trim(valueClicked)===YP.LocationService.getMaskedTranslatedLatLong()){previousLocation.settings.$where.val(YPCA.Utils.storageAPI.get('session','locationTranslated'));}if(isCurrentLocationSearch & ()){previousLocation._addRemoveHidden(previousLocation.settings.$where,previousLocation.settings.$newWhere);previousLocation.settings.$curlocIcon.removeClass('hidden');previousLocation.settings.$newWhere.val($YPCA.trim(valueClicked));}previousLocation._clickPreviousLocationItem();YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhereClearInput'),previousLocation.settings.$where);},_isPreviousLocationVisible:function(){return $YPCA(".jsSuggestedLocationItem").is(":visible") & & $YPCA(".jsSuggestedLocationItem").hasClass(previousLocation.settings.cssClassItemHover);},_addRemoveHidden:function(addTo,removeFrom){addTo.addClass('hidden');removeFrom.removeClass('hidden');},_addWhereListener:function(){if(previousLocation.settings.isWhereSuggestedLocation){previousLocation.settings.$where.on('keyup',function(e){if(!YP.Utils.isTabKeyPressed(e)){previousLocation._onKeyUp(e);}YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhereClearInput'),previousLocation.settings.$where);});previousLocation.settings.$newWhere.on('keyup',function(e){if(!YP.Utils.isTabKeyPressed(e) & $newWhere.prop('value')===''){previousLocation._addRemoveHidden(previousLocation.settings.$newWhere,previousLocation.settings.$where);previousLocation.settings.$curlocIcon.addClass('hidden');previousLocation.settings.$where.val('');previousLocation.settings.$where.focus();$YPCA('.typeahead').typeahead('close');previousLocation.settings.$where.typeahead("val","");}});previousLocation.settings.$where.on('keydown',function(e){if(YP.Utils.isTabKeyPressed(e)){if(previousLocation._isPreviousLocationVisible()){var activeElement=$YPCA('.jsSuggestedLocationItem.'+previousLocation.settings.cssClassItemHover);if(activeElement.hasClass('jsSuggestedLocationItemCurrent')){previousLocation._onClickCurrentLocation(activeElement,e);}else{previousLocation._submitTextIntoField(activeElement,previousLocation.settings.isCurrentLocation);}e.preventDefault();}else if(e.shiftKey & (e)){previousLocation.settings.$what.focus();}else{previousLocation._hidePreviousLocation();$YPCA('.jsBtnSearchForm').focus();}return false;}});previousLocation.settings.$newWhere.on('keydown',function(e){if(YP.Utils.isTabKeyPressed(e)){if(previousLocation._isPreviousLocationVisible()){var activeElement=$YPCA('.jsSuggestedLocationItem.'+previousLocation.settings.cssClassItemHover);if(activeElement.hasClass('jsSuggestedLocationItemCurrent')){previousLocation._onClickCurrentLocation(activeElement,e);}else{previousLocation._submitTextIntoField(activeElement,previousLocation.settings.isCurrentLocation);}e.preventDefault();}else if(e.shiftKey & (e)){previousLocation.settings.$what.focus();}else{previousLocation._hidePreviousLocation();$YPCA('.jsBtnSearchForm').focus();}return false;}else if(!YP.Utils.isBackspaceKeyPressed(e) & & !YP.Utils.isDeleteKeyPressed(e)){previousLocation._addRemoveHidden(previousLocation.settings.$newWhere,previousLocation.settings.$where);previousLocation.settings.$where.focus();previousLocation.settings.$where.val('');previousLocation.settings.$curlocIcon.addClass('hidden');}});previousLocation.settings.$where.on('click focus',function(e){e.stopPropagation();previousLocation.settings.isWhereFocus=true;previousLocation._onClickWhere(e);previousLocation._hideMessageSucess();YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhereClearInput'),previousLocation.settings.$where);});previousLocation.settings.$newWhere.on('click focus',function(e){e.stopPropagation();previousLocation.settings.isWhereFocus=true;if(previousLocation.settings.$newWhere.prop('value')===''){previousLocation._addRemoveHidden(previousLocation.settings.$newWhere,previousLocation.settings.$where);previousLocation.settings.$curlocIcon.addClass('hidden');}});previousLocation.settings.$where.on('blur',function(){previousLocation.settings.isWhereFocus=false;});previousLocation.settings.$newWhere.on('blur',function(){previousLocation.settings.isWhereFocus=false;});previousLocation.settings.$what.on('click focus',function(){previousLocation._hidePreviousLocation();});previousLocation.settings.$whereWrapper.on('click','.jsSuggestedLocationItem',function(){previousLocation._onClickCurrentLocation($YPCA(this));});previousLocation.settings.$whereWrapper.on('click','.jsClearSearchedLocation',function(){$YPCA(this).hide();previousLocation._clearPreviousLocation(previousLocation.settings.deleteCookiesURL).done(function(data){if(data.success){previousLocation._animationSlideDropdownLocation();}});});$YPCA('body').on('click','.jsRefreshLocation',function(){$YPCA(document).trigger('LocationService/triggerLocation',{isRefresh:true});});previousLocation.settings.$whereWrapper.on('click','.jsWhereClearInput',function(e){if(!previousLocation.settings.$where.is(':visible')){previousLocation._addRemoveHidden(previousLocation.settings.$newWhere,previousLocation.settings.$where);previousLocation.settings.$curlocIcon.addClass('hidden');}YP.Autocomplete.clearSearchInputField($YPCA(this),previousLocation.settings.$where,function(){previousLocation._onClickWhere(e);});});$YPCA(document).on('LocationService/locationTranslated',function(event,locationTranslated){$YPCA('.jsSuggestedLocationItemCurrent').removeClass('disabled');previousLocation.settings.hasAcceptedLocation=!locationTranslated.useGeoIp;dataHTMLTemplate.currentLocation=locationTranslated.label;dataHTMLTemplate.currentLocationLabel=locationTranslated.useGeoIp?previousLocation.settings.messages.locationLabel:previousLocation.settings.messages.locationNearYouLabel;});}},_navigateDropdownKey:function(index){previousLocation.settings.displayBoxIndex+=index;var oBoxCollection=$YPCA(".jsSuggestedLocationItem");if(previousLocation.settings.displayBoxIndex>=oBoxCollection.length){previousLocation.settings.displayBoxIndex=0;}if(previousLocation.settings.displayBoxIndex < 0){previousLocation.settings.displayBoxIndex=oBoxCollection.length-1;}oBoxCollection.removeClass(previousLocation.settings.cssClassItemHover).eq(previousLocation.settings.displayBoxIndex).addClass(previousLocation.settings.cssClassItemHover);previousLocation._scrollDropdown();},_onClickCurrentLocation:function(targetElem){var elem=targetElem,isCurrentLocationSelected=(elem.data('currentlocation-selected')===1 & ().text()!==elem.data('label')),isPreviousLocationSelected=(YP.Utils.isDefined(elem) & ('currentlocation-selected')!==1);previousLocation.settings.isCurrentLocation=isCurrentLocationSelected;$YPCA('.jsCurrentLocationItem').text(YP.LocationService.getMaskedTranslatedLatLong());if(!elem.hasClass('disabled')){previousLocation.publicFunctions.triggerLocationPermission(elem);if(isPreviousLocationSelected||isCurrentLocationSelected){if($YPCA('#where.typeahead').is(':visible')){$YPCA('.typeahead').typeahead('close');}previousLocation._submitTextIntoField(elem,previousLocation.settings.isCurrentLocation);}}},_selectAllText:function(obj){obj.selectionStart=0;obj.selectionEnd=obj.value.length;},_scrollDropdown:function(){if($YPCA('.jsSuggestedLocationItem.'+previousLocation.settings.cssClassItemHover).length>0){var scrollToPosition=$YPCA('.jsSuggestedLocationItem.'+previousLocation.settings.cssClassItemHover).position().top;$YPCA(".suggested-location__wrapper--inner").scrollTop(0);$YPCA(".suggested-location__wrapper--inner").scrollTop(scrollToPosition);}},publicFunctions:{attributeCookieValues:function(cookie){if(cookie){var cookieLocation=JSON.parse(cookie).rws;dataHTMLTemplate.previouslySearched=cookieLocation.length>0?cookieLocation.reverse():null;}},setWhereDropdownCurrentLocation:function(){dataHTMLTemplate.currentLocation=previousLocation.publicFunctions.setLocationValueDropdown();dataHTMLTemplate.currentLocationLabel=previousLocation.publicFunctions.setLocationLabelDropdown();dataHTMLTemplate.geoIpLocation=previousLocation.settings.$where.data("geoip-location");dataHTMLTemplate.isLocationFound=YP.LocationService.userAcceptedLocation();if(dataHTMLTemplate.previouslySearched!==null & (dataHTMLTemplate.previouslySearched)){if(YPCA.Utils.isLocalStorageNameSupported() & (YPCA.Utils.storageAPI.get('session','locationTranslated'))!==-1){var indexArray=dataHTMLTemplate.previouslySearched.indexOf(YPCA.Utils.storageAPI.get('session','locationTranslated'));dataHTMLTemplate.previouslySearched.splice(indexArray,1);}}return dataHTMLTemplate;},setLocationValueDropdown:function(){var label=previousLocation.settings.messages.locationLabel;if(YP.LocationService.userAcceptedLocation()){label=YP.LocationService.getMaskedTranslatedLatLong();}else if(YP.LocationService.userDeniedLocation()){label=YP.LocationService.getExistingTranslatedLatLong();}return label;},setLocationLabelDropdown:function(){var label=previousLocation.settings.messages.locationLabel;if(YP.LocationService.userAcceptedLocation()){label=previousLocation.settings.messages.locationNearYouLabel;}return label;},triggerLocationPermission:function(elem){var isSelectedCurrentLocation=YP.Utils.isDefined(elem) & ('currentlocation-selected')===1,hasAcceptOrDenyLocation=YP.LocationService.userAcceptedLocation()||YP.LocationService.userDeniedLocation(),locationTranslated=YPCA.Utils.isLocalStorageNameSupported()?YPCA.Utils.storageAPI.get('session','locationTranslated'):'';if(isSelectedCurrentLocation){if(hasAcceptOrDenyLocation){dataHTMLTemplate.currentLocation=YP.LocationService.getMaskedTranslatedLatLong();$YPCA(document).trigger('LocationService/locationTranslated',{label:locationTranslated,useGeoIp:false});}else{$YPCA(document).trigger('LocationService/triggerLocation');}}}}};$YPCA(function(){previousLocation._init();});$YPCA(document).click(function(e){var isWhereBlur=$YPCA(e.target).parents(".jsSuggestedLocation").length===0;if(!previousLocation.settings.isWhereFocus & ){previousLocation._hidePreviousLocation();}});return previousLocation.publicFunctions;})($YPCA,window,document);"use strict";YP.PreviousSearch=(function($YPCA,window,document){var dataHTMLTemplate={};var previousSearch={settings:{cssClassItemHover:"search-dropdown__list__item--hover",currentSearchTabActive:null,displayBoxIndex:-1,isWhatFocus:false,mobileScreenSearch:800,$what:$YPCA('#whatwho'),$where:$YPCA('#where'),$whatWrapper:$YPCA(".jsSearchWhatInner")},_init:function(){previousSearch._addWhatListener();},_animationSlideDropdownLocation:function(){$YPCA(".jsPreviousSearchList").slideUp(250,function(){$YPCA('.jsPreviousSearchMsgSuccess').slideDown().addClass("active");});},_attributeCookieValues:function(cookie){if(YP.Utils.isDefined(dataHTMLTemplate.previouslySearched)){dataHTMLTemplate.tempPreviouslySearched=dataHTMLTemplate.previouslySearched;}if(cookie){var cookieWhat=previousSearch._manageMapCookies(JSON.parse(cookie));dataHTMLTemplate.previouslySearched=cookieWhat.length>0?cookieWhat.reverse():null;}},_displayWhatSuggestion:function(){var templateHandlebars=$YPCA(".jsWhatFieldTemplate").html(),theTemplate=Handlebars.compile(templateHandlebars);$YPCA('.jsPreviousSearch').remove();previousSearch.settings.$whatWrapper.append(theTemplate(dataHTMLTemplate));},_manageMapCookies:function(cookies){if(YP.Utils.isDefined(cookies.rwtsm["DINE"]) & ["DINE"].length>0 & & $YPCA('.context-dine').length>0){return cookies.rwtsm["DINE"];}if(YP.Utils.isDefined(cookies.rwtsm["PHONE_NUMBER"]) & ["PHONE_NUMBER"].length>0 & & $YPCA('.jsSearchForm').attr('data-search-type')==='reverse'){return cookies.rwtsm["PHONE_NUMBER"];}if(YP.Utils.isDefined(cookies.rwtsm["YP"]) & ["YP"].length>0 & & $YPCA('.context-dine').length===0 & & $YPCA('.jsSearchForm').attr('data-search-type')!=='reverse'){return cookies.rwtsm["YP"];}return[];},_onClickWhat:function(event){if(previousSearch.settings.$what.prop('value')===''){var cookie=$YPCA.cookie('yp.prefs'),showToggle=YP.Utils.isEnterKeyPressed(event) & & $YPCA(".jsSearchWhat label.error").css('display')==="block"?false:true;previousSearch._attributeCookieValues(cookie);if(previousSearch.settings.currentSearchTabActive===null){previousSearch.settings.currentSearchTabActive=$YPCA('.jsSearchForm').attr('data-search-type');}if($YPCA(".jsPreviousSearch").length===0||($YPCA(".jsPreviousSearch").length>0 & !==$YPCA('.jsSearchForm').attr('data-search-type'))){previousSearch._displayWhatSuggestion();}else{$YPCA(".jsPreviousSearch").toggle(showToggle);}previousSearch.settings.currentSearchTabActive=$YPCA('.jsSearchForm').attr('data-search-type');if(YP.Common.isActiveSearchPersonOrReverse()){previousSearch._hidePreviousSearch();}if(JSON.parse(cookie)!=null & (cookie).rwtsm.YP & & !JSON.parse(cookie).rwtsm.YP.length){$YPCA('.jsPreviousSearch').hide();}}},_onKeyUp:function(e){var inputValue=$YPCA(e.target).val();if(YP.Utils.isKeyPressed(e,40)){previousSearch._navigateDropdownKey(1);}else if(YP.Utils.isKeyPressed(e,38)){previousSearch._navigateDropdownKey(-1);}else if(YP.Utils.isEnterKeyPressed(e) & _isPreviousSearchVisible()){var activeElement=$YPCA('.jsPreviousSearchItem.'+previousSearch.settings.cssClassItemHover);previousSearch._submitTextIntoField(activeElement);}else if(inputValue===''){previousSearch._onClickWhat(e);}else{previousSearch._hidePreviousSearch();}},_clickPreviousSearchItem:function(){var valueWhat=previousSearch.settings.$what.val(),valueWhere=previousSearch.settings.$where.val();previousSearch._hidePreviousSearch();if(valueWhere===''){previousSearch.settings.$where.focus();previousSearch.settings.$what.val(valueWhat);}else if($YPCA('.jsWhere').is(':visible')){$YPCA(document).trigger('LocationService/locationTranslated',{label:YPCA.Utils.storageAPI.get('session','locationTranslated'),useGeoIp:false});YP.Autocomplete.triggerSearch();}else{YP.Autocomplete.triggerSearch();}},_hidePreviousSearch:function(){$YPCA(".jsPreviousSearch").hide();},_submitTextIntoField:function(elem){var valueClicked=elem.text();previousSearch.settings.$what.val(valueClicked);previousSearch._clickPreviousSearchItem();YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhatClearInput'),previousSearch.settings.$what);},_isPreviousSearchVisible:function(){return $YPCA(".jsPreviousSearchItem").is(":visible") & & $YPCA(".jsPreviousSearchItem").hasClass(previousSearch.settings.cssClassItemHover);},_addWhatListener:function(){previousSearch.settings.$what.on('keyup',function(e){if(!YP.Utils.isTabKeyPressed(e)){previousSearch._onKeyUp(e);}});previousSearch.settings.$what.on('keydown',function(e){if(YP.Utils.isTabKeyPressed(e)){if(previousSearch._isPreviousSearchVisible()){var activeElement=$YPCA('.jsPreviousSearchItem.'+previousSearch.settings.cssClassItemHover);previousSearch._submitTextIntoField(activeElement);}else{previousSearch._hidePreviousSearch();}return false;}});previousSearch.settings.$what.on('click focus',function(e){if(!YP.Utils.isDevicePhone() & & (!YP.Utils.isDeviceTablet() & & $YPCA(window).width()>previousSearch.settings.mobileScreenSearch)){e.stopPropagation();}previousSearch.settings.isWhatFocus=true;previousSearch._onClickWhat(e);YP.Autocomplete.toggleClearSearchIcon($YPCA('.jsWhatClearInput'),previousSearch.settings.$what);});previousSearch.settings.$what.on('blur',function(){previousSearch.settings.isWhatFocus=false;});previousSearch.settings.$whatWrapper.on('click','.jsPreviousSearchItem',function(){previousSearch._onClickSearchItem($YPCA(this));});previousSearch.settings.$where.on('click focus',function(){if(!previousSearch.settings.isWhatFocus){previousSearch._hidePreviousSearch();}});previousSearch.settings.$whatWrapper.on('click','.jsWhatClearInput',function(e){YP.Autocomplete.clearSearchInputField($YPCA(this),previousSearch.settings.$what,function(){previousSearch._onClickWhat(e);});});previousSearch.settings.$whatWrapper.on('click','.jsClearSearchedWhat',function(){var cookieWhat=$YPCA.parseJSON($YPCA.cookie('yp.prefs'));cookieWhat.rwtsm.YP=[];if(YP.Utils.isFrenchSite()){$YPCA.cookie('yp.prefs',JSON.stringify(cookieWhat),{path:'/',domain:'.pagesjaunes.ca'},{expire:365});}else{$YPCA.cookie('yp.prefs',JSON.stringify(cookieWhat),{path:'/',domain:'.yellowpages.ca'},{expire:365});}previousSearch._hidePreviousSearch();dataHTMLTemplate.tempPreviouslySearched=[];dataHTMLTemplate.previouslySearched=[];$YPCA('.previous-searches__wrapper__inside').html('');$YPCA('.previousSearchesDropdown').hide();});},_navigateDropdownKey:function(index){previousSearch.settings.displayBoxIndex+=index;var oBoxCollection=$YPCA(".jsPreviousSearchItem");if(previousSearch.settings.displayBoxIndex>=oBoxCollection.length){previousSearch.settings.displayBoxIndex=0;}if(previousSearch.settings.displayBoxIndex < 0){previousSearch.settings.displayBoxIndex=oBoxCollection.length-1;}oBoxCollection.removeClass(previousSearch.settings.cssClassItemHover).eq(previousSearch.settings.displayBoxIndex).addClass(previousSearch.settings.cssClassItemHover);previousSearch._scrollDropdown();},_onClickSearchItem:function(targetElem){previousSearch._submitTextIntoField(targetElem);},_selectAllText:function(obj){obj.selectionStart=0;obj.selectionEnd=obj.value.length;},_scrollDropdown:function(){if($YPCA('.jsPreviousSearchItem.'+previousSearch.settings.cssClassItemHover).length>0){var scrollToPosition=$YPCA('.jsPreviousSearchItem.'+previousSearch.settings.cssClassItemHover).position().top;$YPCA(".jsPreviousSearchInner").scrollTop(0);$YPCA(".jsPreviousSearchInner").scrollTop(scrollToPosition);}}};$YPCA(function(){previousSearch._init();});$YPCA(document).click(function(e){var isWhatBlur=$YPCA(e.target).parents(".jsPreviousSearch").length===0;if(!previousSearch.settings.isWhatFocus & ){previousSearch._hidePreviousSearch();}});})($YPCA,window,document);"use strict";var $YPCA=jQuery.noConflict(),YP=window.YP||{};YP.YidService=(function($YPCA){var yid={settings:{loginData:null,validation:{password:{required:true,minlength:6,maxlength:50}}},_init:function(){yid._setConfig();},_setConfig:function(){if($YPCA('.jsAuthentificationConfig').length>0){yid.settings=$YPCA.extend(yid.settings,YP.Utils.getJson($YPCA('.jsAuthentificationConfig')));}},publicFunctions:{attachHandlerForFacebookConnectButton:function($jqSelector){var $buttons=$YPCA($jqSelector+" .connect[data-href]");$buttons.each(function(i,elem){$YPCA(elem).popupWindow({centerBrowser:1,windowURL:$YPCA(this).data('href'),width:$YPCA(this).data('width'),height:$YPCA(this).data('height'),title:$YPCA(this).data('title')});});},createPasswordlessUser:function(email,origin){var defer=$YPCA.Deferred(),defaultOrigin=YP.Utils.isDefined(origin)?origin:'';YP.YidService.signupAccountPasswordLess({email:email}).then(function(data){if(data.success){return YP.ProxyService.sendCrossDomainMessagePromise($YPCA.extend(data.userLoginInfo,{action:'autologin'}));}else{defer.fail('error');}},function(){defer.fail('error signup passwordless');}).then(function(){return yid.publicFunctions.updateLoginHeader('login',defaultOrigin);},function(){defer.fail('error proxy service');}).done(function(){defer.resolve('success');}).fail(function(){defer.fail('error updateLoginHeader');});return defer;},generateUsernamePassword:function(data){return $YPCA.ajax({type:"get",url:yid.settings.url.generateUsernameAjax,data:data});},checkForQuotes:function(element){if(/['||"]/.test(element.value)){element.value=element.value.replace(/['"]+/g,'');}return element.value;},getEmailValidationCode:function(value){var code=0;$YPCA.ajax({type:"get",url:yid.settings.url.emailCheckUrl,data:"value="+value,async:false,success:function(data){code=data.code;},error:function(){code=0;}});return code;},getValidationRules:function(){return yid.settings.validation;},goHome:function(){window.location='/';},hideSignupMessageAlert:function(){var $selector=$YPCA('.jsSignupMessageNotice');$selector.children('.jsYIDGenericAlert').addClass('hidden');$selector.addClass('hidden');},showSignInUpMessageAlert:function(type,message,template){var $selector=template==='signup'?$YPCA('.jsSignupMessageNotice'):$YPCA('.jsSigninMessageNotice');$selector.children('.jsYIDGenericAlert').filter('[data-type="'+type+'"]').removeClass('hidden').html(message);$selector.removeClass('hidden');},signupAccountPasswordLess:function(data){return $YPCA.ajax({type:"POST",url:yid.settings.url.signupAccountPasswordLess,data:data});},updateLoginHeader:function(action,origin){$YPCA.ajax({url:'/yid/v1.0/reloadLoginHeader',type:'GET',cache:false,success:function(data){var dataHTML='',$headerDrawer=$YPCA('.jsUserMenuUpdate'),$dataElm=$YPCA(data);$headerDrawer.html('');$dataElm.each(function(){if(YP.Utils.isDefined(this.className) & ('jsConnectContainer')!==-1){dataHTML=$YPCA(this).find('.jsConnectInfos');}else if(this.nodeType===1){$headerDrawer.append(this);}});$YPCA(document).trigger('Yid/SignIn/PostUpdateLoginHeader',{dataHTML:dataHTML,action:action,origin:origin});},error:function(){YP.Common.traceLog('error update user header');}});},validateEmailFieldOnYID:function(value){return $YPCA.ajax({type:"get",url:yid.settings.url.emailCheckUrl,data:"value="+value,async:false});}}};$YPCA(function(){yid._init();});return yid.publicFunctions;})($YPCA);'use strict';YP.Yid=(function($YPCA,window,document,mod){mod=mod||{};var config={signupInfo:{},signinInfo:{}},yidTimeout=10000,CONST={LOGOUT:{value:'logging out',data:'logout'},LOGIN_SOCIAL:{value:'Social login',data:'loginSocial'},LOGIN_PROCESS_COMPLETED:{value:'Login process completed',data:'LoginProcessCompletedEvent'},STATUS_CODE:{1:"Valid",2:"Already taken",3:"Invalid format",4:"Blacklisted"},LANDING_PAGES:{signin:'/connect/signin',signup:'/connect/signup',pwForgot:'/connect/forgotPassword',pwReset:'/connect/resetPassword'}},MainUserId=function(){_self=this;this.handleModalOrLanding=function(IsIE8){if(config.modalURL!==null & !=='/'){config.isModal=false;if(config.modalURL===CONST.LANDING_PAGES.pwForgot||config.modalURL===CONST.LANDING_PAGES.pwReset){$YPCA(_DOMReferences.cancelBtn.selector).one('click',function(){window.location=CONST.LANDING_PAGES.signin;_self.destroy();return;});}this.render({url:config.modalURL,modal:$YPCA(this.selector)});this.addRedirectToLandingPage(config.modalURL);}else{config.isModal=true;$YPCA(_DOMReferences.modalLogin.selector).on('loaded',function(evt){_self.render(evt);});}this.setRightModal(IsIE8);};this.render=function(data){try{JSON.parse($YPCA('#form-validation-resource').html());}catch(e){return{};}$YPCA.extend(config,JSON.parse($YPCA('#form-validation-resource').html()));if(YP.Utils.isUndefined(_setRequestType(data.url))){throw new TypeError('URL not found : '+data.url);}this.validation.render(data);YPCA.Analytics.triggerPageView('modal-analytics-resource');_addListeners();return this;};this.destroy=function(){this.validation.destroy();_removeListener();};this.addRedirectToLandingPage=function(url){var forgotPwLink=$YPCA(_DOMReferences.forgotPwLink.selector),signinupLink=$YPCA(_DOMReferences.signinupLink.selector);if(!_cachedLoginStatus.authenticated){_addRedirectLinkSignInUp();}if(forgotPwLink.length>0){forgotPwLink.attr({'href':CONST.LANDING_PAGES.pwForgot,'data-toggle':''});}if(signinupLink.length>0){var redirectURL=(url===CONST.LANDING_PAGES.signin)?CONST.LANDING_PAGES.signup:CONST.LANDING_PAGES.signin;signinupLink.attr({'href':redirectURL,'data-toggle':''});}};this.setRightModal=function(isIE8){var hash=(YP.Utils.urlParamHash('#')!==0)?(YP.Utils.urlParamHash('#')):YP.Utils.urlParamHash('feedback');var newsletterId=YP.Utils.isDefined(YP.Utils.urlParamHash('newsletterId'))?YP.Utils.urlParamHash('newsletterId'):'';_IsIE8=isIE8;if(_IsIE8){_handleIE8Redirect(hash);return;}if(hash!==0 & !=='' & !=='unsubscribedFromNewsletter'){$YPCA.each(_loginTypes,function(k,v){if(v.hashParam.indexOf(hash)!==-1){if(!v.callBackOnSuccess){YP.Modal.show(_DOMReferences.modalLogin.selector,v.url);}else{YP.Modal.show(_DOMReferences.modalLogin.selector,v.url,v.callBackOnSuccess());}return false;}});}else if(hash==='unsubscribedFromNewsletter'){YP.Modal.show(_DOMReferences.modalLogin.selector,_loginTypes.unsubscribe.url+'?newsletterId='+newsletterId);}};this.logout=function(e){e.preventDefault();e.stopPropagation();$YPCA.ajax({url:'/yid/v1.0/session',type:'DELETE',success:_handleLogOutSuccess,error:_handleLogOutError});};this.login=function(successCallback,analyticParam){_login(successCallback,analyticParam);};this.signUp=function(param){_signUp(param);};this.loginForRating=function(successCallback,analyticParam){_login(successCallback,analyticParam);};this.isSignedUpAutologin=function(){return _cachedLoginStatus.isSignUpAutologin;};this.isAuthenticated=function(){return _cachedLoginStatus.authenticated;};this.getRequestType=function(){return _requestType;};this.showUsernameSuggestions=function(suggestions){var i=0,htmlToAppend='',usernameSuggestion=$YPCA(_DOMReferences.usernameSuggestions.selector);for(i;i '+suggestions[i]+' ';if(i ').attr({id:iframeDomRef.name,name:iframeDomRef.name,width:1,height:1,border:0,style:'width: 0; height: 0; border: none;'});$YPCA('#iframeParent').append(iframe);}};this.hideUsernameSuggestions=function(){var usernameSuggestion=$YPCA(_DOMReferences.usernameSuggestions.selector);usernameSuggestion.closest('.jsUserNameSuggestion').hide();usernameSuggestion.off('click','a',_replaceUsername).find('a').remove();};this.enableBtnSubmit=function(){var submitBtn=$YPCA(_DOMReferences.submitBtn.selector);submitBtn.removeAttr('disabled').removeClass('disabled');};this.disabledBtnSubmit=function(){var submitBtn=$YPCA(_DOMReferences.submitBtn.selector);submitBtn.attr('disabled','disabled').addClass('disabled');};this.displayModalErrorMessage=function(){var wrapper=$YPCA(this.selector);wrapper.addClass('yidError').attr('disabled','disabled');};this.hideModalErrorMessage=function(){var wrapper=$YPCA(this.selector);wrapper.removeClass('yidError').removeAttr('disabled');};this.hideValidationErrorMsg=function(elm){var loginOAuthError=$YPCA(_DOMReferences.loginOAuthError.selector),element=$YPCA(elm),modalBody=$YPCA(_DOMReferences.modalBody.selector);loginOAuthError.removeClass("show");element.removeClass('error').next('label').remove();modalBody.removeClass("oAuthError");};this.showModalSuccess=function(){var cancelBtn,modalBody=$YPCA(_DOMReferences.modalBody.selector);modalBody.addClass('success');if(!config.isModal){cancelBtn=$YPCA(_DOMReferences.cancelBtn.selector);cancelBtn.one('click',function(){window.location='/';return;});}};this.showModalError=function(){var cancelBtn,modalBody=$YPCA(_DOMReferences.modalBody.selector);modalBody.addClass('error');if(!config.isModal){cancelBtn=$YPCA(_DOMReferences.cancelBtn.selector);cancelBtn.one('click',function(){window.location=window.location;return;});}};this.showTokeninvalid=function(){var modalBody=$YPCA(_DOMReferences.modalBody.selector);modalBody.addClass('tokenInvalid');};this.hideFooter=function(){var modalFooter=$YPCA(_DOMReferences.modalFooter.selector);modalFooter.hide();};this.addAlReadyEmailTakenEvent=function(){$YPCA('.ypCreate').on('click','.jsSignInEmail',function(){_self.validation.setEmailIsTaken(true);if(!config.isModal){window.location=CONST.LANDING_PAGES.signin;return;}});};this.triggerAnalyticsSignUpNewsletter=function(isSignUpSuccess,obj){if($YPCA('.jsSubscribeNewsletterSignup').is(':checked')){$YPCA.post(obj.form.data('action-newsletter'),'email='+encodeURIComponent(obj.email)+' ='+obj.location+' ='+obj.form.data('action-newsletter-id'));if(isSignUpSuccess & & $YPCA('.jsSignUpFormConfig').length>0){var objConfig=YP.Utils.getJson($YPCA('.jsSignUpFormConfig'));YPCA.Analytics.clicks($YPCA('.jsSubscribeNewsletterSignup'),objConfig.analytics.confirm_newsletter);}}};this.testAPI=function(fName){var privateMembers={setDOMRefences:_setDOMRefences,handleIE8Redirect:_handleIE8Redirect,addListeners:_addListeners,removeListeners:_removeListener,setRequestType:_setRequestType,replaceUsername:_replaceUsername,addCommonModalListeners:_addCommonModalListeners,handleModalHide:_handleModalHide,handleModalShow:_handleModalShow,keepTabInModal:_keepTabInModal,onkeyUp:_onkeyUp,onKeyDown:_onKeyDown,onLoginProcessCompleted:_onLoginProcessCompleted,updateLoginStatus:_updateLoginStatus,updateLoginHeader:_updateLoginHeader,setHeader:_setHeader,headerUpdateComplete:_headerUpdateComplete,handleLogOutSuccess:_handleLogOutSuccess,handleLogOutError:_handleLogOutError,handleLoginError:_handleLoginError,login:_login,addRedirectLinkSignInUp:_addRedirectLinkSignInUp};return privateMembers[fName];};var _IsIE8,_DOMReferences,_requestType,_self,_lastTab,_cachedLoginStatus={authenticated:false,isSignUpAutologin:false,sessionToken:null,newsletter:false},_loginTypes={login:{type:'login',url:'/ajax/user/signin',value:'login',hashParam:'slideLogin slideConnect'},ratingSignIn:{type:'login',url:'/ajax/user/ratingSignin',value:'ratingSignin',hashParam:'slideRating'},confirm:{type:'login',url:'/ajax/user/confirm',value:'confirm',hashParam:'slideCreateDone confirmedEmail'},loginIE8:{type:'login',url:'/connect/signin',value:'loginIE8',hashParam:'IE8'},signUp:{type:'signup',url:'/ajax/user/signup',value:'signup',hashParam:'slideSignup'},signUpIE8:{type:'signup',url:'/connect/signup',value:'signUpIE8',hashParam:'IE8'},requestPw:{type:'pwRequest',url:'/ajax/user/resetPasswordRequest',value:'pwRequest',hashParam:'slideRequestPassword'},requestPwIE8:{type:'pwRequest',url:'/connect/forgotPassword',value:'pwRequest',hashParam:'IE8'},requestPwSend:{type:'pwRequestSent',url:'/ajax/user/resetPasswordRequestSend',value:'pwRequestSend',hashParam:'slideRequestPasswordSend'},resetPw:{type:'pwReset',url:'/ajax/user/resetPassword',value:'pwReset',hashParam:'slideResetPassword'},pwResetAndConfirm:{type:'pwReset',url:'/ajax/user/pwResetAndConfirm',value:'pwReset',hashParam:''},resetPwIE8:{type:'pwReset',url:'/connect/resetPassword',value:'pwRequest',hashParam:'IE8'},unsubscribe:{type:'unsubscribe',url:'/ajax/user/unsubscribed',value:'unsubscribe',hashParam:'unsubscribedFromNewsletter'},loginFromImageUpload:{type:'login',url:'/merchant/imageUploadPreview/[0-9]+$',value:'login',hashParam:'slideLogin slideConnect'}},_setDOMRefences=function(){var selector=this.selector;return{loginOAuthError:{name:'iframeLoginFormError',selector:'#iframeLoginForm label.error, #iframeLoginForm label.oAuthError',evt:null},loginIframe:{name:'iframeLogin',selector:'#iframeLogin',evt:null},signupIframe:{name:'iframeSignup',selector:'#iframeSignup',evt:null},modalBody:{name:"modalBody",selector:selector+' .modal-body',evt:null},logoutBtn:{name:'logoutBtn',selector:'.jsLogoutBtn',evt:['click',this.logout]},configAuth:{name:'configAuth',selector:'.jsAuthentificationConfig',evt:null},modalLogin:{name:'jsModalContainer',selector:'#jsModalContainer',evt:null},usernameSuggestions:{name:'usernameSuggestions',selector:'.jsUserSuggest',evt:null},ypHeaderLogin:{name:'header',selector:'.jsConnectInfos',evt:null},ypHeaderDrawerRight:{name:'headerDrawerRight',selector:'.jsUserMenuUpdate',evt:null},ypPermissionOverlay:{name:'permissionOverlay',selector:'#permissionOverlay',evt:null},modalHeader:{name:'modalHeader',selector:selector+' .modal-header p',evt:null},modalFooter:{name:'modalFooter',selector:selector+' .modal-footer',evt:null},inputUsername:{name:'inputUsername',selector:'input[name="username"]',evt:null},submitBtn:{name:'submitBtn',selector:selector+' .jsSignInBtn',evt:null},emailTaken:{name:'jsEmailTaken',selector:'.jsEmailTaken',evt:null},pwSignIn:{name:'pwSignIn',selector:'.jsPasswordSignIn',evt:null},cancelBtn:{name:'cancelButton',selector:selector+' div.ypBtnFlat,'+selector+' .ypButton.cancel',evt:null},signinBtn:{name:'signinButton',selector:'.ypg-connect__signin',evt:null},forgotPwLink:{name:'forgetPwLink',selector:'.jsResetPassword',evt:null},signinupLink:{name:'signupPwLink',selector:'.jsSignUpLink',evt:null}};},_handleIE8Redirect=function(hashParam){if(hashParam==='slideLogin'||hashParam==='slideRating'||hashParam==='confirmedEmail'||hashParam==='slideCreateDone'){window.location=_loginTypes.loginIE8.url;}else{switch(hashParam){case'slideResetPassword':var token=YP.Utils.urlParamHash('token'),uid=YP.Utils.urlParamHash('userId');window.location=_loginTypes.resetPwIE8.url+'?userId='+uid+' ='+token;break;case'slideRequestPassword':window.location=_loginTypes.requestPwIE8.url;break;case'unsubscribedFromNewsletter':YP.Modal.show(_DOMReferences.modalLogin.selector,_loginTypes.unsubscribe.url);break;}}},_addListeners=function(){$YPCA.each(_DOMReferences,function(k,v){var $el=$YPCA(v.selector),evt=v.evt;if($el.length!==0 & !==null){$el.on(evt[0],evt[1]);}});if(_requestType.type==='login'||_requestType.type==='signup'){$YPCA.subscribe(YP.Events.OAuthProcessCompleted,_onLoginProcessCompleted);YP.YidService.attachHandlerForFacebookConnectButton(this.selector);}if(config.isModal){_addCommonModalListeners(this.selector);}_keepTabInModal(this.selector);},_removeListener=function(){var $YPCAModal=$YPCA(_self.selector);$YPCA.each(_DOMReferences,function(k,v){var $el=$YPCA(v.selector),evt=v.evt;if($el.length!==0 & !==null){$el.off(evt[0],evt[1]);}});$YPCA.unsubscribe(YP.Events.OAuthProcessCompleted,_onLoginProcessCompleted);$YPCA.unsubscribe(YP.Events.LoginHeaderUpdated,_headerUpdateComplete);$YPCA(document).off('WriteReview/Login');$YPCAModal.off('shown.bs.modal',_handleModalShow);$YPCAModal.off('hide.bs.modal',_handleModalHide);$YPCAModal.off('keyup',_onkeyUp);$YPCAModal.off('keydown',_onKeyDown);},_setRequestType=function(url){var isMatched=false;$YPCA.each(_loginTypes,function(k,v){if(isMatched){return;}if(_getPathFromUrl(url)===v.url||new RegExp(v.url).test(_getPathFromUrl(url))){isMatched=true;_requestType=v;}});return _requestType;},_getPathFromUrl=function(url){return url.split("?")[0];},_replaceUsername=function(){var inputUsername=$YPCA(_DOMReferences.inputUsername.selector);inputUsername.val($YPCA(this).text()).removeClass('error');$YPCA('.jsUserNameSuggestion').hide();_self.validation.signupValidator.element('input[name="username"]');},_addCommonModalListeners=function(modal){var $YPCAModal=$YPCA(modal);$YPCAModal.on('shown.bs.modal',_handleModalShow);$YPCAModal.on('hide.bs.modal',_handleModalHide);},_handleModalHide=function(){if(!_cachedLoginStatus.authenticated){_self.destroy();}},_handleModalShow=function(){var pwSignIn,emailTaken;YP.Analytics.showOverlay('signin_signup');$YPCA('.slider').removeAttr('style');if(_self.validation.isEmailTaken()){emailTaken=$YPCA(_DOMReferences.emailTaken.selector);emailTaken.val(_self.validation.getEmail());pwSignIn=$YPCA(_DOMReferences.pwSignIn.selector);pwSignIn.focus();}YP.Modal.hideBackdrop();_analyticSignInCheckBox();},_analyticSignInCheckBox=function(){var $checkBox=$YPCA('.jsSignInCheckBox');if($checkBox.length!==0){$checkBox.click(function(){if($checkBox.prop('checked')){YPCA.Analytics.clicks($checkBox,JSON.parse($checkBox.attr('data-analytic-checked')));}else{YPCA.Analytics.clicks($checkBox,JSON.parse($checkBox.attr('data-analytic-unchecked')));}});}},_keepTabInModal=function(modal){var $YPCAModal=$YPCA(modal);$YPCAModal.on('keyup',_onkeyUp);$YPCAModal.on('keydown',_onKeyDown);},_onkeyUp=function(e){if(YP.Utils.isTabKeyPressed(e)){var $elements=$YPCA(e.currentTarget).find(":visible");if($elements.length-1===$elements.index($YPCA(document.activeElement))){_lastTab=true;}}},_onKeyDown=function(e){if(YP.Utils.isTabKeyPressed(e)){if(_lastTab){e.preventDefault();$YPCA(e.currentTarget).find("input:visible:first").focus();_lastTab=false;}}},_onLoginProcessCompleted=function(e,action,oAuthResponse){clearTimeout(config.timer);var $form=$YPCA('#iframeLoginForm'),newAction=action;if(oAuthResponse.error!==null & !==""){_handleLoginError(oAuthResponse.error);if($form.length!==0){YPCA.Analytics.clicks($form,JSON.parse($form.attr('data-analytic-error')));}}else{if(action==='login' & ){newAction='autologin';_cachedLoginStatus.isSignUpAutologin=true;YPCA.Analytics.clicks($form,config.signupInfo.analytics.signup_confirm);}if(config.signinInfo & ==='WriteReview/Login'){$YPCA(document).trigger('WriteReview/PostLogin');}YP.ProxyService.sendCrossDomainMessage({action:newAction,data:oAuthResponse});if(!config.isModal){YP.YidService.goHome();return;}if(action==='login'){_updateLoginHeader(_loginTypes.login.value);}else{_updateLoginHeader(_loginTypes.signUp.value);}if(!YP.Utils.isDevicePhone()){_updateBlueBar();}if(oAuthResponse.provider==='facebook'||oAuthResponse.provider==='googleplus'){var $analytic=$YPCA('.jsSocialAnalytic');YPCA.Analytics.clicks($analytic,JSON.parse($analytic.attr('data-analytic-'+oAuthResponse.provider)));}else if(oAuthResponse.provider==='yellowid' & & $form.length!==0){YPCA.Analytics.clicks($form,JSON.parse($form.attr('data-analytic-confirm')));}mod.userID.triggerAnalyticsSignUpNewsletter(true,mod.userID.signupInfo);if(YPCA.Utils.storageAPI.get('session','reviewInfo')==null){location.reload();}}},_updateLoginStatus=function(action){var configAuth=$YPCA(_DOMReferences.configAuth.selector),defaultCachedLoginStatus={authenticated:false,sessionToken:null,newsletter:false};_cachedLoginStatus=(configAuth.length!==0)?$YPCA.extend(_cachedLoginStatus,JSON.parse(configAuth.html())):defaultCachedLoginStatus;if(!_cachedLoginStatus.authenticated & (config.modalURL)){if(!config.isModal){_addRedirectLinkSignInUp();}else{_self.destroy();}}$YPCA(_DOMReferences.loginOAuthError.selector).remove();$YPCA(this.selector).modal('hide');},_updateLoginHeader=function(action){$YPCA.ajax({url:'/yid/v1.0/reloadLoginHeader',type:'GET',cache:false,success:function(data){var dataHTML='',headerDrawer=$YPCA(_DOMReferences.ypHeaderDrawerRight.selector),dataElm=$YPCA(data);headerDrawer.html('');dataElm.each(function(){if(YP.Utils.isDefined(this.className) & ('jsConnectContainer')!==-1){dataHTML=$YPCA(this).find(_DOMReferences.ypHeaderLogin.selector);}else if(this.nodeType===1){headerDrawer.append(this);}});_setHeader(dataHTML,action);},error:function(){}});},_updateBlueBar=function(){$YPCA.ajax({url:'/ajax/permissionOverlay',type:'GET',cache:false,success:function(data){var permissionOverlayDrawer=$YPCA(_DOMReferences.ypPermissionOverlay.selector),dataElm=$YPCA(data);permissionOverlayDrawer.html('');dataElm.each(function(){permissionOverlayDrawer.append(this);});if(data.length>0){$YPCA('#permissionOverlay').show();$YPCA('body').addClass('permissionOverlay');$YPCA(document).trigger('PermissionOverlay/LoggedIn');}},error:function(){}});},_setHeader=function(data,action){var headerLogin=$YPCA(_DOMReferences.ypHeaderLogin.selector);headerLogin.replaceWith(data);_headerUpdateComplete(action);$YPCA('.jsOtherLanguageUrl').attr('href',config.otherLanguageUrl);if(action===_loginTypes.login.type||action===_loginTypes.signUp.type){$YPCA(document).trigger('User/LogIn');}else if(action==='logout'){$YPCA(document).trigger('User/LogOut');}},_headerUpdateComplete=function(action){var isSignUpAutoLogin=YP.Utils.isDefined(action) & (_requestType) & & (_requestType.type==='signup' & ==='login');$YPCA(_DOMReferences.logoutBtn.selector).on(_DOMReferences.logoutBtn.evt[0],_DOMReferences.logoutBtn.evt[1]);_updateLoginStatus(action);if(action!=='logout' & (YP.User.getUserCookiesInfo())){var email=YP.User.getUserCookiesInfo().e;YP.Common.callToMarketo(email);}if(YP.Utils.isDefined(_requestType) & & (_requestType.type===action||(_requestType.type==='signup' & ==='login'))){$YPCA.publish(CONST.LOGIN_PROCESS_COMPLETED.data);if(window.location.href.split("?requestedURI=")[1]){window.location.href=window.location.href.split("?requestedURI=")[1];}if(isSignUpAutoLogin){YP.Modal.show("#jsModalContainer",_loginTypes.pwResetAndConfirm.url);YP.Modal.hideBackdrop();}}},_handleLogOutSuccess=function(){if($YPCA('.jsGenericRedirectConfig').last().length>0){var redirectConfig=JSON.parse($YPCA('.jsGenericRedirectConfig').last().html()),isRedirect=redirectConfig.redirect,redirectUrl=redirectConfig.url;$YPCA(document).trigger('PermissionOverlay/LoggedOut');YP.ProxyService.sendCrossDomainMessageOldPromise({action:CONST.LOGOUT.data}).done(function(){$YPCA(_DOMReferences.logoutBtn.selector).off(_DOMReferences.logoutBtn.evt[0],_DOMReferences.logoutBtn.evt[1]);if(isRedirect===true){window.location=redirectUrl!==''?redirectUrl:'/';}else{$YPCA('.showRemove').removeClass('showRemove');$YPCA('body').removeClass('side-menu--right--open');if(YP.Utils.isDefined(YP.Reviews)){YP.Reviews.getUserReviewStatus();}}location.reload();}).fail(function(){YP.Common.traceLog('no data oAuth received');});}},_handleLogOutError=function(){},_handleLoginError=function(error){var loginIframe=$YPCA(_DOMReferences.loginIframe.selector),modalBody=$YPCA(_DOMReferences.modalBody.selector),loginOAuthError=$YPCA(_DOMReferences.loginOAuthError.selector);switch(error){case"UnconfirmedEmail":this.validation.loginValidator.showErrors({"identifier":config.stateErrors.errorUserNotActive});loginIframe.remove();break;case"InvalidCredentials":this.validation.loginValidator.showErrors({"identifier":config.stateErrors.errorInvalidCredentials});loginIframe.remove();break;case"Deactivated":this.validation.loginValidator.showErrors({"identifier":config.stateErrors.errorDeactivated});loginIframe.remove();break;default:loginOAuthError.addClass("show");}modalBody.addClass("oAuthError");},_login=function(successCallback,analyticParam){if(_cachedLoginStatus.authenticated){if(YP.Utils.isDefined(successCallback)){successCallback(_cachedLoginStatus);}}else{if(YP.Utils.isDefined(successCallback)){$YPCA.subscribeOnce(CONST.LOGIN_PROCESS_COMPLETED.data,function(){if(_cachedLoginStatus.authenticated){successCallback(_cachedLoginStatus);}});}var param=YP.Utils.isDefined(analyticParam)?'?origin='+analyticParam:'';YP.Modal.show(_DOMReferences.modalLogin.selector,_loginTypes.signUp.url+param);}},_signUp=function(param){if(!_cachedLoginStatus.authenticated){var parameter=YP.Utils.isDefined(param)?param:'';YP.Modal.show(_DOMReferences.modalLogin.selector,_loginTypes.signUp.url+parameter);}},_addRedirectLinkSignInUp=function(){$YPCA(_DOMReferences.signinBtn.selector).attr({'href':CONST.LANDING_PAGES.signin,'data-toggle':''});},_modalOnLoad=function(){$YPCA(document).on('loaded','#ypModal',function(){if(YPCA.Utils.urlParamHash('feedback')==='confirmedEmail' & & $YPCA('.jsConfirmedSignup').length>0){var jsonAnalytics=JSON.parse($YPCA('.jsConfirmedSignup').html());YPCA.Analytics.clicks($YPCA('#ypModal'),jsonAnalytics['signup-confirm']);}if($YPCA('.jsSigninForm').length>0){$YPCA(document).on('Messaging/Login WriteReview/Login',function(event,fields){if(event.type==='WriteReview/Login'){config.signinInfo.event=event.type;}YP.YidService.showSignInUpMessageAlert('warning',fields.alertMessage,'signin');$YPCA('.jsModalsignIn').addClass('signin__active-panel');$YPCA('.jsSigninMessageNotice').removeClass('hidden');$YPCA('.jsEmailTaken').val(fields.userEmail);});}if($YPCA('.jsSignupForm').length>0){config.signupInfo=$YPCA.extend(config.signupInfo,YP.Utils.getJson($YPCA('.jsSignUpFormConfig')));}});},_addCustomEventListeners=function(){$YPCA(document).on('Yid/SignIn/PostUpdateLoginHeader',function(event,params){config.signupInfo.origin=params.origin;_setHeader(params.dataHTML,params.action);});$YPCA(document).on('click','.jsConnectButton',function(){config.signupInfo.origin='connect';});$YPCA(document).on('keydown','.jsEmailTaken, .jsEmailSignup',function(e){if(YP.Utils.isEnterKeyPressed(e)){this.value=YP.YidService.checkForQuotes(this);}});},_init=function(){_self.selector='#ypModal';_updateLoginStatus=_updateLoginStatus.bind(_self);_handleLoginError=_handleLoginError.bind(_self);_addListeners=_addListeners.bind(_self);_onLoginProcessCompleted=_onLoginProcessCompleted.bind(_self);_DOMReferences=_setDOMRefences.apply(_self);if(_self.isAuthenticated){$YPCA(_DOMReferences.logoutBtn.selector).on(_DOMReferences.logoutBtn.evt[0],_DOMReferences.logoutBtn.evt[1]);}_self.validation=new Validation();_updateLoginStatus();_modalOnLoad();_addCustomEventListeners();};_init();},Validation=function(){_self=this;this.render=function(obj){_setValidator(obj);return this;};this.destroy=function(){_unsetValidator();};this.setEmailTaken=function(email){_email.email=email;};this.setEmailIsTaken=function(isTaken){_email.isTaken=isTaken;};this.resetEmailTaken=function(){this.setEmailTaken('');this.setEmailIsTaken(false);};this.isEmailTaken=function(){return _email.isTaken;};this.getEmail=function(){return _email.email;};this.testAPI=function(fName){var privateMembers={setRules:_setRules,setValidator:_setValidator,setValidatorForm:_setValidatorForm,loginValidatorHandlers:_loginValidatorHandlers,signupValidatorHandlers:_signupValidatorHandlers,requestPwHandlers:_requestPwHandlers,resetPwHandlers:_resetPwHandlers,addValidatorMethods:_addValidatorMethods,validateElm:_validateElm,handleValidateStatus:_handleValidateStatus,showErrorMsg:_showErrorMsg,unsetValidator:_unsetValidator};return privateMembers[fName];};var _rules,_self,_keyup,_reqtype,_config={rules:{password:{required:true,minlength:6,maxlength:50}}},_email={isTaken:false,email:''},_setRules=function(){_rules={login:{identifier:{required:true,email:true},password:_config.rules.password},signup:{email:{required:true,email:true,emailValidation:true},username:{required:true,usernameFormatValidation:true,usernameValidation:true},password:_config.rules.password},pwReset:{password:_config.rules.password,passwordConfirmation:$YPCA.extend({},_config.rules.password,{equalTo:"#passwordReset"})},pwRequest:{email:{required:true,email:true}}};return _rules;},_setValidator=function(obj){var callbacks;_reqtype=mod.userID.getRequestType().type;switch(_reqtype){case"login":callbacks=_loginValidatorHandlers();break;case"signup":callbacks=_signupValidatorHandlers();mod.userID.addAlReadyEmailTakenEvent();break;case"pwRequest":callbacks=_requestPwHandlers();break;case"pwReset":callbacks=_resetPwHandlers();break;default:window.console.log("userValidation._attachEventListeners: No Op: ",obj.url);}if(YP.Utils.isDefined(callbacks)){_setValidatorForm(obj.modal,_reqtype,callbacks);}},_unsetValidator=function(){if(YP.Utils.isDefined(_self[_reqtype+'Validator']) & & $YPCA(_self[_reqtype+'Validator'].currentForm).length>0){$YPCA(_self[_reqtype+'Validator'].currentForm).unbind();}},_setValidatorForm=function($modal,type,callbacks){_self[type+'Validator']=$modal.find("form").validate({rules:_rules[type],messages:config['form'+type+'Error'],onkeyup:callbacks.onKeyup,invalidHandler:callbacks.invalidHandler,onfocusout:callbacks.onfocusout,submitHandler:callbacks.submitHandler,errorPlacement:callbacks.errorPlacement});return _self[type+'Validator'];},_loginValidatorHandlers=function(){function isIosX(){var iOS=/iPad|iPhone|iPod/.test(navigator.userAgent) & & !window.MSStream;var ratio=Math.round(window.devicePixelRatio*10)/10||1;var screen={width:window.screen.width*ratio,height:window.screen.height*ratio};return iOS & ==1125 & ===2436;}return{onKeyup:function(elm){if(!_keyup){_keyup=true;mod.userID.hideValidationErrorMsg(elm);mod.userID.enableBtnSubmit();}if(elm.name==='identifier'){elm.value=elm.value.replace(/\s+/g,'');}if(isIosX()){elm.style.backgroundColor="#FF0";}mod.userID.hideModalErrorMessage();},invalidHandler:function(){mod.userID.hideValidationErrorMsg();var $form=$YPCA(this);YPCA.Analytics.clicks($form,JSON.parse($form.attr('data-analytic-error')));},onfocusout:function(elm){mod.userID.hideValidationErrorMsg(elm);elm.value=YP.YidService.checkForQuotes(elm);if(isIosX()){elm.style.backgroundColor="#F8F8F8";}else{_self.loginValidator.element(elm);}_keyup=false;if(elm.name==='identifier'){elm.value=elm.value.replace(/\s+/g,'');}},submitHandler:function(form){mod.userID.disabledBtnSubmit();mod.userID.addSubmitIframe('login');form.submit();config.timer=setTimeout(mod.userID.displayModalErrorMessage,yidTimeout);},errorPlacement:function(error,element){error.insertAfter(element);}};},_signupValidatorHandlers=function(){return{onKeyup:function(elm){if(!_keyup){_keyup=true;mod.userID.hideValidationErrorMsg(elm);}},invalidHandler:function(){var $form=$YPCA(this);YPCA.Analytics.clicks($form,JSON.parse($form.attr('data-analytic-error')));},onfocusout:function(element){if($YPCA(element).hasClass('jsEmailSignup') & & $YPCA(element).val()!==''){element.value=YP.YidService.checkForQuotes(element);_self.signupValidator.element(element);_keyup=false;}},submitHandler:function(form){mod.userID.disabledBtnSubmit();YP.YidService.hideSignupMessageAlert();var enable=$YPCA(form).find('[name=enable]').val(),oFields={email:$YPCA('.jsEmailSignup').val(),form:$YPCA(form),location:YP.LocationService.getGeoIPLocation()},location=YP.LocationService.getGeoIPLocation(),serializedForm=$YPCA(form).serializeArray();YP.YidService.generateUsernamePassword('email='+$YPCA('.jsEmailSignup').val()).done(function(data){if(data.suggestedUsername!==''){$YPCA('.jsSignUpUsername').val(data.suggestedUsername);$YPCA('.jsSignUpPassword').val(data.suggestedPassword);if(enable!=="" & ==="true"){mod.userID.hideFooter();mod.userID.addSubmitIframe('signup');serializedForm.push({name:'location',value:location});form.submit();mod.userID.signupInfo=oFields;}}else{YP.YidService.showSignInUpMessageAlert('error',config.formsignupError.yid.error,'signup');}}).fail(function(){YP.Common.traceLog('error generating username');});}};},_requestPwHandlers=function(){return{onkeyup:function(){if(!_keyup){_keyup=true;_self.pwRequestValidator.resetForm();}},onfocusout:function(element){if(YP.Utils.isUndefined(_self.pwRequestValidator)){return;}_keyup=false;_self.pwRequestValidator.element(element);},invalidHandler:function(){if(YP.Utils.isUndefined(_self.pwRequestValidator)){return;}_self.pwRequestValidator.showErrors();},submitHandler:function(form){var emailVal=$YPCA(form).find('.jsEmailRequest').val();_self.pwRequestValidator.resetForm();mod.userID.disabledBtnSubmit();$YPCA.ajax({type:"post",url:"/yid/v1.0/passwordreset",data:"identifier="+emailVal,success:function(data){if(data.code===1){var messageSuccess=$YPCA('.jsRequestResetPasswordSuccessMsg').text();YP.Modal.show("#jsModalContainer",'/ajax/user/signin',function(){YP.YidService.showSignInUpMessageAlert('success',messageSuccess,'signin');$YPCA('.jsEmailTaken').val(emailVal);});}else{mod.userID.enableBtnSubmit();_self.pwRequestValidator.showErrors({"email":config.formpwRequestError.email.requestEmailValidation[data.code]});}},error:function(){mod.userID.showModalError();}});}};},_resetPwHandlers=function(){return{onkeyup:function(elm){if(!_keyup){_keyup=true;mod.userID.hideValidationErrorMsg(elm);}},onfocusout:function(element){_self.pwResetValidator.element(element);_keyup=false;},invalidHandler:function(){if($YPCA('.jsPwResetAndConfirmStep').length>0){YPCA.Analytics.clicks($YPCA('.jsPwResetConfirmSubmitBtn'),$YPCA('.jsPwResetConfirmSubmitBtn').data('analytics-error'));}},submitHandler:function(form){var _url,_data,withToken,enable=$YPCA(form).find('[name=enable]').val(),isPwConfirmationModal=$YPCA('.jsPwResetAndConfirmStep').length>0;mod.userID.disabledBtnSubmit();if(enable!=="" & ==="true"){_url=$YPCA(form).find('[name=hostname]').val()+"/v1/Authentication/UpdatePasswordWithToken";_data={passwordResetToken:decodeURIComponent(YP.Utils.urlParamHash('token')),newPassword:$YPCA('#passwordReset').val()};withToken=true;}else{_url=$YPCA(form).find('[name=hostname]').val()+"/yid/v1.0/user/passwords";_data={userId:YP.Utils.urlParamHash('userId')?decodeURIComponent(YP.Utils.urlParamHash('userId')):"",password:$YPCA(form).find('#passwordReset').val()};withToken=false;}if(isPwConfirmationModal){YPCA.Analytics.clicks($YPCA('.jsPwResetConfirmSubmitBtn'),$YPCA('.jsPwResetConfirmSubmitBtn').data('analytics-intent'));}$YPCA.ajax({type:"post",url:_url,data:_data,success:function(data){if(isPwConfirmationModal){if(data.successful||withToken){$YPCA('.jsPwResetAndConfirmStep').addClass('hidden');$YPCA('.jsPwResetAndConfirmStep').filter('[data-step="2"]').removeClass('hidden');YPCA.Analytics.clicks($YPCA('.jsPwResetConfirmSubmitBtn'),$YPCA('.jsPwResetConfirmSubmitBtn').data('analytics-confirm'));}else{mod.userID.showModalError();YPCA.Analytics.clicks($YPCA('.jsPwResetConfirmSubmitBtn'),$YPCA('.jsPwResetConfirmSubmitBtn').data('analytics-error'));}}else{if(data.successful||withToken){mod.userID.showModalSuccess();}else{mod.userID.showModalError();}}},error:function(data){if($YPCA('.jsPwResetAndConfirmStep').length>0){YPCA.Analytics.clicks($YPCA('.jsPwResetConfirmSubmitBtn'),$YPCA('.jsPwResetConfirmSubmitBtn').data('analytics-error'));}if(data.responseText==="Reset password token is invalid"){mod.userID.showTokeninvalid();}else if(data.responseText==="The new password failed validation"){mod.userID.showPwFailed();}else{mod.userID.showModalError();}}});}};},_addValidatorMethods=function(){$YPCA.validator.addMethod("emailValidation",function(value){return _validateElm(value,'email');});$YPCA.validator.addMethod("usernameValidation",function(value){return _validateElm(value,'username');});},_validateElm=function(value,type){mod.userID.disabledBtnSubmit();var ajaxRequest={type:"get",url:"/yid/v1.0/security/"+type+"s",data:"value="+value,async:false,success:function(data){_handleValidateStatus(data,value,type);}};$YPCA.ajax(ajaxRequest);return true;},_handleValidateStatus=function(data,value,type){var code=data.code;if(type==='email'){this.resetEmailTaken();if(code==='2'){this.setEmailTaken(value);}}else{if(code!=='2'){mod.userID.hideUsernameSuggestions();}else{mod.userID.showUsernameSuggestions(data.suggestions);}}if(code==='1'){mod.userID.enableBtnSubmit();}else{_showErrorMsg(code,type);}},_showErrorMsg=function(code,type){var obj={},erMsg=config['form'+_reqtype+'Error'];switch(code){case'2':obj[type]=erMsg[type][type+'Validation'];this.signupValidator.showErrors(obj);break;case'3':obj[type]=erMsg[type][type+'InvalidFormat'];this.signupValidator.showErrors(obj);break;case'4':obj[type]=erMsg[type][type+'InvalidGuidelines'];this.signupValidator.showErrors(obj);break;default:throw new TypeError('Status code is undefined.');}return false;},_init=function(){_addValidatorMethods=_addValidatorMethods.bind(_self);_handleValidateStatus=_handleValidateStatus.bind(_self);_setValidator=_setValidator.bind(_self);_showErrorMsg=_showErrorMsg.bind(_self);_setRules();_addValidatorMethods();};_init();};mod.userID=mod.userID||new MainUserId();$YPCA(function(){var URISegment=window.location.href.match(new RegExp('(/connect/signin|/connect/signup|/connect/forgotPassword|/connect/resetPassword)','g')),IsIE8;try{IsIE8=JSON.parse($YPCA('#page-configuration-resource').last().html()).isIE8;}catch(e){return false;}config.modalURL=(URISegment!==null)?URISegment[0]:'/';mod.userID.handleModalOrLanding(IsIE8);});return mod.userID;})($YPCA,window,document,YP.Yid);"use strict";YP.YidController=(function($YPCA){var yid={settings:{accountCreation:{}},_init:function(){yid._addEventListeners();yid._checkUrlParam();},_addEventListeners:function(){$YPCA(document).on('loaded','.jsModalPostSignUp',function(e){yid._setConfig($YPCA('.jsAccountConfirmationModalConfig'),yid.settings.accountCreation,function(){yid._addAnalyticsAccountCreation();});});$YPCA('body').on('paste','.jsDisableCopyPaste',function(e){e.preventDefault();});},_addAnalyticsAccountCreation:function(){if(YP.Utils.isDefined(yid.settings.accountCreation.analytics)){YPCA.Analytics.sendCustomPageView(yid.settings.accountCreation.analytics.impression,'WIDGET');}},_checkUrlParam:function(){if(YP.Utils.urlParamHash('feedback')==='confirmedEmailResetPassword'){$YPCA('.jsAlertBoxUserConfirmed').removeClass('hidden');}},_setConfig:function($config,objDestination,callback){if($config.length>0){objDestination=$YPCA.extend(objDestination,YP.Utils.getJson($config));if(callback){callback();}}}};$YPCA(function(){yid._init();});})($YPCA);"use strict";YP.Restricted=(function($YPCA,window){var restrictedHeadings={analytics:{open:{},close:{},yes:{},no:{}},_init:function(){restrictedHeadings._setAnalytics();restrictedHeadings._showPopUp();restrictedHeadings._addEventListeners();},_showPopUp:function(){if($YPCA("#ypRestrictedHeading").length>0 & & $YPCA.cookie("ageRestricted")!=="true"){$YPCA("#ypRestrictedHeading").modal();$YPCA("#ypgBody").css("filter","blur(6px)");}},_addEventListeners:function(){$YPCA(".jsBtnRestrictedCancel").click(function(e){YPCA.Analytics.clicks(e,restrictedHeadings.analytics.no);window.location='/';});$YPCA('.jsBtnRestrictedGoTo').click(function(e){YPCA.Analytics.clicks(e,restrictedHeadings.analytics.yes);restrictedHeadings._setCookie();$YPCA('.jsModalRestricted').modal('hide');$YPCA("#ypgBody").css("filter","");});$YPCA('.jsModalRestricted').on('click','.close',function(e){YPCA.Analytics.clicks(e,restrictedHeadings.analytics.close);window.location='/';});$YPCA("body").click(function(){if($YPCA.cookie("ageRestricted")==="true"){restrictedHeadings._setCookie();}});$YPCA('#ypRestrictedHeading').on('shown.bs.modal',function(e){YPCA.Analytics.clicks(e,restrictedHeadings.analytics.open);});},_setCookie:function(){var date=new Date();var minutes=30;date.setTime(date.getTime()+(minutes*60*1000));$YPCA.cookie("ageRestricted",true,{expires:date,path:'/'});},_setAnalytics:function(){var $config=$YPCA('#analytics-resource-restricted');if($config.length>0){var config=YP.Utils.convertDataToJSON($YPCA('#analytics-resource-restricted'));restrictedHeadings.analytics.open=config.age_restricted_warning;restrictedHeadings.analytics.close=config.age_restricted_close;restrictedHeadings.analytics.yes=config.age_restricted_yes;restrictedHeadings.analytics.no=config.age_restricted_no;}}};$YPCA(function(){restrictedHeadings._init();});})($YPCA,window);"use strict";YP.HandlebarTemplates=(function($YPCA){var templateCache={},publicFunctions={loadTemplate:function(id){if(!templateCache[id]){templateCache[id]=Handlebars.compile($YPCA(id).html());}return templateCache[id];}};return publicFunctions;})($YPCA);Handlebars.registerHelper('ifCond',function(v1,operator,v2,options){switch(operator){case'==':return(v1==v2)?options.fn(this):options.inverse(this);case'===':return(v1===v2)?options.fn(this):options.inverse(this);case'!==':return(v1!==v2)?options.fn(this):options.inverse(this);case' < ':return(v1 < =':return(v1 < =v2)?options.fn(this):options.inverse(this);case'>':return(v1>v2)?options.fn(this):options.inverse(this);case'>=':return(v1>=v2)?options.fn(this):options.inverse(this);case' & & ':return(v1 & )?options.fn(this):options.inverse(this);case'||':return(v1||v2)?options.fn(this):options.inverse(this);default:return options.inverse(this);}});Handlebars.registerHelper('ifArrayContains',function(elem,list,options){if(list.indexOf(elem)>-1){return options.fn(this);}return options.inverse(this);});Handlebars.registerHelper('times',function(n,block){var accum='';for(var i=0;i < 12?'a.m.':'p.m.'));}else{return new Handlebars.SafeString(hour+':'+minutesStr);}});Handlebars.registerHelper('convertTo12hourFormatMerged',function(time){if(YP.Utils.isEnglishSite()){var timeHour=time.split(':'),h=timeHour[0]%12;if(h===0){h=12;}return new Handlebars.SafeString(h+':'+timeHour[1]+' '+(timeHour[0] < 12?'a.m.':'p.m.'));}else{return new Handlebars.SafeString(time);}});Handlebars.registerHelper('json',function(context){return JSON.stringify(context);});Handlebars.registerHelper('each_upto',function(ary,max,options){if(!ary||ary.length==0){return options.inverse(this);}var result=[];for(var i=0;i 0){proxyService.config=$YPCA.extend(proxyService.config,JSON.parse($portholeConfig.html()));if(callback){callback();}}},_injectIframe:function(url,data,callback){var $iframe=$YPCA(' ');$YPCA('body').append($iframe);$YPCA('#ypgOtherSide').on('load',function(){if(callback){callback();}setTimeout(function(){$iframe.remove();},15000);});},_toParam:function(param,message){var key;for(key in message){if(typeof message[key]==='object'){proxyService._toParam(param,message[key]);}else if(proxyService.config.attrs.indexOf(key)>=0){param.push(key+'='+message[key]);}}},publicFunctions:{sendCrossDomainMessage:function(message,callback){var param=[];$YPCA("#ypgOtherSide").remove();proxyService._toParam(param,message);proxyService._injectIframe(proxyService.config.otherSideBaseUrl,param.join(' & '));if(callback){callback();}},sendCrossDomainMessageOldPromise:function(message){var param=[],deferred=new $YPCA.Deferred();$YPCA("#ypgOtherSide").remove();if(message){proxyService._toParam(param,message);proxyService._injectIframe(proxyService.config.otherSideBaseUrl,param.join(' & '),function(){deferred.resolve();});}else{deferred.reject();}return deferred.promise();},sendCrossDomainMessagePromise:function(dataOAuth){var deferred=new $YPCA.Deferred();$YPCA("#ypgOtherSide").remove();if(dataOAuth){proxyService._injectIframe(proxyService.config.otherSideBaseUrlPasswordless,$YPCA.param(dataOAuth));deferred.resolve();}else{deferred.reject();}return deferred.promise();}}};$YPCA(function(){proxyService._init();});return proxyService.publicFunctions;})($YPCA);"use strict";YP.NewsletterWidget=(function($){var newsletterWidget={newsletterForm:{form:$(".jsNewsLetterForm"),formWrapper:$YPCA('.jsNewsLetterFormSlideshow'),fieldEmail:$('.jsNewsletterEmailField'),fieldPostalCode:$('.jsNewsletterPostalCodeField'),errorWrapperClass:'has-error'},_init:function(){newsletterWidget.validateForms();newsletterWidget.addCustomValidationMethods();newsletterWidget.setValidateEmail();newsletterWidget.setValidateLocation();},validateForms:function(){newsletterWidget.formValidationTop=newsletterWidget.newsletterForm.form.validate(newsletterWidget.validatRules1);},addCustomValidationMethods:function(){$.validator.addMethod("emailValidationNewsLetter",function(value){var code=YP.YidService.getEmailValidationCode(value);if(code==='3'||code==='4'){newsletterWidget.formValidationTop.showErrors({"email":YP.Common.getMessage("modal.login.error.invalid.email.guidelines")});newsletterWidget.addError();}else{YPCA.Analytics.clicks($YPCA('.jsScrollEmail'),$YPCA('.jsScrollEmail').data('analytics-placeholder'));newsletterWidget.animate('-100%');}return true;});$.validator.addMethod("sendForm",function(value,element,isValid){if(isValid){$.ajax({type:"POST",url:newsletterWidget.newsletterForm.form.attr('action'),data:newsletterWidget.newsletterForm.form.serialize(),success:function(data){if(data.code===1){YP.Analytics.callSubscriptionWidgetAnalytic(true);YPCA.Analytics.clicks($YPCA('.jsScrollLocation'),$YPCA('.jsScrollLocation').data('analytics-placeholder'));newsletterWidget.animate('-200%');$('.jsNewsletterTopAnim').addClass('swingLeft');}else{YP.Analytics.callSubscriptionWidgetAnalytic(false);}},error:function(){}});}return true;});},addError:function(){setTimeout(function(){newsletterWidget.newsletterForm.fieldEmail.parent('.jsFieldWrapper').addClass(newsletterWidget.newsletterForm.errorWrapperClass);newsletterWidget.newsletterForm.fieldEmail.addClass('error');},10);},animate:function(by){newsletterWidget.newsletterForm.formWrapper.animate({left:by},{duration:500,specialEasing:{width:"linear",height:"easeOutBounce"},complete:function(){$(document).trigger('animation/ended');}});},setValidateEmail:function(){$YPCA('.jsScrollEmail').unbind('click').bind('click',function(){newsletterWidget.newsletterForm.fieldEmail[0].value=YP.YidService.checkForQuotes(newsletterWidget.newsletterForm.fieldEmail[0]);newsletterWidget.validateEmail(newsletterWidget.newsletterForm.fieldEmail);});newsletterWidget.newsletterForm.form.on('keyup','input[type=text]',function(e){if(YP.Utils.isEnterKeyPressed(e)){this.value=YP.YidService.checkForQuotes(this);newsletterWidget.validateEmail($(this));}});},validateEmail:function(el){var isValid=$(el).valid(),$nextInputs=$(el).parents('li').next().find('input, button'),newIndex=3;if(isValid){$nextInputs.each(function(index){$(this).prop('tabindex',index+newIndex);});}$(document).on('animation/ended',function(){$nextInputs.eq(0).focus();});},setValidateLocation:function(){$YPCA('.jsScrollLocation').unbind('click').bind('click',function(){newsletterWidget.validateLocation();});newsletterWidget.newsletterForm.form.on('keyup','.jsNewsletterPostalCodeField',function(e){if(YP.Utils.isEnterKeyPressed(e)){newsletterWidget.validateLocation();}});},validateLocation:function(){var isValidPostalCode=newsletterWidget.newsletterForm.fieldPostalCode.valid();if(isValidPostalCode){YP.Common.callToMarketo(newsletterWidget.newsletterForm.fieldEmail.val());}},validatRules1:{onfocusout:false,onkeyup:false,rules:{email:{required:true,email:true,emailValidationNewsLetter:true},location:{required:true,validatePostalCode:true,sendForm:true}},messages:{"email":{"required":YP.Common.getMessage("modal.login.error.provide.email"),"email":YP.Common.getMessage("modal.login.error.invalid.email")},"location":{"required":YP.Common.getMessage("modal.login.error.provide.required.postalCode"),"validatePostalCode":YP.Common.getMessage("modal.login.error.provide.postalCode")}}}};$(function(){newsletterWidget._init();});})($YPCA);"use strict";YP.HeaderFooter=(function($YPCA){var headerFooter={$body:$YPCA('body'),$html:$YPCA('html'),$footerLinks:$YPCA('.jsFooter'),$footerLinksMenu:$YPCA('.ypgFooterLinks'),mobileSearchClass:'mobileSearch',$hasMenu:$YPCA('.jsHasSubMenu'),openMenuClassName:'open-menu',mobileScreenSearch:800,activeClass:'active',_init:function(){headerFooter.$footerLinksMenu.addClass('notHidden');headerFooter.$footerLinks.addClass('notHidden');headerFooter._showWhereAllResults();headerFooter._toggleFooter();headerFooter._eventsSubMenu();headerFooter._toggleTabSearchEvents();headerFooter._addExpandableBreadcrumb();},_addClickEventListeners:function(){var showClassLink='jsBreadcrumbFooterItem ypgBreadcrumbs-nav_label--visible';$YPCA('body').on('click','.jsBreadcrumbFooterExpand',function(){$YPCA(this).addClass('hidden').siblings('.jsBreadcrumbFooterItem').addClass(showClassLink);});},_addExpandableBreadcrumb:function(){if($YPCA('.jsBreadcrumbFooterItemFirst').length>0 & ()){var label=$YPCA('.jsBreadcrumbWrapper').data('more'),html=' '+label+' ';headerFooter._addClickEventListeners();$YPCA('.jsBreadcrumbFooterItemFirst').after(html);}},_eventsSubMenu:function(){headerFooter.$hasMenu.click(function(){headerFooter._closeAllSubMenu(headerFooter.$hasMenu.not(this));$YPCA(this).toggleClass(headerFooter.openMenuClassName);});$YPCA(window).on('resize orientationchange',function(){if($YPCA(window).width()>headerFooter.mobileScreenSearch){headerFooter._removeMobileSearchClass();}});},_closeAllSubMenu:function($elems){$elems.removeClass(headerFooter.openMenuClassName);},_showWhereAllResults:function(){$YPCA('.jsSearchWhat,.jsShowMobileForm').click(function(e){e.stopPropagation();if($YPCA(window).width() < =headerFooter.mobileScreenSearch){headerFooter.$body.addClass(headerFooter.mobileSearchClass);headerFooter.$html.addClass('noScrollOnBody');}});$YPCA('.jsCloseSearch').on('click',function(e){e.preventDefault();headerFooter._removeMobileSearchClass();});},_toggleFooter:function(){if($YPCA('.jsFooterItemToggle[data-toggle="collapse-next"]').length>0){$YPCA('.jsFooter').on('click','.jsFooterItemToggle[data-toggle=collapse-next]',function(e){e.preventDefault();$YPCA(this).toggleClass('collapsed').next('.jsFooterItemToggleBody').toggleClass('showFooterCollapse');});}},_removeMobileSearchClass:function(){headerFooter.$body.removeClass(headerFooter.mobileSearchClass);headerFooter.$html.removeClass('noScrollOnBody');},_toggleTabSearchEvents:function(){var $tabs=$YPCA('.jsSearchTabs .jsYPTab'),allContents=$tabs.map(function(){return'.'+$YPCA(this).data('target');}).get().join(),$allContents=$YPCA(allContents),$defaultTabs=$YPCA('.jsSearchTabs .jsYPTab.'+headerFooter.activeClass+', .jsTabContent.'+headerFooter.activeClass+', .jsSearchContent.'+headerFooter.activeClass),$tabsContent=$YPCA('.jsTabsContent'),tabContentsDefaultClass=$tabsContent.attr('class');$YPCA('.jsSearchTabs .jsYPTab').click(function(){var className=$YPCA(this).data('css-class');if(YP.Utils.isDefined(className)){$tabsContent.removeClass('dineActive serpActive orderActive').addClass(className);}if(!$YPCA(this).hasClass('active')){if($YPCA(this).hasClass('jsOrder')){$YPCA('.jsTabsContent').removeClass('search-selected reserve-selected').addClass('order-selected');}if($YPCA(this).hasClass('jsSearch')){$YPCA('.jsTabsContent').removeClass('order-selected reserve-selected').addClass('search-selected');}if($YPCA(this).hasClass('jsReserve')){$YPCA('.jsTabsContent').removeClass('order-selected search-selected').addClass('reserve-selected');}}headerFooter._removeClass($tabs.add($allContents));$YPCA(this).addClass(headerFooter.activeClass);if($YPCA('div.jsTabsContent').is(":visible") & ()){headerFooter._triggerSearchOnSwitch();}});$YPCA('.jsCloseSearch').click(function(){headerFooter._removeClass($tabs.add($allContents));$defaultTabs.addClass(headerFooter.activeClass);$tabsContent.attr('class',tabContentsDefaultClass);});},_removeClass:function($elems){$elems.removeClass(headerFooter.activeClass);},_triggerSearchOnSwitch:function(){if($YPCA('.jsYPTab.active').data('css-class')!=='orderActive' & & $YPCA('#where').val()!=='' & & $YPCA('#whereReserve').val()!==''){$YPCA('.jsBtnSearchForm').is(":visible")?$YPCA('.jsBtnSearchForm:visible').trigger('click'):$YPCA('.jsBtnReserve').trigger('click');}}};$YPCA(function(){headerFooter._init();});})($YPCA);"use strict";var YP=window.YP||{};YP.ValidationUtils=(function($YPCA){var validation={settings:{classNameError:'has-error',classNameErrorMsg:'control-msg',parentSelector:'.jsFormGroup',AMERICAN_EXPRESS:"American Express",DINERS_CLUB:"Diners Club",DISCOVER:"Discover",MASTER_CARD:"MasterCard",VISA:"Visa"},_init:function(){validation._addValidationMethods();},_addValidationMethods:function(){$YPCA.validator.addMethod("lettersOnly",function(value){return(/^[\sa-zÀÁÂÃÄÅàáâãäåÒÓÔÕÖØòóôõöøÈÉÊËèéêëÇçÌÍÎÏìíîïÙÚÛÜùúûüÿÑñ-]*$/i).test(value);});$YPCA.validator.addMethod("validateDisplayName",function(value){return(/^[a-z0-9àáâãäåçèéêëìíîïðñòóôõûùúüýÿ \-_',!@#$%? & *()+=]*$/).test(value);});$YPCA.validator.addMethod("validatePostalCode",function(value){return(/^[ ]*$|^[ABCEGHJ-NPRSTVXY]\d[ABCEGHJ-NPRSTVXYWZ][ ]*$|^[ABCEGHJ-NPRSTVXY]\d[ABCEGHJ-NPRSTVXYWZ][ ]?\d[ABCEGHJ-NPRSTVXYWZ]\d$/i).test(value);});$YPCA.validator.addMethod("usernameFormatValidation",validation._validateUserNameFormat);$YPCA.validator.addMethod("emailValidationYID",function(value,element,params){var isValid=true;YP.YidService.validateEmailFieldOnYID(value).done(function(data){var code=data.code;if(code==='1'){isValid=true;}else{validation._showErrorMessage(code,params.getForm(),params.getErrorMsgObj());isValid=false;}}).fail(function(){isValid=false;});return isValid;});$YPCA.validator.addMethod("emailValidationBasic",validation._validateEmailBasic);$YPCA.validator.addMethod("notEqualTo",function(value,element,param){return this.optional(element)||value!==$YPCA("#"+param).val();},YP.Common.getMessage("merchant.update.error"));},_showErrorMessage:function(code,form,errorMessagesObj){var objError={};switch(code){case'2':objError[errorMessagesObj.fieldName]=errorMessagesObj.validationMessage.emailValidationYID;form.showErrors(objError);break;case'3':objError[errorMessagesObj.fieldName]=errorMessagesObj.validationMessage.emailInvalidFormat;form.showErrors(objError);break;case'4':objError[errorMessagesObj.fieldName]=errorMessagesObj.validationMessage.emailInvalidGuidelines;form.showErrors(objError);break;default:throw new TypeError('Status code is undefined.');}},_validateEmailBasic:function(value){return(/^([a-zA-Z0-9_\-\.\+]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,6}|[0-9]{1,3})(\]?)$/).test(value);},_validateUserNameFormat:function(value){return(/^[a-zA-Z0-9]{6,50}/).test(value);},publicFunctions:{addClassErrorToParent:function(element){$YPCA(element).closest(validation.settings.parentSelector).addClass(validation.settings.classNameError);},removeClassErrorToParent:function(element){$YPCA(element).closest(validation.settings.parentSelector).removeClass(validation.settings.classNameError);},removeAllClassesError:function(){$YPCA(validation.settings.parentSelector).removeClass(validation.settings.classNameError);},errorPlacement:function(error,element){$YPCA(error).addClass(validation.settings.classNameErrorMsg).insertAfter($YPCA(element));},getCardType:function(number){var re=new RegExp("^4");if(number.match(re)!==null){return validation.settings.VISA;}re=new RegExp("^5[1-5]");if(number.match(re)!==null){return validation.settings.MASTER_CARD;}re=new RegExp("^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)");if(number.match(re)!==null){return validation.settings.DISCOVER;}re=new RegExp("^(34|37)");if(number.match(re)!==null){return validation.settings.AMERICAN_EXPRESS;}re=new RegExp("^36");if(number.match(re)!==null){return validation.settings.DINERS_CLUB;}},isDigitOnly:function(charCode){if((charCode>31 & & (charCode < 37||charCode>57)) & & (charCode < 96||charCode>105)||event.shiftKey){return false;}return true;}}};$YPCA(document).ready(function(){validation._init();});return validation.publicFunctions;})($YPCA);"use strict";var YP=window.YP||{};YP.StickyHeader=(function($YPCA,window){var $header=$YPCA('.jsHeader .ypg-header'),$body=$YPCA('body'),doAnimation=$YPCA('body').not('.expandMap'),fixedClassName='ypg-header--fixed',fixedTopClassName='ypg-header--fixedbar',topBarHeight=$YPCA('.ypg-header__top').height()function init(){if(doAnimation){$YPCA(window).scroll(onScroll);scrollDirection();}}function onScroll(){var windowSrollTop=$YPCA(window).scrollTop();setClassFixed(windowSrollTop);}function setClassFixed(windowSrollTop){var $headerWrapper=$YPCA('.jsHeaderWrapper');if(!$YPCA('body').hasClass('presence') & & $headerWrapper.length!==0){if(windowSrollTop < =$headerWrapper.offset().top+topBarHeight){$header.removeClass(fixedClassName);}else{$header.addClass(fixedClassName);}}if($YPCA('body').hasClass('ypg-header--fixedbar--body')){if(!$YPCA('.searchBodyClass .page__container--right-sidebar').hasClass('margin-top-20')||$YPCA('.popular-links-serp').is(":hidden")){$YPCA('.popular-links-serp').show(250);$YPCA('.searchBodyClass .page__container--right-sidebar').addClass('margin-top-20');}}else{if($YPCA('.searchBodyClass .page__container--right-sidebar').hasClass('margin-top-20')||!$YPCA('.popular-links-serp').is(":hidden")){$YPCA('.popular-links-serp').hide(250);$YPCA('.searchBodyClass .page__container--right-sidebar').removeClass('margin-top-20');}}}function scrollDirection(){var lastScrollTop=0;var minPosition;if($YPCA('body').hasClass('merchantBodyClass')){minPosition=150;}else{minPosition=0;}$YPCA(window).scroll(function(){if($YPCA('body').hasClass('homeBodyClass')){var st=$YPCA(this).scrollTop();if(st < =300){$YPCA(".jsSearchForm").detach().prependTo('.home_search_form_regular')$YPCA(".jsActionHide").show();$YPCA(".search-field").removeClass("height40");$YPCA(".search-form__button").removeClass("height40");$header.addClass(fixedTopClassName);$body.addClass(fixedTopClassName+'--body');}else if(st>lastScrollTop & >300){$YPCA(".jsActionHide").hide();$YPCA(".jsSearchForm").detach().prependTo('.home_header_search_form')$YPCA(".ypg-header__wrapper").removeClass("yp-header__wrapper__home");$YPCA(".search-field").addClass("height40");$YPCA(".search-form__button").addClass("height40");$header.removeClass(fixedTopClassName);$body.removeClass(fixedTopClassName+'--body');}lastScrollTop=st;}else{var st=$YPCA(this).scrollTop();if(st < =minPosition){$header.addClass(fixedTopClassName);$body.addClass(fixedTopClassName+'--body');if($YPCA(".merchant__info__sticky").length>0){$YPCA(".merchant__info__sticky").hide();$YPCA(".mlr__fixed").removeClass("mlr__fixed__display");$YPCA(".mlr__fixed .mlr__item--active").removeClass("mlr__item--active");}}else{$header.removeClass(fixedTopClassName);$body.removeClass(fixedTopClassName+'--body');if($YPCA(".merchant__info__sticky").length>0){$YPCA(".merchant__info__sticky").show();$YPCA(".mlr__fixed").addClass("mlr__fixed__display");}}lastScrollTop=st;}});}$YPCA(function(){init();});return{init:init,setClassFixed:setClassFixed};})($YPCA,window);"use strict";YP.SensitiveHeadings=(function($YPCA,window){var sensitiveHeadings={settings:{merchantName:'',merchantWebsiteUrl:''},_init:function(){sensitiveHeadings._addEventListeners();},_addEventListeners:function(){$YPCA("body").on('click','.jsModalSensitiveBtn',function(e){e.preventDefault();sensitiveHeadings.settings.merchantName=$YPCA(this).data('merchantname');sensitiveHeadings.settings.merchantWebsiteUrl=$YPCA(this).data('href');});$YPCA(".jsBtnSensitiveCancel").click(function(){$YPCA('.jsModalSensitive').modal('hide');});$YPCA('.jsBtnSensitiveGoTo').click(function(){window.open($YPCA(this).attr('href'),'_blank');$YPCA('.jsModalSensitive').modal('hide');});$YPCA('.jsModalSensitive').on('shown.bs.modal',function(){$YPCA('.jsBtnSensitiveGoTo').attr('href',sensitiveHeadings.settings.merchantWebsiteUrl);$YPCA('.jsAlertSensitiveContent span').text(sensitiveHeadings.settings.merchantName);});$YPCA('.jsModalSensitive').on('hidden.bs.modal',function(){$YPCA('.jsBtnSensitiveGoTo').attr('href','');$YPCA('.jsAlertSensitiveContent span').text('');});}};$YPCA(function(){sensitiveHeadings._init();});})($YPCA,window);YP.UserMenu=(function($YPCA){var userMenu={menuVar:{$body:$YPCA('body')},_init:function(){userMenu._btnEvents('.open-left','side-menu--mobile--open');userMenu._btnEvents('.open-left','side-menu--left--open');userMenu._btnEvents('.open-right','side-menu--right--open');userMenu._closeBtn();$YPCA(document).on('keyup',function(e){if(YP.Utils.isEscapeKeyPressed(e) & & $YPCA('.side-menu--left--open').length){userMenu._closeLeftSide();}if(YP.Utils.isEscapeKeyPressed(e) & & $YPCA('.side-menu--left--mobile').length){userMenu._closeLeftSide();}});$YPCA('.jsSideMenuMobile a:last').on('blur',function(e){$YPCA('.jsYPSites a:first').focus();});},_btnEvents:function(selectorStr,toggleClass){$YPCA('.ypg-header').on('click',selectorStr,function(e){e.preventDefault();e.stopPropagation();userMenu.menuVar.$body.toggleClass(toggleClass);YP.Utils.toggleSetAttributesValues($YPCA(this),'aria-expanded',toggleClass!=='');$YPCA('.jsYPSites a:first').focus();});$YPCA(document).on('click','.jsOpenUserMenu',function(){$YPCA('.side-menu--right').addClass("userMenuMobile");});},_removeOpenClassBody:function(){if($YPCA(".userMenuMobile").length>0){userMenu._hideUserMenuMobile();}YP.Utils.toggleSetAttributesValues($YPCA('.jsOpenHamburgerMenu'),'aria-expanded',false);userMenu.menuVar.$body.removeClass('side-menu--left--open side-menu--right--open side-menu--mobile--open');},_hideUserMenuMobile:function(){$YPCA(".side-menu--right").removeClass("userMenuMobile");},_closeLeftSide:function(){userMenu._removeOpenClassBody();$YPCA('.jsYPTopSites a:eq(1)').focus()},_closeBtn:function(){$YPCA('.side-menu').on('click','.jsCloseUserMenu',function(e){e.preventDefault();userMenu._removeOpenClassBody();});$YPCA('.action-bar').on('click','.jsCloseUserMenu',function(e){e.preventDefault();if($YPCA(".userMenuMobile").length>0){userMenu._hideUserMenuMobile();}else{userMenu._removeOpenClassBody();}});$YPCA('.jsOverlayContainer').click(function(){userMenu._removeOpenClassBody();});}};$YPCA(function(){userMenu._init();});})($YPCA);"use strict";YP.RecentSearchedBusinesses=(function($YPCA,window,document){var recentSearchedBusinesses={settings:{cookieToolBar:"yp.engagement",cookieData:[],maxCookie:3,nbMilliSecond:5*1000,timer:'',isMerchantPage:$YPCA("body").hasClass("ypg_merchant"),addToCookie:true,isMinimized:"false",bodyPaddingClass:'toolbarPadding',supportedClicks:["saveshare_facebook","saveshare_googlebookmark","saveshare_twitter_merchant","directions_step1","little-pin","pin"],duplicateReview:""},_init:function(){if(recentSearchedBusinesses._setEngagementConfig()){recentSearchedBusinesses.settings.cookieData=recentSearchedBusinesses._getCookie();if(recentSearchedBusinesses.settings.isMerchantPage & ){recentSearchedBusinesses._startTimer();recentSearchedBusinesses._businessCardsEvent();}}},_addMerchantInCookie:function(){recentSearchedBusinesses.settings.cookieData.unshift({id:recentSearchedBusinesses.settings.merchantId,ts:new Date().getTime()});if(recentSearchedBusinesses.settings.cookieData.length>recentSearchedBusinesses.settings.maxCookie){recentSearchedBusinesses._removeMerchantInCookie(recentSearchedBusinesses.settings.cookieData.length-1);}},_businessCardsEvent:function(){$YPCA(".merchantHead,.shareBar").on('analytics-click',function(){recentSearchedBusinesses._triggerCookieEvent();});$YPCA(document).on('analytics-click',function(e){if($YPCA.inArray(e.name,recentSearchedBusinesses.settings.supportedClicks)!==-1){recentSearchedBusinesses._triggerCookieEvent();}});},_getCookie:function(){var value=[],cookieToolbar=$YPCA.cookie(recentSearchedBusinesses.settings.cookieToolBar);if(cookieToolbar!==null){try{value=JSON.parse(cookieToolbar);}catch(e){recentSearchedBusinesses._removeCookie();}}return value;},_isSameMerchant:function(merchantId){var idFind=false,pos=-1;for(var i=0;!idFind & 0;if(hasConfig){recentSearchedBusinesses.settings=$YPCA.extend(recentSearchedBusinesses.settings,JSON.parse($config.html()));}return hasConfig;},_startTimer:function(){recentSearchedBusinesses.settings.timer=setTimeout(recentSearchedBusinesses._manageCookie,recentSearchedBusinesses.settings.nbMiliSecond);},_triggerCookieEvent:function(){clearTimeout(recentSearchedBusinesses.settings.timer);recentSearchedBusinesses._manageCookie();},publicFunctions:{removeMerchantInCookie:function(posMerchant){recentSearchedBusinesses.settings.cookieData=recentSearchedBusinesses._getCookie();recentSearchedBusinesses._removeMerchantInCookie(posMerchant);}}};$YPCA(function(){recentSearchedBusinesses._init();});return recentSearchedBusinesses.publicFunctions;})($YPCA,window,document);//! moment.js//! version : 2.10.6//! authors : Tim Wood, Iskren Chernev, Moment.js contributors//! license : MIT//! momentjs.com!function(a,b){"object"==typeof exports & & "undefined"!=typeof module?module.exports=b():"function"==typeof define & ?define(b):a.moment=b()}(this,function(){"use strict";function a(){return Hc.apply(null,arguments)}function b(a){Hc=a}function c(a){return"[object Array]"===Object.prototype.toString.call(a)}function d(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function e(a,b){var c,d=[];for(c=0;c < 0)||b.empty||b.invalidMonth||b.invalidWeekday||b.nullInput||b.invalidFormat||b.userInvalidated),a._strict & & (a._isValid=a._isValid & & 0===b.charsLeftOver & & 0===b.unusedTokens.length &  0===b.bigHour)}return a._isValid}function l(a){var b=h(NaN);return null!=a?g(j(b),a):j(b).userInvalidated=!0,b}function m(a,b){var c,d,e;if("undefined"!=typeof b._isAMomentObject & & (a._isAMomentObject=b._isAMomentObject),"undefined"!=typeof b._i & & (a._i=b._i),"undefined"!=typeof b._f & & (a._f=b._f),"undefined"!=typeof b._l & & (a._l=b._l),"undefined"!=typeof b._strict & & (a._strict=b._strict),"undefined"!=typeof b._tzm & & (a._tzm=b._tzm),"undefined"!=typeof b._isUTC & & (a._isUTC=b._isUTC),"undefined"!=typeof b._offset & & (a._offset=b._offset),"undefined"!=typeof b._pf & & (a._pf=j(b)),"undefined"!=typeof b._locale & & (a._locale=b._locale),Jc.length>0)for(c in Jc)d=Jc[c],e=b[d],"undefined"!=typeof e & & (a[d]=e);return a}function n(b){m(this,b),this._d=new Date(null!=b._d?b._d.getTime():NaN),Kc===!1 & & (Kc=!0,a.updateOffset(this),Kc=!1)}function o(a){return a instanceof n||null!=a & !=a._isAMomentObject}function p(a){return 0>a?Math.ceil(a):Math.floor(a)}function q(a){var b=+a,c=0;return 0!==b & (b) & & (c=p(b)),c}function r(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c & [d]!==b[d]||!c & (a[d])!==q(b[d])) & ++;return g+f}function s(){}function t(a){return a?a.toLowerCase().replace("_","-"):a}function u(a){for(var b,c,d,e,f=0;f 0;){if(d=v(e.slice(0,b).join("-")))return d;if(c & >=b & (e,c,!0)>=b-1)break;b--}f++}return null}function v(a){var b=null;if(!Lc[a] & & "undefined"!=typeof module & & )try{b=Ic._abbr,require("./locale/"+a),w(b)}catch(c){}return Lc[a]}function w(a,b){var c;return a & & (c="undefined"==typeof b?y(a):x(a,b),c & & (Ic=c)),Ic._abbr}function x(a,b){return null!==b?(b.abbr=a,Lc[a]=Lc[a]||new s,Lc[a].set(b),w(a),Lc[a]):(delete Lc[a],null)}function y(a){var b;if(a & _locale & _locale._abbr & & (a=a._locale._abbr),!a)return Ic;if(!c(a)){if(b=v(a))return b;a=[a]}return u(a)}function z(a,b){var c=a.toLowerCase();Mc[c]=Mc[c+"s"]=Mc[b]=a}function A(a){return"string"==typeof a?Mc[a]||Mc[a.toLowerCase()]:void 0}function B(a){var b,c,d={};for(c in a)f(a,c) & & (b=A(c),b & & (d[b]=a[c]));return d}function C(b,c){return function(d){return null!=d?(E(this,b,d),a.updateOffset(this,c),this):D(this,b)}}function D(a,b){return a._d["get"+(a._isUTC?"UTC":"")+b]()}function E(a,b,c){return a._d["set"+(a._isUTC?"UTC":"")+b](c)}function F(a,b){var c;if("object"==typeof a)for(c in a)this.set(c,a[c]);else if(a=A(a),"function"==typeof this[a])return this[a](b);return this}function G(a,b,c){var d=""+Math.abs(a),e=b-d.length,f=a>=0;return(f?c?"+":"":"-")+Math.pow(10,Math.max(0,e)).toString().substr(1)+d}function H(a,b,c,d){var e=d;"string"==typeof d & & (e=function(){return this[d]()}),a & & (Qc[a]=e),b & & (Qc[b[0]]=function(){return G(e.apply(this,arguments),b[1],b[2])}),c & & (Qc[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function I(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function J(a){var b,c,d=a.match(Nc);for(b=0,c=d.length;c>b;b++)Qc[d[b]]?d[b]=Qc[d[b]]:d[b]=I(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function K(a,b){return a.isValid()?(b=L(b,a.localeData()),Pc[b]=Pc[b]||J(b),Pc[b](a)):a.localeData().invalidDate()}function L(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(Oc.lastIndex=0;d>=0 & (a);)a=a.replace(Oc,c),Oc.lastIndex=0,d-=1;return a}function M(a){return"function"==typeof a & & "[object Function]"===Object.prototype.toString.call(a)}function N(a,b,c){dd[a]=M(b)?b:function(a){return a & ?c:b}}function O(a,b){return f(dd,a)?dd[a](b._strict,b._locale):new RegExp(P(a))}function P(a){return a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$ & ")}function Q(a,b){var c,d=b;for("string"==typeof a & & (a=[a]),"number"==typeof b & & (d=function(a,c){c[b]=q(a)}),c=0;c d;d++){if(e=h([2e3,d]),c & & !this._longMonthsParse[d] & & (this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(f="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(f.replace(".",""),"i")),c & & "MMMM"===b & _longMonthsParse[d].test(a))return d;if(c & & "MMM"===b & _shortMonthsParse[d].test(a))return d;if(!c & _monthsParse[d].test(a))return d}}function X(a,b){var c;return"string"==typeof b & & (b=a.localeData().monthsParse(b),"number"!=typeof b)?a:(c=Math.min(a.date(),T(a.year(),b)),a._d["set"+(a._isUTC?"UTC":"")+"Month"](b,c),a)}function Y(b){return null!=b?(X(this,b),a.updateOffset(this,!0),this):D(this,"Month")}function Z(){return T(this.year(),this.month())}function $(a){var b,c=a._a;return c & & -2===j(a).overflow & & (b=c[gd] < 0||c[gd]>11?gd:c[hd] < 1||c[hd]>T(c[fd],c[gd])?hd:c[id] < 0||c[id]>24||24===c[id] & & (0!==c[jd]||0!==c[kd]||0!==c[ld])?id:c[jd] < 0||c[jd]>59?jd:c[kd] < 0||c[kd]>59?kd:c[ld] < 0||c[ld]>999?ld:-1,j(a)._overflowDayOfYear & & (fd>b||b>hd) & & (b=hd),j(a).overflow=b),a}function _(b){a.suppressDeprecationWarnings===!1 & & "undefined"!=typeof console & & ("Deprecation warning: "+b)}function aa(a,b){var c=!0;return g(function(){return c & & (_(a+"\n"+(new Error).stack),c=!1),b.apply(this,arguments)},b)}function ba(a,b){od[a]||(_(b),od[a]=!0)}function ca(a){var b,c,d=a._i,e=pd.exec(d);if(e){for(j(a).iso=!0,b=0,c=qd.length;c>b;b++)if(qd[b][1].exec(d)){a._f=qd[b][0];break}for(b=0,c=rd.length;c>b;b++)if(rd[b][1].exec(d)){a._f+=(e[6]||" ")+rd[b][0];break}d.match(ad) & & (a._f+="Z"),va(a)}else a._isValid=!1}function da(b){var c=sd.exec(b._i);return null!==c?void(b._d=new Date(+c[1])):(ca(b),void(b._isValid===!1 & & (delete b._isValid,a.createFromInputFallback(b))))}function ea(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a & (a),h}function fa(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a & (a),b}function ga(a){return ha(a)?366:365}function ha(a){return a%4===0 & %100!==0||a%400===0}function ia(){return ha(this.year())}function ja(a,b,c){var d,e=c-b,f=c-a.day();return f>e & & (f-=7),e-7>f & & (f+=7),d=Da(a).add(f,"d"),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function ka(a){return ja(a,this._week.dow,this._week.doy).week}function la(){return this._week.dow}function ma(){return this._week.doy}function na(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")}function oa(a){var b=ja(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")}function pa(a,b,c,d,e){var f,g=6+e-d,h=fa(a,0,1+g),i=h.getUTCDay();return e>i & & (i+=7),c=null!=c?1*c:e,f=1+g+7*(b-1)-i+c,{year:f>0?a:a-1,dayOfYear:f>0?f:ga(a-1)+f}}function qa(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==a?b:this.add(a-b,"d")}function ra(a,b,c){return null!=a?a:null!=b?b:c}function sa(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function ta(a){var b,c,d,e,f=[];if(!a._d){for(d=sa(a),a._w & ==a._a[hd] & ==a._a[gd] & (a),a._dayOfYear & & (e=ra(a._a[fd],d[fd]),a._dayOfYear>ga(e) & & (j(a)._overflowDayOfYear=!0),c=fa(e,0,a._dayOfYear),a._a[gd]=c.getUTCMonth(),a._a[hd]=c.getUTCDate()),b=0;3>b & ==a._a[b];++b)a._a[b]=f[b]=d[b];for(;7>b;b++)a._a[b]=f[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[id] & & 0===a._a[jd] & & 0===a._a[kd] & & 0===a._a[ld] & & (a._nextDay=!0,a._a[id]=0),a._d=(a._useUTC?fa:ea).apply(null,f),null!=a._tzm & _d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay & & (a._a[id]=24)}}function ua(a){var b,c,d,e,f,g,h;b=a._w,null!=b.GG||null!=b.W||null!=b.E?(f=1,g=4,c=ra(b.GG,a._a[fd],ja(Da(),1,4).year),d=ra(b.W,1),e=ra(b.E,1)):(f=a._locale._week.dow,g=a._locale._week.doy,c=ra(b.gg,a._a[fd],ja(Da(),f,g).year),d=ra(b.w,1),null!=b.d?(e=b.d,f>e & & ++d):e=null!=b.e?b.e+f:f),h=pa(c,d,e,g,f),a._a[fd]=h.year,a._dayOfYear=h.dayOfYear}function va(b){if(b._f===a.ISO_8601)return void ca(b);b._a=[],j(b).empty=!0;var c,d,e,f,g,h=""+b._i,i=h.length,k=0;for(e=L(b._f,b._locale).match(Nc)||[],c=0;c 0 & (b).unusedInput.push(g),h=h.slice(h.indexOf(d)+d.length),k+=d.length),Qc[f]?(d?j(b).empty=!1:j(b).unusedTokens.push(f),S(f,d,b)):b._strict & & !d & (b).unusedTokens.push(f);j(b).charsLeftOver=i-k,h.length>0 & (b).unusedInput.push(h),j(b).bigHour===!0 & _a[id] < =12 & _a[id]>0 & & (j(b).bigHour=void 0),b._a[id]=wa(b._locale,b._a[id],b._meridiem),ta(b),$(b)}function wa(a,b,c){var d;return null==c?b:null!=a.meridiemHour?a.meridiemHour(b,c):null!=a.isPM?(d=a.isPM(c),d & & 12>b & & (b+=12),d||12!==b||(b=0),b):b}function xa(a){var b,c,d,e,f;if(0===a._f.length)return j(a).invalidFormat=!0,void(a._d=new Date(NaN));for(e=0;e f) & & (d=f,c=b));g(a,c||b)}function ya(a){if(!a._d){var b=B(a._i);a._a=[b.year,b.month,b.day||b.date,b.hour,b.minute,b.second,b.millisecond],ta(a)}}function za(a){var b=new n($(Aa(a)));return b._nextDay & & (b.add(1,"d"),b._nextDay=void 0),b}function Aa(a){var b=a._i,e=a._f;return a._locale=a._locale||y(a._l),null===b||void 0===e & & ""===b?l({nullInput:!0}):("string"==typeof b & & (a._i=b=a._locale.preparse(b)),o(b)?new n($(b)):(c(e)?xa(a):e?va(a):d(b)?a._d=b:Ba(a),a))}function Ba(b){var f=b._i;void 0===f?b._d=new Date:d(f)?b._d=new Date(+f):"string"==typeof f?da(b):c(f)?(b._a=e(f.slice(0),function(a){return parseInt(a,10)}),ta(b)):"object"==typeof f?ya(b):"number"==typeof f?b._d=new Date(f):a.createFromInputFallback(b)}function Ca(a,b,c,d,e){var f={};return"boolean"==typeof c & & (d=c,c=void 0),f._isAMomentObject=!0,f._useUTC=f._isUTC=e,f._l=c,f._i=a,f._f=b,f._strict=d,za(f)}function Da(a,b,c,d){return Ca(a,b,c,d,!1)}function Ea(a,b){var d,e;if(1===b.length & (b[0]) & & (b=b[0]),!b.length)return Da();for(d=b[0],e=1;e a & & (a=-a,c="-"),c+G(~~(a/60),2)+b+G(~~a%60,2)})}function Ka(a){var b=(a||"").match(ad)||[],c=b[b.length-1]||[],d=(c+"").match(xd)||["-",0,0],e=+(60*d[1])+q(d[2]);return"+"===d[0]?e:-e}function La(b,c){var e,f;return c._isUTC?(e=c.clone(),f=(o(b)||d(b)?+b:+Da(b))-+e,e._d.setTime(+e._d+f),a.updateOffset(e,!1),e):Da(b).local()}function Ma(a){return 15*-Math.round(a._d.getTimezoneOffset()/15)}function Na(b,c){var d,e=this._offset||0;return null!=b?("string"==typeof b & & (b=Ka(b)),Math.abs(b) < 16 & & (b=60*b),!this._isUTC & & & (d=Ma(this)),this._offset=b,this._isUTC=!0,null!=d & (d,"m"),e!==b & & (!c||this._changeInProgress?bb(this,Ya(b-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,a.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?e:Ma(this)}function Oa(a,b){return null!=a?("string"!=typeof a & & (a=-a),this.utcOffset(a,b),this):-this.utcOffset()}function Pa(a){return this.utcOffset(0,a)}function Qa(a){return this._isUTC & & (this.utcOffset(0,a),this._isUTC=!1,a & (Ma(this),"m")),this}function Ra(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i & (Ka(this._i)),this}function Sa(a){return a=a?Da(a).utcOffset():0,(this.utcOffset()-a)%60===0}function Ta(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Ua(){if("undefined"!=typeof this._isDSTShifted)return this._isDSTShifted;var a={};if(m(a,this),a=Aa(a),a._a){var b=a._isUTC?h(a._a):Da(a._a);this._isDSTShifted=this.isValid() & (a._a,b.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Va(){return!this._isUTC}function Wa(){return this._isUTC}function Xa(){return this._isUTC & & 0===this._offset}function Ya(a,b){var c,d,e,g=a,h=null;return Ia(a)?g={ms:a._milliseconds,d:a._days,M:a._months}:"number"==typeof a?(g={},b?g[b]=a:g.milliseconds=a):(h=yd.exec(a))?(c="-"===h[1]?-1:1,g={y:0,d:q(h[hd])*c,h:q(h[id])*c,m:q(h[jd])*c,s:q(h[kd])*c,ms:q(h[ld])*c}):(h=zd.exec(a))?(c="-"===h[1]?-1:1,g={y:Za(h[2],c),M:Za(h[3],c),d:Za(h[4],c),h:Za(h[5],c),m:Za(h[6],c),s:Za(h[7],c),w:Za(h[8],c)}):null==g?g={}:"object"==typeof g & & ("from"in g||"to"in g) & & (e=_a(Da(g.from),Da(g.to)),g={},g.ms=e.milliseconds,g.M=e.months),d=new Ha(g),Ia(a) & (a,"_locale") & & (d._locale=a._locale),d}function Za(a,b){var c=a & (a.replace(",","."));return(isNaN(c)?0:c)*b}function $a(a,b){var c={milliseconds:0,months:0};return c.months=b.month()-a.month()+12*(b.year()-a.year()),a.clone().add(c.months,"M").isAfter(b) & & --c.months,c.milliseconds=+b-+a.clone().add(c.months,"M"),c}function _a(a,b){var c;return b=La(b,a),a.isBefore(b)?c=$a(a,b):(c=$a(b,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c}function ab(a,b){return function(c,d){var e,f;return null===d||isNaN(+d)||(ba(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period)."),f=c,c=d,d=f),c="string"==typeof c?+c:c,e=Ya(c,d),bb(this,e,a),this}}function bb(b,c,d,e){var f=c._milliseconds,g=c._days,h=c._months;e=null==e?!0:e,f & _d.setTime(+b._d+f*d),g & (b,"Date",D(b,"Date")+g*d),h & (b,D(b,"Month")+h*d),e & (b,g||h)}function cb(a,b){var c=a||Da(),d=La(c,this).startOf("day"),e=this.diff(d,"days",!0),f=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(b & [f]||this.localeData().calendar(f,this,Da(c)))}function db(){return new n(this)}function eb(a,b){var c;return b=A("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+this>+a):(c=o(a)?+a:+Da(a),c < +this.clone().startOf(b))}function fb(a,b){var c;return b=A("undefined"!=typeof b?b:"millisecond"),"millisecond"===b?(a=o(a)?a:Da(a),+a>+this):(c=o(a)?+a:+Da(a),+this.clone().endOf(b) < =c & < =+this.clone().endOf(b))}function ib(a,b,c){var d,e,f=La(a,this),g=6e4*(f.utcOffset()-this.utcOffset());return b=A(b),"year"===b||"month"===b||"quarter"===b?(e=jb(this,f),"quarter"===b?e/=3:"year"===b & & (e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:p(e)}function jb(a,b){var c,d,e=12*(b.year()-a.year())+(b.month()-a.month()),f=a.clone().add(e,"months");return 0>b-f?(c=a.clone().add(e-1,"months"),d=(b-f)/(f-c)):(c=a.clone().add(e+1,"months"),d=(b-f)/(c-f)),-(e+d)}function kb(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function lb(){var a=this.clone().utc();return 0 < =9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():K(a,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):K(a,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function mb(b){var c=K(this,b||a.defaultFormat);return this.localeData().postformat(c)}function nb(a,b){return this.isValid()?Ya({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function ob(a){return this.from(Da(),a)}function pb(a,b){return this.isValid()?Ya({from:this,to:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()}function qb(a){return this.to(Da(),a)}function rb(a){var b;return void 0===a?this._locale._abbr:(b=y(a),null!=b & & (this._locale=b),this)}function sb(){return this._locale}function tb(a){switch(a=A(a)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a & (0),"isoWeek"===a & (1),"quarter"===a & (3*Math.floor(this.month()/3)),this}function ub(a){return a=A(a),void 0===a||"millisecond"===a?this:this.startOf(a).add(1,"isoWeek"===a?"week":a).subtract(1,"ms")}function vb(){return+this._d-6e4*(this._offset||0)}function wb(){return Math.floor(+this/1e3)}function xb(){return this._offset?new Date(+this):this._d}function yb(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function zb(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function Ab(){return k(this)}function Bb(){return g({},j(this))}function Cb(){return j(this).overflow}function Db(a,b){H(0,[a,a.length],0,b)}function Eb(a,b,c){return ja(Da([a,11,31+b-c]),b,c).week}function Fb(a){var b=ja(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==a?b:this.add(a-b,"y")}function Gb(a){var b=ja(this,1,4).year;return null==a?b:this.add(a-b,"y")}function Hb(){return Eb(this.year(),1,4)}function Ib(){var a=this.localeData()._week;return Eb(this.year(),a.dow,a.doy)}function Jb(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)}function Kb(a,b){return"string"!=typeof a?a:isNaN(a)?(a=b.weekdaysParse(a),"number"==typeof a?a:null):parseInt(a,10)}function Lb(a){return this._weekdays[a.day()]}function Mb(a){return this._weekdaysShort[a.day()]}function Nb(a){return this._weekdaysMin[a.day()]}function Ob(a){var b,c,d;for(this._weekdaysParse=this._weekdaysParse||[],b=0;7>b;b++)if(this._weekdaysParse[b]||(c=Da([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b}function Pb(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=Kb(a,this.localeData()),this.add(a-b,"d")):b}function Qb(a){var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")}function Rb(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)}function Sb(a,b){H(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Tb(a,b){return b._meridiemParse}function Ub(a){return"p"===(a+"").toLowerCase().charAt(0)}function Vb(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"}function Wb(a,b){b[ld]=q(1e3*("0."+a))}function Xb(){return this._isUTC?"UTC":""}function Yb(){return this._isUTC?"Coordinated Universal Time":""}function Zb(a){return Da(1e3*a)}function $b(){return Da.apply(null,arguments).parseZone()}function _b(a,b,c){var d=this._calendar[a];return"function"==typeof d?d.call(b,c):d}function ac(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return b||!c?b:(this._longDateFormat[a]=c.replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a])}function bc(){return this._invalidDate}function cc(a){return this._ordinal.replace("%d",a)}function dc(a){return a}function ec(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)}function fc(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)}function gc(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function hc(a,b,c,d){var e=y(),f=h().set(d,b);return e[c](f,a)}function ic(a,b,c,d,e){if("number"==typeof a & & (b=a,a=void 0),a=a||"",null!=b)return hc(a,b,c,e);var f,g=[];for(f=0;d>f;f++)g[f]=hc(a,f,c,e);return g}function jc(a,b){return ic(a,b,"months",12,"month")}function kc(a,b){return ic(a,b,"monthsShort",12,"month")}function lc(a,b){return ic(a,b,"weekdays",7,"day")}function mc(a,b){return ic(a,b,"weekdaysShort",7,"day")}function nc(a,b){return ic(a,b,"weekdaysMin",7,"day")}function oc(){var a=this._data;return this._milliseconds=Wd(this._milliseconds),this._days=Wd(this._days),this._months=Wd(this._months),a.milliseconds=Wd(a.milliseconds),a.seconds=Wd(a.seconds),a.minutes=Wd(a.minutes),a.hours=Wd(a.hours),a.months=Wd(a.months),a.years=Wd(a.years),this}function pc(a,b,c,d){var e=Ya(b,c);return a._milliseconds+=d*e._milliseconds,a._days+=d*e._days,a._months+=d*e._months,a._bubble()}function qc(a,b){return pc(this,a,b,1)}function rc(a,b){return pc(this,a,b,-1)}function sc(a){return 0>a?Math.floor(a):Math.ceil(a)}function tc(){var a,b,c,d,e,f=this._milliseconds,g=this._days,h=this._months,i=this._data;return f>=0 & >=0 & >=0||0>=f & & 0>=g & & 0>=h||(f+=864e5*sc(vc(h)+g),g=0,h=0),i.milliseconds=f%1e3,a=p(f/1e3),i.seconds=a%60,b=p(a/60),i.minutes=b%60,c=p(b/60),i.hours=c%24,g+=p(c/24),e=p(uc(g)),h+=e,g-=sc(vc(e)),d=p(h/12),h%=12,i.days=g,i.months=h,i.years=d,this}function uc(a){return 4800*a/146097}function vc(a){return 146097*a/4800}function wc(a){var b,c,d=this._milliseconds;if(a=A(a),"month"===a||"year"===a)return b=this._days+d/864e5,c=this._months+uc(b),"month"===a?c:c/12;switch(b=this._days+Math.round(vc(this._months)),a){case"week":return b/7+d/6048e5;case"day":return b+d/864e5;case"hour":return 24*b+d/36e5;case"minute":return 1440*b+d/6e4;case"second":return 86400*b+d/1e3;case"millisecond":return Math.floor(864e5*b)+d;default:throw new Error("Unknown unit "+a)}}function xc(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*q(this._months/12)}function yc(a){return function(){return this.as(a)}}function zc(a){return a=A(a),this[a+"s"]()}function Ac(a){return function(){return this._data[a]}}function Bc(){return p(this.days()/7)}function Cc(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function Dc(a,b,c){var d=Ya(a).abs(),e=ke(d.as("s")),f=ke(d.as("m")),g=ke(d.as("h")),h=ke(d.as("d")),i=ke(d.as("M")),j=ke(d.as("y")),k=e 0,k[4]=c,Cc.apply(null,k)}function Ec(a,b){return void 0===le[a]?!1:void 0===b?le[a]:(le[a]=b,!0)}function Fc(a){var b=this.localeData(),c=Dc(this,!a,b);return a & & (c=b.pastFuture(+this,c)),b.postformat(c)}function Gc(){var a,b,c,d=me(this._milliseconds)/1e3,e=me(this._days),f=me(this._months);a=p(d/60),b=p(a/60),d%=60,a%=60,c=p(f/12),f%=12;var g=c,h=f,i=e,j=b,k=a,l=d,m=this.asSeconds();return m?(0>m?"-":"")+"P"+(g?g+"Y":"")+(h?h+"M":"")+(i?i+"D":"")+(j||k||l?"T":"")+(j?j+"H":"")+(k?k+"M":"")+(l?l+"S":""):"P0D"}var Hc,Ic,Jc=a.momentProperties=[],Kc=!1,Lc={},Mc={},Nc=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Oc=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Pc={},Qc={},Rc=/\d/,Sc=/\d\d/,Tc=/\d{3}/,Uc=/\d{4}/,Vc=/[+-]?\d{6}/,Wc=/\d\d?/,Xc=/\d{1,3}/,Yc=/\d{1,4}/,Zc=/[+-]?\d{1,6}/,$c=/\d+/,_c=/[+-]?\d+/,ad=/Z|[+-]\d\d:?\d\d/gi,bd=/[+-]?\d+(\.\d{1,3})?/,cd=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,dd={},ed={},fd=0,gd=1,hd=2,id=3,jd=4,kd=5,ld=6;H("M",["MM",2],"Mo",function(){return this.month()+1}),H("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),H("MMMM",0,0,function(a){return this.localeData().months(this,a)}),z("month","M"),N("M",Wc),N("MM",Wc,Sc),N("MMM",cd),N("MMMM",cd),Q(["M","MM"],function(a,b){b[gd]=q(a)-1}),Q(["MMM","MMMM"],function(a,b,c,d){var e=c._locale.monthsParse(a,d,c._strict);null!=e?b[gd]=e:j(c).invalidMonth=a});var md="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),nd="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),od={};a.suppressDeprecationWarnings=!1;var pd=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,qd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],rd=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],sd=/^\/?Date\((\-?\d+)/i;a.createFromInputFallback=aa("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))}),H(0,["YY",2],0,function(){return this.year()%100}),H(0,["YYYY",4],0,"year"),H(0,["YYYYY",5],0,"year"),H(0,["YYYYYY",6,!0],0,"year"),z("year","y"),N("Y",_c),N("YY",Wc,Sc),N("YYYY",Yc,Uc),N("YYYYY",Zc,Vc),N("YYYYYY",Zc,Vc),Q(["YYYYY","YYYYYY"],fd),Q("YYYY",function(b,c){c[fd]=2===b.length?a.parseTwoDigitYear(b):q(b)}),Q("YY",function(b,c){c[fd]=a.parseTwoDigitYear(b)}),a.parseTwoDigitYear=function(a){return q(a)+(q(a)>68?1900:2e3)};var td=C("FullYear",!1);H("w",["ww",2],"wo","week"),H("W",["WW",2],"Wo","isoWeek"),z("week","w"),z("isoWeek","W"),N("w",Wc),N("ww",Wc,Sc),N("W",Wc),N("WW",Wc,Sc),R(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=q(a)});var ud={dow:0,doy:6};H("DDD",["DDDD",3],"DDDo","dayOfYear"),z("dayOfYear","DDD"),N("DDD",Xc),N("DDDD",Tc),Q(["DDD","DDDD"],function(a,b,c){c._dayOfYear=q(a)}),a.ISO_8601=function(){};var vd=aa("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var a=Da.apply(null,arguments);return this>a?this:a}),wd=aa("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var a=Da.apply(null,arguments);return a>this?this:a});Ja("Z",":"),Ja("ZZ",""),N("Z",ad),N("ZZ",ad),Q(["Z","ZZ"],function(a,b,c){c._useUTC=!0,c._tzm=Ka(a)});var xd=/([\+\-]|\d\d)/gi;a.updateOffset=function(){};var yd=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,zd=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Ya.fn=Ha.prototype;var Ad=ab(1,"add"),Bd=ab(-1,"subtract");a.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Cd=aa("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});H(0,["gg",2],0,function(){return this.weekYear()%100}),H(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Db("gggg","weekYear"),Db("ggggg","weekYear"),Db("GGGG","isoWeekYear"),Db("GGGGG","isoWeekYear"),z("weekYear","gg"),z("isoWeekYear","GG"),N("G",_c),N("g",_c),N("GG",Wc,Sc),N("gg",Wc,Sc),N("GGGG",Yc,Uc),N("gggg",Yc,Uc),N("GGGGG",Zc,Vc),N("ggggg",Zc,Vc),R(["gggg","ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=q(a)}),R(["gg","GG"],function(b,c,d,e){c[e]=a.parseTwoDigitYear(b)}),H("Q",0,0,"quarter"),z("quarter","Q"),N("Q",Rc),Q("Q",function(a,b){b[gd]=3*(q(a)-1)}),H("D",["DD",2],"Do","date"),z("date","D"),N("D",Wc),N("DD",Wc,Sc),N("Do",function(a,b){return a?b._ordinalParse:b._ordinalParseLenient}),Q(["D","DD"],hd),Q("Do",function(a,b){b[hd]=q(a.match(Wc)[0],10)});var Dd=C("Date",!0);H("d",0,"do","day"),H("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),H("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),H("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),H("e",0,0,"weekday"),H("E",0,0,"isoWeekday"),z("day","d"),z("weekday","e"),z("isoWeekday","E"),N("d",Wc),N("e",Wc),N("E",Wc),N("dd",cd),N("ddd",cd),N("dddd",cd),R(["dd","ddd","dddd"],function(a,b,c){var d=c._locale.weekdaysParse(a);null!=d?b.d=d:j(c).invalidWeekday=a}),R(["d","e","E"],function(a,b,c,d){b[d]=q(a)});var Ed="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Fd="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Gd="Su_Mo_Tu_We_Th_Fr_Sa".split("_");H("H",["HH",2],0,"hour"),H("h",["hh",2],0,function(){return this.hours()%12||12}),Sb("a",!0),Sb("A",!1),z("hour","h"),N("a",Tb),N("A",Tb),N("H",Wc),N("h",Wc),N("HH",Wc,Sc),N("hh",Wc,Sc),Q(["H","HH"],id),Q(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),Q(["h","hh"],function(a,b,c){b[id]=q(a),j(c).bigHour=!0});var Hd=/[ap]\.?m?\.?/i,Id=C("Hours",!0);H("m",["mm",2],0,"minute"),z("minute","m"),N("m",Wc),N("mm",Wc,Sc),Q(["m","mm"],jd);var Jd=C("Minutes",!1);H("s",["ss",2],0,"second"),z("second","s"),N("s",Wc),N("ss",Wc,Sc),Q(["s","ss"],kd);var Kd=C("Seconds",!1);H("S",0,0,function(){return~~(this.millisecond()/100)}),H(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),H(0,["SSS",3],0,"millisecond"),H(0,["SSSS",4],0,function(){return 10*this.millisecond()}),H(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),H(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),H(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),H(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),H(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),z("millisecond","ms"),N("S",Xc,Rc),N("SS",Xc,Sc),N("SSS",Xc,Tc);var Ld;for(Ld="SSSS";Ld.length < =9;Ld+="S")N(Ld,$c);for(Ld="S";Ld.length < =9;Ld+="S")Q(Ld,Wb);var Md=C("Milliseconds",!1);H("z",0,0,"zoneAbbr"),H("zz",0,0,"zoneName");var Nd=n.prototype;Nd.add=Ad,Nd.calendar=cb,Nd.clone=db,Nd.diff=ib,Nd.endOf=ub,Nd.format=mb,Nd.from=nb,Nd.fromNow=ob,Nd.to=pb,Nd.toNow=qb,Nd.get=F,Nd.invalidAt=Cb,Nd.isAfter=eb,Nd.isBefore=fb,Nd.isBetween=gb,Nd.isSame=hb,Nd.isValid=Ab,Nd.lang=Cd,Nd.locale=rb,Nd.localeData=sb,Nd.max=wd,Nd.min=vd,Nd.parsingFlags=Bb,Nd.set=F,Nd.startOf=tb,Nd.subtract=Bd,Nd.toArray=yb,Nd.toObject=zb,Nd.toDate=xb,Nd.toISOString=lb,Nd.toJSON=lb,Nd.toString=kb,Nd.unix=wb,Nd.valueOf=vb,Nd.year=td,Nd.isLeapYear=ia,Nd.weekYear=Fb,Nd.isoWeekYear=Gb,Nd.quarter=Nd.quarters=Jb,Nd.month=Y,Nd.daysInMonth=Z,Nd.week=Nd.weeks=na,Nd.isoWeek=Nd.isoWeeks=oa,Nd.weeksInYear=Ib,Nd.isoWeeksInYear=Hb,Nd.date=Dd,Nd.day=Nd.days=Pb,Nd.weekday=Qb,Nd.isoWeekday=Rb,Nd.dayOfYear=qa,Nd.hour=Nd.hours=Id,Nd.minute=Nd.minutes=Jd,Nd.second=Nd.seconds=Kd,    Nd.millisecond=Nd.milliseconds=Md,Nd.utcOffset=Na,Nd.utc=Pa,Nd.local=Qa,Nd.parseZone=Ra,Nd.hasAlignedHourOffset=Sa,Nd.isDST=Ta,Nd.isDSTShifted=Ua,Nd.isLocal=Va,Nd.isUtcOffset=Wa,Nd.isUtc=Xa,Nd.isUTC=Xa,Nd.zoneAbbr=Xb,Nd.zoneName=Yb,Nd.dates=aa("dates accessor is deprecated. Use date instead.",Dd),Nd.months=aa("months accessor is deprecated. Use month instead",Y),Nd.years=aa("years accessor is deprecated. Use year instead",td),Nd.zone=aa("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",Oa);var Od=Nd,Pd={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Qd={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Rd="Invalid date",Sd="%d",Td=/\d{1,2}/,Ud={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Vd=s.prototype;Vd._calendar=Pd,Vd.calendar=_b,Vd._longDateFormat=Qd,Vd.longDateFormat=ac,Vd._invalidDate=Rd,Vd.invalidDate=bc,Vd._ordinal=Sd,Vd.ordinal=cc,Vd._ordinalParse=Td,Vd.preparse=dc,Vd.postformat=dc,Vd._relativeTime=Ud,Vd.relativeTime=ec,Vd.pastFuture=fc,Vd.set=gc,Vd.months=U,Vd._months=md,Vd.monthsShort=V,Vd._monthsShort=nd,Vd.monthsParse=W,Vd.week=ka,Vd._week=ud,Vd.firstDayOfYear=ma,Vd.firstDayOfWeek=la,Vd.weekdays=Lb,Vd._weekdays=Ed,Vd.weekdaysMin=Nb,Vd._weekdaysMin=Gd,Vd.weekdaysShort=Mb,Vd._weekdaysShort=Fd,Vd.weekdaysParse=Ob,Vd.isPM=Ub,Vd._meridiemParse=Hd,Vd.meridiem=Vb,w("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=a%10,c=1===q(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),a.lang=aa("moment.lang is deprecated. Use moment.locale instead.",w),a.langData=aa("moment.langData is deprecated. Use moment.localeData instead.",y);var Wd=Math.abs,Xd=yc("ms"),Yd=yc("s"),Zd=yc("m"),$d=yc("h"),_d=yc("d"),ae=yc("w"),be=yc("M"),ce=yc("y"),de=Ac("milliseconds"),ee=Ac("seconds"),fe=Ac("minutes"),ge=Ac("hours"),he=Ac("days"),ie=Ac("months"),je=Ac("years"),ke=Math.round,le={s:45,m:45,h:22,d:26,M:11},me=Math.abs,ne=Ha.prototype;ne.abs=oc,ne.add=qc,ne.subtract=rc,ne.as=wc,ne.asMilliseconds=Xd,ne.asSeconds=Yd,ne.asMinutes=Zd,ne.asHours=$d,ne.asDays=_d,ne.asWeeks=ae,ne.asMonths=be,ne.asYears=ce,ne.valueOf=xc,ne._bubble=tc,ne.get=zc,ne.milliseconds=de,ne.seconds=ee,ne.minutes=fe,ne.hours=ge,ne.days=he,ne.weeks=Bc,ne.months=ie,ne.years=je,ne.humanize=Fc,ne.toISOString=Gc,ne.toString=Gc,ne.toJSON=Gc,ne.locale=rb,ne.localeData=sb,ne.toIsoString=aa("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Gc),ne.lang=Cd,H("X",0,0,"unix"),H("x",0,0,"valueOf"),N("x",_c),N("X",bd),Q("X",function(a,b,c){c._d=new Date(1e3*parseFloat(a,10))}),Q("x",function(a,b,c){c._d=new Date(q(a))}),a.version="2.10.6",b(Da),a.fn=Od,a.min=Fa,a.max=Ga,a.utc=h,a.unix=Zb,a.months=jc,a.isDate=d,a.locale=w,a.invalid=l,a.duration=Ya,a.isMoment=o,a.weekdays=lc,a.parseZone=$b,a.localeData=y,a.isDuration=Ia,a.monthsShort=kc,a.weekdaysMin=nc,a.defineLocale=x,a.weekdaysShort=mc,a.normalizeUnits=A,a.relativeTimeThreshold=Ec;var oe=a;return oe}); "use strict";YP.MerchantChat=(function($YPCA,window,document){var merchantChat={MERCHANT:null,PICTURES_LIMIT:5,PAGE_SIZE:50,CURRENT_LANGUAGE:"",TIMEOUT_TO_SEND_MESSAGE:300000,LABELS:null,chatMode:"",conversation:null,currentPage:1,hasMorePages:false,loadingMoreMessages:false,_init:function(){if(!YP.Utils.isDevicePhone() & _merchantAcceptMessages()){merchantChat._setCurrentLanguage();merchantChat._setLabels();merchantChat._setLabelPreLoadedElements();merchantChat.MERCHANT=merchantChat._getMerchantIdAndName();merchantChat._createInitialBinds();merchantChat._addMerchantNameToChatBox();if(YP.User.getUserInfo().authenticated){merchantChat._showOrHideSpinnerLoadingMessages();if(merchantChat._hasStoredMessageToBeSent()){merchantChat._sendStoredMessage();}else{merchantChat._getConversation();}merchantChat._cleanChatMode("merchantChat_ChatModeNotLogged");}else{merchantChat._getResponseTimeAndPhoneNumber();merchantChat._cleanChatMode("merchantChat_ChatModeLogged");merchantChat._showOrHideWelcomeMessage();}merchantChat._showChatBoxModeOfCurrentSession();if(merchantChat._isLowResolutionDevice() & & !merchantChat._isPageIsScrolledDown()){merchantChat._showChatBox("icon-only");merchantChat._openChatBoxAfterScrollDown();}}},_merchantAcceptMessages:function(){return($YPCA(".mlr__item.mlr__item--message.hide-print").length>0||$YPCA(".mlr__item.mlr__item--email.hide-print").length>0);},_createInitialBinds:function(){$YPCA(".chat-box-minimized").on('click',function(){merchantChat._showChatBox("open");merchantChat._storeCurrentChatMode("open");});$YPCA(".chat-box-icon").on('click',function(){merchantChat._showChatBox("open");merchantChat._storeCurrentChatMode("open");});$YPCA(".chat-box--btn-minimize").on('click',function(){merchantChat._showChatBox("minimize");merchantChat._storeCurrentChatMode("minimize");});$YPCA(".chat-box--btn-close").on('click',function(){merchantChat._showChatBox("icon-only");merchantChat._storeCurrentChatMode("minimize");});$YPCA(".chat-box--call-cta a").on('click',merchantChat._openOrCloseBoxPhoneNumber);$YPCA("#chat-box--picture-upload").on('change',function(){if($YPCA("#chat-box--picture-upload").val().length>0){merchantChat._uploadPicture();}merchantChat._enableSendButton();});$YPCA(".chat-box--input-message").on('change',function(){merchantChat._enableSendButton();});$YPCA(".chat-box--input-message").on('keyup',function(){merchantChat._enableSendButton();});$YPCA(".chat-box--input-message").on('keypress',function(e){if(e.which===13 & _isThereMessageToBeSent()){merchantChat._showCaptchaSendMessageModal();}});$YPCA(".chat-box--input-send-button").on('click',function(){if(merchantChat._isThereMessageToBeSent()){merchantChat._showCaptchaSendMessageModal();}});$YPCA("#jsModalContainer").on('DOMSubtreeModified',function(){merchantChat._fixChatPositionAfterModal();});$YPCA($YPCA(".action-bar__user a")[0]).on("click",function(){merchantChat._fixChatPositionAfterSideMenu("opened");});$YPCA(".jsCloseUserMenu").on("click",function(){if($YPCA(this).hasClass("jsLogoutBtn")){merchantChat._showChatBox("close");}else{merchantChat._fixChatPositionAfterSideMenu("closed");}});$YPCA(".jsOverlayContainer").on("click",function(){merchantChat._fixChatPositionAfterSideMenu("closed");});$YPCA(".mlr__item.mlr__item--message.hide-print").on("click",function(){merchantChat._showChatBox("icon-only");});window.onbeforeprint=function(){merchantChat._saveOrRestoreChatToPrint("save");};window.onafterprint=function(){merchantChat._saveOrRestoreChatToPrint("restore");};},_setCurrentLanguage:function(){merchantChat.CURRENT_LANGUAGE=YP.Utils.isEnglishSite()?"en":"fr";},_getLabel:function(label,index){var retrievedLabel=merchantChat.LABELS[label];if(index!==undefined){return retrievedLabel[index];}else{return retrievedLabel;}},_setLabelPreLoadedElements:function(){$YPCA(".chat-box--input-send-button").val(merchantChat._getLabel("send"));$YPCA(".chat-box--input-send-button-disabled").val(merchantChat._getLabel("send"));$YPCA(".chat-box--input-message").attr("placeholder",(merchantChat._getLabel("typeAMessage")+"..."));$YPCA(".chat-box--call-cta label").html(merchantChat._getLabel("phoneNumber"));$YPCA(".chat-box-minimized label").html(merchantChat._getLabel("sendAMessage"));},_setLabels:function(){merchantChat.LABELS=JSON.parse($YPCA(".jsMerchantChatConfig").html()).labels;},_getMerchantIdAndName:function(){return{id:JSON.parse($YPCA("#merchant-common-config").html()).merchantId,name:JSON.parse($YPCA("#reviews-config").html()).merchantName};},_addMerchantNameToChatBox:function(){var span=' '+merchantChat.MERCHANT.name+' ';$YPCA(".chat-box--header").prepend(span);},_showChatBox:function(option){switch(option){case"open":$YPCA(".chat-box-minimized").hide();$YPCA(".chat-box").show();$YPCA(".chat-box-icon").hide();break;case"minimize":$YPCA(".chat-box-minimized").show();$YPCA(".chat-box").hide();$YPCA(".chat-box-icon").hide();break;case"close":$YPCA(".chat-box-minimized").hide();$YPCA(".chat-box").hide();$YPCA(".chat-box-icon").hide();break;case"icon-only":$YPCA(".chat-box-minimized").hide();$YPCA(".chat-box").hide();$YPCA(".chat-box-icon").show();break;default:throw"Not a valid option";}},_getAppropriateStorageProperty:function(){var userLoggedIn=YP.User.getUserInfo().authenticated;var storageProperty;if(userLoggedIn){storageProperty="merchantChat_ChatModeLogged";}else{storageProperty="merchantChat_ChatModeNotLogged";}return storageProperty;},_storeCurrentChatMode:function(option){var storageProperty=merchantChat._getAppropriateStorageProperty();localStorage.setItem(storageProperty,option);},_restoreCurrentChatMode:function(){var storageProperty=merchantChat._getAppropriateStorageProperty();if(storageProperty==="merchantChat_ChatModeNotLogged"){localStorage.removeItem("merchantChat_ChatModeLogged");}else{localStorage.removeItem("merchantChat_ChatModeNotLogged");}return localStorage.getItem(storageProperty);},_cleanChatMode:function(storageProperty){localStorage.removeItem(storageProperty);},_showChatBoxModeOfCurrentSession:function(){var modeOfSession=merchantChat._restoreCurrentChatMode();if(modeOfSession!==null){merchantChat._showChatBox(modeOfSession);}else{merchantChat._showChatBox("open");}},_fixChatPositionAfterModal:function(){if($YPCA("#jsModalContainer").html().length>0){var bottomValue=-$YPCA(window).scrollTop();$YPCA(".chat-box").css("bottom",(bottomValue+"px"));$YPCA(".chat-box-minimized").css("bottom",((bottomValue+3)+"px"));$YPCA(".chat-box-icon").css("bottom",((bottomValue+3)+"px"));}else{$YPCA(".chat-box").css("bottom","0px");$YPCA(".chat-box-minimized").css("bottom","3px");$YPCA(".chat-box-icon").css("bottom","3px");}},_fixChatPositionAfterSideMenu:function(option){if(option==="opened"){var bottomValue=-$YPCA(window).scrollTop();$YPCA(".chat-box").css("bottom",(bottomValue+"px"));$YPCA(".chat-box-minimized").css("bottom",((bottomValue+3)+"px"));}else if(option==="closed"){$YPCA(".chat-box").css("bottom","0px");$YPCA(".chat-box-minimized").css("bottom","3px");}},_showOrHideSpinnerLoadingMessages:function(){if($YPCA(".chat-box--loading-messages").css("display")==="none"){$YPCA(".chat-box--loading-messages").css("display","flex");}else{$YPCA(".chat-box--loading-messages").css("display","none");}},_getConversation:function(){$YPCA.ajax({url:"/ajax/messagesPopUp",type:"POST",contentType:"application/json",data:JSON.stringify({pg:merchantChat.currentPage,count:merchantChat.PAGE_SIZE,merchantId:merchantChat.MERCHANT.id,conversationId:""}),success:function(res){merchantChat._showOrHideSpinnerLoadingMessages();if(res.length!==0){var resObj=JSON.parse(res);if(resObj.items.length>0){merchantChat.conversation=resObj;merchantChat._createResponseTime(merchantChat.conversation.messagingResponseTimeDelegate.responseTime);if(merchantChat.conversation.messagingResponseTimeDelegate.showCallCta){merchantChat._showCallCta(merchantChat.conversation.messagingResponseTimeDelegate.phoneNumber.displayNumber);}if(merchantChat.conversation.items.length>0){merchantChat._createConversation();merchantChat._scrollDownMessages();merchantChat._scrollDownMessagesAfterLoadPictures();if(merchantChat.conversation.items.length===merchantChat.PAGE_SIZE){merchantChat._checkIfhasMorePages();}}}else{merchantChat._getResponseTimeAndPhoneNumber();merchantChat._showOrHideWelcomeMessage();}}else{merchantChat._getResponseTimeAndPhoneNumber();}}});},_getConversationNextPage:function(){if(!merchantChat.loadingMoreMessages){merchantChat.loadingMoreMessages=true;merchantChat.currentPage++;$YPCA.ajax({url:"/ajax/messagesPopUp",type:"POST",contentType:"application/json",data:JSON.stringify({pg:merchantChat.currentPage,count:merchantChat.PAGE_SIZE,merchantId:merchantChat.MERCHANT.id,conversationId:""}),success:function(res){merchantChat.loadingMoreMessages=false;var oldConversation=JSON.parse(res);merchantChat._createOldConversation(oldConversation);merchantChat._checkIfhasMorePages();}});}},_checkIfhasMorePages:function(){$YPCA.ajax({url:"/ajax/messagesPopUp",type:"POST",contentType:"application/json",data:JSON.stringify({pg:merchantChat.currentPage+1,count:1,merchantId:merchantChat.MERCHANT.id,conversationId:""}),success:function(res){var conversationNextPage=JSON.parse(res);if(conversationNextPage.items.length===1){merchantChat._createLoadMoreMessagesListener();merchantChat._showOrHideLoadingMoreMessagesSpinner("show");}else{merchantChat.hasMorePages=false;merchantChat._createLoadMoreMessagesListener(true);}}});},_createLoadMoreMessagesListener:function(turnOff){$YPCA(".chat-box--messages").off("scroll");if(turnOff===undefined||turnOff===false){$YPCA(".chat-box--messages").scroll(function(){if($YPCA(".chat-box--messages").scrollTop()===0){merchantChat._getConversationNextPage();}});}},_getResponseTimeAndPhoneNumber:function(){$YPCA.ajax({url:"/ajax/messaging/merchantChatMessageDialog",type:"GET",contentType:"application/json",data:{id:merchantChat.MERCHANT.id},success:function(res){var resObj=JSON.parse(res);merchantChat._createResponseTime(resObj.messagingResponseTimeDelegate.responseTime);if(resObj.messagingResponseTimeDelegate.showCallCta){merchantChat._showCallCta(resObj.messagingResponseTimeDelegate.phoneNumber.displayNumber);}}});},_showOrHideLoadingMoreMessagesSpinner:function(option){if(option==="hide"){$YPCA(".chat-box--loading-more-messages").remove();}else{var divSpinner=' Loading more results... ';$YPCA(".chat-box--messages").prepend(divSpinner);}},_showOrHideWelcomeMessage:function(option){var divMessages=$YPCA(".chat-box--messages");if(option==="hide"){var divWelcomeMessage=$YPCA(".chat-box--welcome-message");divWelcomeMessage.remove();divMessages.css("position","static");}else{var divWelcomeMessageContent='';divWelcomeMessageContent+=' ';divWelcomeMessageContent+=merchantChat._getLabel("welcomeMessage");divWelcomeMessageContent+=' ';divMessages.css("position","relative");divMessages.append(divWelcomeMessageContent);}},_scrollDownMessages:function(){$YPCA(".chat-box--messages").scrollTop($YPCA(".chat-box--messages")[0].scrollHeight);},_scrollDownMessagesAfterLoadPictures:function(){$YPCA(".chat-box--messages img").on("load",function(){merchantChat._scrollDownMessages();});},_createResponseTime:function(responseTimeMessage){var divContent='';divContent+=' ';divContent+='   ';divContent+=responseTimeMessage;divContent+=' ';$YPCA(".chat-box--response-time").html(divContent);},_showCallCta:function(displayNumber){$YPCA(".chat-box--call-cta li li").html(displayNumber);$YPCA(".chat-box--call-cta").css('display','flex');},_openOrCloseBoxPhoneNumber:function(){if($YPCA(".chat-box--call-cta ul li ul").css('display')==="none"){$YPCA(".chat-box--call-cta ul li ul").show();$YPCA(".chat-box--call-cta a").hover(function(e){if(e.type==="mouseenter"){$YPCA(".chat-box--call-cta a").css("background","#ffcd00");$YPCA(".chat-box--call-cta a").css('border-color','#ffcd00');}else{$YPCA(".chat-box--call-cta a").css("background","#ffcd00");$YPCA(".chat-box--call-cta a").css('border-color','#ffcd00');}});}else{$YPCA(".chat-box--call-cta ul li ul").hide();$YPCA(".chat-box--call-cta a").hover(function(e){if(e.type==="mouseenter"){$YPCA(".chat-box--call-cta a").css("background","#ffcd00");$YPCA(".chat-box--call-cta a").css('border-color','#ffcd00');}else{$YPCA(".chat-box--call-cta a").css('background','#fff');$YPCA(".chat-box--call-cta a").css('border-color','#c4c4c4');}});}},_createConversation:function(){var divConversation='';for(var i=0;i ';var divText='';var divPictures='';var divDate='';if(message.owner){divText+='   ';divText+='     ';divPictures+='   ';divDate+='   ';}else{divText+='   ';divText+='     ';divPictures+='   ';divDate+='   ';}if(message.imageContent.length>0){var divPicture='';for(var i=0;i ';divPicture+='   ';divMessage+=divPicture;}}if(message.textContent.length>0){divText+='     ';divText+='       '+message.textContent+' ';divText+='     ';divText+='   ';divMessage+=divText;}divDate+=message.createdAt;divDate+='   ';divMessage+=divDate;divMessage+=' ';return divMessage;},_createOldConversation:function(oldConversation){$YPCA($YPCA(".chat-box--messages div")[0]).attr("id","first-message-of-last-page");var divsOldConversation='';for(var i=0;i ';divPicture+='   ';divPicture+='   X ';divPicture+=' ';$YPCA(".chat-box--pictures").append(divPicture);merchantChat._checkPicturesLimit();var pictureDeleteButton="[data-chat-box-picture-id="+id+"] div";$YPCA(pictureDeleteButton).on('click',function(){merchantChat._deletePictureHtml(id);});merchantChat._showChatBoxPictures(true);},_deletePictureHtml:function(id){var pictureDiv='[data-chat-box-picture-id="'+id+'"]';$YPCA(pictureDiv).remove();merchantChat._checkPicturesLimit();merchantChat._enableSendButton();if($YPCA(".chat-box--pictures img").length===0){merchantChat._showChatBoxPictures(false);}},_showChatBoxPictures:function(option){if(option){$YPCA(".chat-box--pictures").css('display','flex');}else{$YPCA(".chat-box--pictures").css('display','none');}},_checkPicturesLimit:function(){if($YPCA(".chat-box--pictures img").length>=merchantChat.PICTURES_LIMIT){$YPCA(".chat-box--picture-upload-icon").css('opacity','0.5');$YPCA(".chat-box--picture-upload-icon").css('cursor','not-allowed');$YPCA(".chat-box--input label").attr("for","");}else{$YPCA(".chat-box--picture-upload-icon").css('opacity','1');$YPCA(".chat-box--picture-upload-icon").css('cursor','pointer');$YPCA(".chat-box--input label").attr("for","chat-box--picture-upload");}},_enableSendButton:function(){if(merchantChat._isThereMessageToBeSent()){$YPCA(".chat-box--input-send-button").show();$YPCA(".chat-box--input-send-button-disabled").hide();}else{$YPCA(".chat-box--input-send-button").hide();$YPCA(".chat-box--input-send-button-disabled").show();}},_isThereMessageToBeSent:function(){return($YPCA("#chat-box--picture-upload").val().length>0||$YPCA(".chat-box--pictures img").length!==0||$YPCA(".chat-box--input-message").val().length!==0);},_saveOrRestoreChatToPrint:function(option){if(option==="save"){if($YPCA(".chat-box-minimized").css('display')==="none"){if($YPCA(".chat-box").css('display')==="none"){if($YPCA(".chat-box-icon").css('display')==="none"){merchantChat.chatMode="closed";}else{merchantChat.chatMode="icon-only";merchantChat._showChatBox("close");}}else{merchantChat.chatMode="opened";merchantChat._showChatBox("close");}}else{merchantChat.chatMode="minimized";merchantChat._showChatBox("close");}}else{switch(merchantChat.chatMode){case"opened":merchantChat._showChatBox("open");break;case"minimized":merchantChat._showChatBox("minimize");break;case"icon-only":merchantChat._showChatBox("icon-only");break;default:throw"Not a valid mode";}}},_showCaptchaSendMessageModal:function(){YP.Modal.show("#jsModalContainer","/ajax/captchaModal",function(){$YPCA(document).off('click','.jsBtnSendSms');$YPCA('.jsBtnSendSms').on("click",function(){if($YPCA('.g-recaptcha-response').length!==0 & & $YPCA('.g-recaptcha-response').val().length>0){localStorage.setItem("merchantChat_captcha",$YPCA('.g-recaptcha-response').val());$YPCA("#captchaModal").modal("hide");merchantChat._sendMessage();}else{$YPCA(".captcha iframe").css("border","1px solid #ee4036");$YPCA(".captcha .errorCaptca").css("background-color","#ee4036");$YPCA(".captcha .errorCaptca").css("border-radius","0 0 3px 3px");$YPCA(".captcha .errorCaptca").css("color","#fff");$YPCA(".captcha .errorCaptca").css("display","block");$YPCA(".captcha .errorCaptca").css("font-size","11px");$YPCA(".captcha .errorCaptca").css("padding","10px");$YPCA(".captcha .errorCaptca").css("width","304px");}});});},_showLoginModal:function(){YP.Modal.show("#jsModalContainer","/ajax/user/signin",function(){$YPCA.subscribeOnce('LoginProcessCompletedEvent',merchantChat._storeMessageToBeSent);});},_sendMessage:function(){if(YP.User.getUserInfo().authenticated){merchantChat._addNotConfirmedMessage();merchantChat._sendMessageAjax();merchantChat._cleanInputs();merchantChat._enableSendButton();}else{merchantChat._showChatBox("close");merchantChat._showLoginModal();$YPCA("#ypModal").on('hidden.bs.modal',function(){merchantChat._showChatBox("open");});}},_cleanInputs:function(){$YPCA(".chat-box--input-message").val("");$YPCA(".chat-box--pictures").html("");merchantChat._showChatBoxPictures(false);},_addNotConfirmedMessage:function(){merchantChat._showOrHideWelcomeMessage("hide");var divNotConfirmedMessage='';divNotConfirmedMessage+=' ';var picturesLength=$YPCA("[data-chat-box-picture-id]").length;var pictureId;var pictureUrl;for(var i=0;i ';divNotConfirmedMessage+='     ';divNotConfirmedMessage+='   ';}var textMessage=$YPCA(".chat-box--input-message").val();if(textMessage.length>0){divNotConfirmedMessage+='   ';divNotConfirmedMessage+='     ';divNotConfirmedMessage+='     ';divNotConfirmedMessage+='       '+textMessage+' ';divNotConfirmedMessage+='     ';divNotConfirmedMessage+='   ';}divNotConfirmedMessage+='   ';divNotConfirmedMessage+='     '+merchantChat._getLabel("sending");divNotConfirmedMessage+='   ';divNotConfirmedMessage+=' ';$YPCA(".chat-box--messages").append(divNotConfirmedMessage);merchantChat._scrollDownMessages();},_confirmMessage:function(){var oldestMessageNotConfirmed=$YPCA($YPCA(".ypicon.ypicon-circle-o-notch.ypicon--spin.chat-box--spinner-sending-message")[0]).parent();oldestMessageNotConfirmed.html(merchantChat._formatDateToMessage(new Date()));},_formatDateToMessage:function(date){var formattedDate="";var month=merchantChat._getLabel("months",date.getMonth());if(merchantChat.CURRENT_LANGUAGE==="en"){formattedDate+=month;formattedDate+=" ";formattedDate+=date.getDate() < 10?'0'+date.getDate():date.getDate();formattedDate+=", ";formattedDate+=date.getFullYear();formattedDate+=" ";if(date.getHours() < 10){formattedDate+='0'+date.getHours();}else{if(date.getHours() < =12){formattedDate+=date.getHours();}else{if(date.getHours() < =20){formattedDate+='0'+(date.getHours()-12);}else{formattedDate+=(date.getHours()-12);}}}formattedDate+=":";formattedDate+=date.getMinutes() < 10?'0'+date.getMinutes():date.getMinutes();formattedDate+=" ";formattedDate+=date.getHours() < 12?"AM":"PM";}else{formattedDate+=date.getDate() < 10?'0'+date.getDate():date.getDate();formattedDate+=" ";formattedDate+=month.toLowerCase();formattedDate+=" ";formattedDate+=date.getFullYear();formattedDate+=" ";formattedDate+=date.getHours() < 10?'0'+date.getHours():date.getHours();formattedDate+=":";formattedDate+=date.getMinutes() < 10?'0'+date.getMinutes():date.getMinutes();}return formattedDate;},_sendMessageAjax:function(){var urlMessage;var message;if(merchantChat.conversation!==null){message=merchantChat._createMessageToBeSent();urlMessage="/ajax/messaging/sendMessage";}else{message=merchantChat._createMessageToBeSent("firstMessage");urlMessage="/ajax/messaging/firstMessage?lang=";urlMessage+=merchantChat.CURRENT_LANGUAGE;urlMessage+=" =";urlMessage+=localStorage.getItem("merchantChat_captcha");merchantChat._validateAndFixMessageWithFirstAndLastName(message);}$YPCA.ajax({url:urlMessage,type:"POST",contentType:"application/json",data:JSON.stringify(message),success:function(res){if(res.success){if(res.code===0){merchantChat._confirmMessage();}else if(res.code===1){merchantChat._getConversation();}}}});},_validateAndFixMessageWithFirstAndLastName:function(messageObject){if(messageObject.firstName.length===0||messageObject.lastName.length===0){messageObject.firstName=YP.User.getUserInfo().displayname;messageObject.lastName=YP.User.getUserInfo().displayname;}},_createMessageToBeSent:function(option){var messageObject={visitorId:ypdad.getVisitorId()};if(option!=="firstMessage"){messageObject.conversationId=merchantChat.conversation.conversationId;}else{messageObject.copy=false;messageObject.firstName=YP.User.getUserInfo().firstName;messageObject.lastName=YP.User.getUserInfo().lastName;messageObject.merchantId=merchantChat.MERCHANT.id;messageObject.userEmail=YP.User.getUserInfo().email;}var textMessage=$YPCA(".chat-box--input-message").val();messageObject.message=textMessage;var pictureElements=$YPCA("[data-chat-box-picture-id]");if(pictureElements.length>0){messageObject.imageIds=[];var pictureId;for(var i=0;i < =(new Date(storedObject.createdAt).getTime()+merchantChat.TIMEOUT_TO_SEND_MESSAGE);}else{return false;}},_storeMessageToBeSent:function(){var messageObject={message:$YPCA(".chat-box--input-message").val()};var pictureElements=$YPCA("[data-chat-box-picture-id]");if(pictureElements.length>0){messageObject.imageIds=[];var pictureId;for(var i=0;i 0){var resObj=JSON.parse(res);if(resObj.conversationId!==""){storedMessage.message.conversationId=resObj.conversationId;urlMessage="/ajax/messaging/sendMessage";}else{storedMessage.message.copy=false;storedMessage.message.firstName=YP.User.getUserInfo().firstName;storedMessage.message.lastName=YP.User.getUserInfo().lastName;storedMessage.message.merchantId=merchantChat.MERCHANT.id;storedMessage.message.userEmail=YP.User.getUserInfo().email;urlMessage="/ajax/messaging/firstMessage?lang=";urlMessage+=merchantChat.CURRENT_LANGUAGE;urlMessage+=" =";urlMessage+=localStorage.getItem("merchantChat_captcha");merchantChat._validateAndFixMessageWithFirstAndLastName(storedMessage.message);}}$YPCA.ajax({url:urlMessage,type:"POST",contentType:"application/json",data:JSON.stringify(storedMessage.message),success:function(){merchantChat._deleteStoredMessage();merchantChat._getConversation();}});}});},_isLowResolutionDevice:function(){return $YPCA(window).height() < 900;},_isPageIsScrolledDown:function(){return $YPCA(window).scrollTop()>350;},_openChatBoxAfterScrollDown:function(){$YPCA(document).on('scroll',function(){if($YPCA(window).scrollTop()>350){$YPCA(document).off('scroll');merchantChat._showChatBox("open");}});$YPCA(".chat-box-icon").on('click',function(){$YPCA(document).off('scroll');});}};$YPCA(function(){if($YPCA(".jsMerchantChatConfig").length>0){merchantChat._init();}});})($YPCA,window,document); .imageReviewSlider{width:100%;height:100%;background-color:rgba(0,0,0,.8);display:block;position:fixed;top:0;right:0;z-index:9999}.imageReviewSlider img{max-width:95%;max-height:90%;height:auto;object-fit:cover;display:block;position:absolute;top:50%;left:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.imageReviewSlider .close-slider{position:absolute;color:#fff;font-size:1.5em;top:.1em;right:.2em;padding:.7em;font-family:yp-icons;background-color:unset}.imageReviewSlider .close-slider:after{content:'\e63c'}.imageReviewSlider .arrows{position:absolute;top:50%;-ms-transform:translateY(-50%);transform:translateY(-50%);color:#fff;font-family:yp-icons;font-weight:700;padding:7% 1%;font-size:2.5em;background-color:unset;z-index:100;text-shadow:0 0 5px #585858}.imageReviewSlider .arrows.arr-left{left:0}.imageReviewSlider .arrows.arr-left:after{content:'\e672'}.imageReviewSlider .arrows.arr-right{right:0}.imageReviewSlider .arrows.arr-right:after{content:'\e671'}.imageReviewSlider section{position:absolute;top:.7em;left:1em}.imageReviewSlider section .circleCounter{border-radius:50%;border:1px solid #fff;width:13px;height:13px;display:inline-block;margin-right:3px;box-shadow:0 0 3px 3px #333}.imageReviewSlider section .circleCounter .currentCircle{background-color:#fff;border-radius:50%;width:9px;height:9px;display:block;margin:1px}@media (max-width:1024px){.chat-box,.chat-box-icon,.chat-box-minimized{display:none!important}}.chat-box-minimized{display:none;position:fixed;padding:10px;bottom:3px;right:110px;background:#000;border:1px solid #c4c4c4;border-radius:3px;color:#ffcd00;font-weight:bolder;cursor:pointer;-webkit-user-select:none;-ms-user-select:none;user-select:none;z-index:155}.chat-box-minimized span:first-child:before{content:'\e904';margin-right:10px}.chat-box-minimized label{cursor:pointer}.chat-box-icon{position:fixed;padding:5px 10px;bottom:3px;right:110px;background:#000;border:1px solid #c4c4c4;border-radius:50%;color:#ffcd00;font-weight:bolder;cursor:pointer;-webkit-user-select:none;-ms-user-select:none;user-select:none;z-index:155}.chat-box-icon span:first-child:before{content:'\e904'}.chat-box{display:none;position:fixed;bottom:0;right:110px;width:284px;background:#fff;border-top:1px solid #c4c4c4;border-left:1px solid #c4c4c4;border-right:1px solid #c4c4c4;border-radius:5px 5px 0 0;z-index:155}.chat-box--header{background:#000;border-radius:5px 5px 0 0;padding:5px;font-weight:bolder;color:#ffcd00;cursor:pointer;height:33px}.chat-box--header span:first-child{margin-top:2px;max-width:210px;display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chat-box--header span:nth-child(2):before{content:'\e63c';float:right;font-size:1em;padding-left:10px}.chat-box--header span:last-child:before{padding:0 10px;content:'\e910';float:right;font-size:1em}.chat-box--response-time{border-bottom:1px solid #ddd;color:#444;text-align:center}.chat-box--response-time div{font-size:.9em;padding:5px}.chat-box--response-time span{margin-right:5px}.chat-box--response-time span:after{content:'\e662'}.chat-box--call-cta{display:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;font-size:12px;padding:10px;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;background:#f8f8f8}.chat-box--call-cta span{margin-right:5px}.chat-box--call-cta label{cursor:pointer}.chat-box--call-cta a{padding:10px;background:#fff;text-decoration:none;border-radius:3px;border:1px solid #c4c4c4;font-weight:600;cursor:pointer;transition:background .3s ease}.chat-box--call-cta a:hover{background:#ffcd00;border-color:#ffcd00}.chat-box--call-cta a:after{content:'';width:0;height:0;border:3px solid transparent;border-top-color:#333;margin-left:5px;display:inline-block}.chat-box--call-cta a span{border-radius:20px;padding:5px}.chat-box--call-cta ul li ul{display:none}.chat-box--call-cta ul li ul li{width:110px;z-index:20;background:#fff;padding:10px;border:1px solid #ffcd00;font-size:12px;position:absolute;margin-top:6px}.chat-box--call-cta ul li ul li:hover{background:#f8f8f8}.chat-box--messages{height:247px;overflow-y:scroll}.chat-box--messages>div{margin-top:10px}.chat-box--loading-messages{margin-top:0!important;display:none;height:100%;font-size:30px;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.chat-box--loading-more-messages{position:relative;font-style:italic;font-size:11px;display:block;text-align:center;text-decoration:underline}.chat-box--loading-more-messages:before{background:transparent url(//static.yellowpages.ca/ypca/ypui-6.12.0.0-20191210.1342/resources/images/loader.gif);width:24px;height:24px;content:'';display:block;margin:5px auto}.chat-box--welcome-message{position:absolute;bottom:3px;margin-left:10px;font-weight:300}.chat-box--message-date-sent{color:#adafaf;text-align:right;font-size:11px;margin-right:10px}.chat-box--message-date-received{color:#adafaf;text-align:left;font-size:11px;margin-left:10px}.chat-box--message-text{display:-ms-flexbox;display:flex;margin:0 5px;border-radius:5px;word-break:break-word}.chat-box--message-image-sent{text-align:right;margin-right:10px}.chat-box--message-image-received{text-align:left;margin-left:10px}.chat-box--message-image{max-width:150px;border:1px solid #ddd;border-radius:3px}.chat-box--message-sent{-ms-flex-direction:row-reverse;flex-direction:row-reverse;text-align:right;color:#fff}.chat-box--message-sent div:last-child{background:#00aabc;padding:5px;border-radius:5px;max-width:233px}.chat-box--message-received div:last-child{background:#eee;padding:5px;border-radius:5px;max-width:233px}.chat-box--message-triangle{-webkit-clip-path:polygon(0 85%,100% 60%,0 35%);clip-path:polygon(0 85%,100% 60%,0 35%);width:6px;height:24px;background:#00aabc}.chat-box--message-triangle-reverse{-webkit-clip-path:polygon(100% 85%,0 60%,100% 35%);clip-path:polygon(100% 85%,0 60%,100% 35%);width:6px;height:24px;background:#eee}.chat-box--spinner-sending-message{margin-right:2px}.chat-box--input{padding:10px;border-top:1px solid #c4c4c4;display:-ms-flexbox;display:flex}.chat-box--input input{padding:5px;border:none;border-top:1px solid #6e6c6c;border-right:1px solid #6e6c6c;border-bottom:1px solid #6e6c6c}.chat-box--input input:-ms-input-placeholder{color:#6e6c6c}.chat-box--input input::placeholder{color:#6e6c6c}.chat-box--input input:focus{outline:0}.chat-box--input-message{color:#333;width:77%;font-size:13px}.chat-box--input-send-button{border:none!important;font-weight:600;width:23%;color:#333;background:#ffcd00;cursor:pointer;opacity:1;margin-left:10px}.chat-box--input-send-button-disabled{border:none!important;font-weight:600;width:23%;color:#333;background:#ffcd00;cursor:not-allowed;opacity:.5;margin-left:10px}#chat-box--picture-upload{display:none}.chat-box--picture-upload-icon{border:1px solid #6e6c6c;font-size:24px;padding:5px 9px;cursor:pointer}.chat-box--pictures{display:none;padding:10px 0 0 10px;border-top:1px solid #f3f3f3}.chat-box--pictures img{max-width:60px;max-height:60px;border:1px solid #ddd;border-radius:3px;margin-right:10px}.chat-box--pictures div{position:relative}.chat-box--pictures div div{position:absolute;right:15px;top:5px;background:#fff;border:#aaa 1px solid;border-radius:10px;width:20px;height:20px;text-align:center;color:#aaa;cursor:pointer} (function(f){if(typeof exports==="object" &  module!=="undefined"){module.exports=f()}else if(typeof define==="function" & ){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Clipboard=f()}})(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function" & if(!u & )return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function" & for(var o=0;o 0 & [0]!==undefined?arguments[0]:{};this.action=options.action;this.emitter=options.emitter;this.target=options.target;this.text=options.text;this.trigger=options.trigger;this.selectedText='';}},{key:'initSelection',value:function initSelection(){if(this.text){this.selectFake();}else if(this.target){this.selectTarget();}}},{key:'selectFake',value:function selectFake(){var _this=this;var isRTL=document.documentElement.getAttribute('dir')=='rtl';this.removeFake();this.fakeHandlerCallback=function(){return _this.removeFake();};this.fakeHandler=document.body.addEventListener('click',this.fakeHandlerCallback)||true;this.fakeElem=document.createElement('textarea');this.fakeElem.style.fontSize='12pt';this.fakeElem.style.border='0';this.fakeElem.style.padding='0';this.fakeElem.style.margin='0';this.fakeElem.style.position='absolute';this.fakeElem.style[isRTL?'right':'left']='-9999px';var yPosition=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.addEventListener('focus',window.scrollTo(0,yPosition));this.fakeElem.style.top=yPosition+'px';this.fakeElem.setAttribute('readonly','');this.fakeElem.value=this.text;document.body.appendChild(this.fakeElem);this.selectedText=(0,_select2.default)(this.fakeElem);this.copyText();}},{key:'removeFake',value:function removeFake(){if(this.fakeHandler){document.body.removeEventListener('click',this.fakeHandlerCallback);this.fakeHandler=null;this.fakeHandlerCallback=null;}if(this.fakeElem){document.body.removeChild(this.fakeElem);this.fakeElem=null;}}},{key:'selectTarget',value:function selectTarget(){this.selectedText=(0,_select2.default)(this.target);this.copyText();}},{key:'copyText',value:function copyText(){var succeeded=void 0;try{succeeded=document.execCommand(this.action);}catch(err){succeeded=false;}this.handleResult(succeeded);}},{key:'handleResult',value:function handleResult(succeeded){this.emitter.emit(succeeded?'success':'error',{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)});}},{key:'clearSelection',value:function clearSelection(){if(this.target){this.target.blur();}window.getSelection().removeAllRanges();}},{key:'destroy',value:function destroy(){this.removeFake();}},{key:'action',set:function set(){var action=arguments.length>0 & [0]!==undefined?arguments[0]:'copy';this._action=action;if(this._action!=='copy' & _action!=='cut'){throw new Error('Invalid "action" value, use either "copy" or "cut"');}},get:function get(){return this._action;}},{key:'target',set:function set(target){if(target!==undefined){if(target & & (typeof target==='undefined'?'undefined':_typeof(target))==='object' & ===1){if(this.action==='copy' & ('disabled')){throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');}if(this.action==='cut' & & (target.hasAttribute('readonly')||target.hasAttribute('disabled'))){throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');}this._target=target;}else{throw new Error('Invalid "target" value, use a valid Element');}}},get:function get(){return this._target;}}]);return ClipboardAction;}();module.exports=ClipboardAction;});},{"select":5}],8:[function(require,module,exports){(function(global,factory){if(typeof define==="function" & ){define(['module','./clipboard-action','tiny-emitter','good-listener'],factory);}else if(typeof exports!=="undefined"){factory(module,require('./clipboard-action'),require('tiny-emitter'),require('good-listener'));}else{var mod={exports:{}};factory(mod,global.clipboardAction,global.tinyEmitter,global.goodListener);global.clipboard=mod.exports;}})(this,function(module,_clipboardAction,_tinyEmitter,_goodListener){'use strict';var _clipboardAction2=_interopRequireDefault(_clipboardAction);var _tinyEmitter2=_interopRequireDefault(_tinyEmitter);var _goodListener2=_interopRequireDefault(_goodListener);function _interopRequireDefault(obj){return obj & __esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i 0 & [0]!==undefined?arguments[0]:{};this.action=typeof options.action==='function'?options.action:this.defaultAction;this.target=typeof options.target==='function'?options.target:this.defaultTarget;this.text=typeof options.text==='function'?options.text:this.defaultText;}},{key:'listenClick',value:function listenClick(trigger){var _this2=this;this.listener=(0,_goodListener2.default)(trigger,'click',function(e){return _this2.onClick(e);});}},{key:'onClick',value:function onClick(e){var trigger=e.delegateTarget||e.currentTarget;if(this.clipboardAction){this.clipboardAction=null;}this.clipboardAction=new _clipboardAction2.default({action:this.action(trigger),target:this.target(trigger),text:this.text(trigger),trigger:trigger,emitter:this});}},{key:'defaultAction',value:function defaultAction(trigger){return getAttributeValue('action',trigger);}},{key:'defaultTarget',value:function defaultTarget(trigger){var selector=getAttributeValue('target',trigger);if(selector){return document.querySelector(selector);}}},{key:'defaultText',value:function defaultText(trigger){return getAttributeValue('text',trigger);}},{key:'destroy',value:function destroy(){this.listener.destroy();if(this.clipboardAction){this.clipboardAction.destroy();this.clipboardAction=null;}}}]);return Clipboard;}(_tinyEmitter2.default);function getAttributeValue(suffix,element){var attribute='data-clipboard-'+suffix;if(!element.hasAttribute(attribute)){return;}return element.getAttribute(attribute);}module.exports=Clipboard;});},{"./clipboard-action":7,"good-listener":4,"tiny-emitter":6}]},{},[8])(8)});"use strict";YPCA.Utils.namespace('YPCA.Maps.serpProperties');YPCA.Maps.serpProperties={activateListElement:function(data){var index=YP.Utils.getMapProvider()==='osm'?data.index:data.index+1,pinType=data.pinType;$YPCA('.jsListElement').removeClass('active');if(typeof index!=='undefined' & ==='enum'){$YPCA('.jsListElement[data-pin-number='+index+']').addClass('active');}},highlightListElement:function(obj){var index=obj.index;$YPCA('.jsListElement').removeClass('selected');if(typeof index!=='undefined'){$YPCA('[data-pin-number='+(index+1)+']').addClass('selected');}},fillResultList:function(html,source){$YPCA('.jsResultsList').html(html);$YPCA('.mainContainer').animate({scrollTop:0},500);YPCA.publish('List/Set');YPCA.Analytics.triggerPageView('analytics-resource',$YPCA(source).data('ajaxpage'));$YPCA(".jsListContainer").scrollTop(0);}};$YPCA('body:not(.sympatico.ypg_dealers) .jsResultsList').on('click','.jsPagination a',function(e){var url,urlParam=YPCA.Utils.isDefined(YPCA.Utils.urlParamHash('expandMap'))?' ='+YPCA.Utils.urlParamHash('expandMap'):'';YPCA.Maps.osm.removeOpenMapBubble();e.preventDefault();url=e.currentTarget.href+urlParam;if(url.indexOf('?')===-1){url=url.replace(' & ','?');}YP.Serp.fetchMoreSerp(url,function(html){YPCA.Maps.serpProperties.fillResultList(html,e.currentTarget);});});"use strict";YPCA.Utils.namespace('YPCA.Maps.serpProperties');YPCA.Maps.serpProperties.initListEvents=function(d){var data=d.data,$pageConfig=$YPCA('#page-configuration-resource'),pageConfig=JSON.parse($pageConfig.html()),markers=d.markers;$YPCA('.jsListElement').each(function(){var dataPinNumber=markers.length+1-$YPCA(this).data('pin-number');if(dataPinNumber!==-1){$YPCA(this).on('mouseenter',function(e){if(YP.Utils.isDefined(data[dataPinNumber-1])){markers[dataPinNumber-1].fireEvent('mouseover',data[dataPinNumber-1]);}});$YPCA(this).on('mouseleave',function(e){if(YP.Utils.isDefined(data[dataPinNumber-1])){markers[dataPinNumber-1].fireEvent('mouseout',data[dataPinNumber-1]);}});$YPCA(this).on('click',function(e){if(pageConfig.mapSearch===true){if($YPCA(e.target).is('div') & (data[dataPinNumber-1])){markers[dataPinNumber-1].fireEvent('click',data[dataPinNumber-1]);}}else{window.location.href=$YPCA(this).find('.listing__name .jsListingName').attr('href');}});}});};$YPCA(function(){YPCA.subscribe('Map/Marker/Primary/Closed',YPCA.Maps.serpProperties.highlightListElement,YPCA.Maps);YPCA.subscribe('Map/Marker/Hovered',YPCA.Maps.serpProperties.activateListElement,YPCA.Maps);YPCA.subscribe('Map/Marker/Exited',YPCA.Maps.serpProperties.activateListElement,YPCA.Maps);YPCA.subscribe('Map/Marker/Primary/Clicked',YPCA.Maps.serpProperties.highlightListElement,YPCA.Maps);YPCA.subscribe('Map/Markers/Primary/Set',YPCA.Maps.serpProperties.initListEvents,YPCA.Maps);});"use strict";YP.Favourites=(function($YPCA){var favourites={settings:{},_init:function(){favourites._addRemoveToFavMerchandPage();favourites._eventsFavFavouritePage();favourites._addEventListeners();YP.Common.tooltipInit()},_addEventListeners:function(){$YPCA(document).on('User/LogOut',function(){$YPCA('.jsMerchantFav .jsBtnFav').removeClass("btn-addtofav");});},_addRemoveToFavMerchandPage:function(){$YPCA(document).on('click','.jsBtnFav',function(e){e.preventDefault();var $btn=$YPCA(this);if(!YP.Yid.isAuthenticated() & ($btn.data('analytics-step1'))){YPCA.Analytics.clicks($btn,$btn.data('analytics-step1'));}YP.Yid.login(function(loginStatus){favourites.publicFunctions.setFavourite($btn,$btn.data('analytics-confirm'),loginStatus.isSignUpAutologin);},'FAVOURITE');});},_eventsFavFavouritePage:function(){$YPCA('.jsDeleteFav').click(function(e){e.preventDefault();e.stopPropagation();favourites._removeFavFavouritePage($YPCA(this));});},_removeFavFavouritePage:function($elem){$YPCA.ajax({type:"POST",url:$elem.attr("href"),success:function(data){$elem.closest(".listing").addClass('listing--removed');},contentType:"application/json"});},_listener:function(){$YPCA(document).on('User/LogOut',function(){$YPCA('.jsMerchantFav .jsBtnFav').removeClass("btn-addtofav");});},publicFunctions:{setFavourite:function($btn,jsonAnalytics,isSignUpAutologin){var requestType=$btn.hasClass('btn-addtofav')?"DELETE":"POST",merchantId=$btn.attr('data-id');$YPCA.ajax({type:requestType,url:$btn.attr('data-urlajax'),success:function(data){$YPCA('.jsBtnFav[data-id="'+merchantId+'"]').parent().html(data);if(requestType==='POST' & & !isSignUpAutologin){YP.User.showUnconfirmedEmailModal();}if(YP.Utils.isDefined(jsonAnalytics)){YPCA.Analytics.clicks($btn,jsonAnalytics);}},contentType:"application/json"});}}};$YPCA(function(){favourites._init();});return favourites.publicFunctions;})($YPCA);"use strict";YP.Merchant=(function($YPCA,window){var $body=$YPCA('body'),merchantSettings={facebook:{},settings:{},isMerchantPage:$body.hasClass('ypg_merchant'),triggerFixed:$YPCA('.jsShowCTA').length!==0?$YPCA('.jsShowCTA').offset().top+$YPCA(".jsShowCTA").height():false,triggerOpacity:($body.hasClass('ypg_merchant') & & $YPCA(".controls").length!==0?$YPCA(".controls").offset().top-30:0),menuShowMore:false,config:{showMore:null,showLess:null,NUMBER_OF_WORDS:4,LENGTH_LIMIT:30}},merchant={_init:function(){merchant._addHolidayTitle();merchant._collapseScapText();merchant._addEventListener();merchant._setConfig();merchant._dynamicAddImageTop();merchant._comingFromEmail();merchant._setMerchantPageDisplay();merchant._comingFromBestReview();merchant._tabGestion();merchant._viewReviewFromSerp();merchant._viewInfoFromSerp();merchant._tripAdviserFromSerp();if($YPCA('.jsTextMenu').length>0){merchant._menuTextNav();merchant._toggleDineToClass();if(typeof $YPCA('#menu-nav').okayNav!=="undefined"){$YPCA('#menu-nav').okayNav({swipe_enabled:false});}merchant._menuAddTooltip();}merchant.attachDomListeners();$YPCA('.fromDirection:visible').focus();if($YPCA('body').hasClass('expandMapList')){$YPCA('.mainContainer').addClass('mLoc jsListingMerchantCards');$YPCA('.directionContent').hide();$YPCA('.resultList').show();$YPCA('.sponsoredListings .resultList').show();}if(YP.Utils.isDefined(YP.Serp)){YP.Serp.showSerpDeals();}merchant._dealerMobileMap();merchant._copyLink();merchant._checkHashParams();merchant._setVerticalBar();merchantSettings.$urlMyTime=$YPCA('.jsMytimeIframe').data('src');merchant._load();},_load:function(){if(YPCA.Utils.isDefined(merchantSettings.settings.sponsoredListingsUrl) & !==''){$YPCA.ajax({url:merchantSettings.settings.sponsoredListingsUrl,type:'get',dataType:'html',async:true,success:function(data){$YPCA('#sponsoredListings').html(data);if(YP.Utils.urlParamHash('app')!=='true'){YPCA.Analytics.triggerPageView("analytics-resource",1);}if(YP.Utils.isDefined(window.tc_vars_overlay)){YPCA.Analytics.sendCustomPageView(window.tc_vars_overlay,'WIDGET');}YP.Common.tooltipInit();}});}var $anchors=$YPCA('a[data-img-src]');if($anchors.length>0){$anchors.each(function(){var imgSrc=$YPCA(this).data('img-src'),imgAlt=$YPCA(this).data('img-alt'),imgTitle=$YPCA(this).data('img-title'),aHref=$YPCA(this).data('img-src-big');$YPCA(this).attr('href',aHref);$YPCA(' >',{onError:'replaceMissingImages(this)',src:imgSrc,alt:imgAlt,title:imgTitle}).appendTo(this);});}if($YPCA('.sliderContent').width()<$YPCA('#slider').width()){$YPCA('a[class*="slider"]').hide();}setTimeout(function(){var $els=$YPCA('.media-item.image-item, .media-item.video-item');$els.find('img').each(function(){var $this=$YPCA(this),$parent=$YPCA(this).parent(),parentHeight=$parent.innerHeight(),parentWidth=$parent.innerWidth();$this.css($this.height()<$this.width()?{'height':parentHeight+'px','width':'auto'}:{'height':'auto','width':parentWidth+'px'});$this.css('opacity','1');});$els.find('img').each(function(){var $this=$YPCA(this),$parent=$YPCA(this).parent(),parentHeight=$parent.innerHeight(),parentWidth=$parent.innerWidth(),overflow='-'+(Math.max($this.height()-parentHeight,$this.width()-parentWidth)) 2+'px';$this.css($this.height()>$this.width()?{'margin-top':overflow}:{'margin-left':overflow});});},1000);if(window.location.href.indexOf('myTime')!==-1){merchant._launchMyTimeModal();}if($YPCA('.jsMerchantBookingConfig').length>0){var config=YP.Utils.convertDataToJSON($YPCA('.jsMerchantBookingConfig')),bookingUrl=config.bookingWidgetUrl,d=new Date(),dateString=d.getFullYear()+'-'+(d.getMonth()+1)+'-'+d.getDate(),minutes=(Math.ceil(d.getMinutes()/30)*30);bookingUrl=bookingUrl.replace("{{date}}",dateString).replace("{{hour}}",minutes===60?(d.getHours()+1===24?0:d.getHours()+1):d.getHours()).replace("{{minute}}",minutes==60?"00":minutes);$YPCA.get(bookingUrl,function(data){$YPCA('.jsBookingWidget').html(data);});}},_collapseScapText:function(){var $merchantScapText=$YPCA('.jsMerchantScapText');if($merchantScapText.text().length>merchantSettings.config.LENGTH_LIMIT & ()){merchantSettings.config.showMore=$merchantScapText.data('more');merchantSettings.config.showLess=$merchantScapText.data('less');var modifiedText=YP.Utils.createExpandCollapseText($merchantScapText.text(),merchantSettings.config.NUMBER_OF_WORDS,{showmore:merchantSettings.config.showMore,showless:merchantSettings.config.showLess});$merchantScapText.html(modifiedText);}},_addEventListener:function(){$YPCA('.jsFBShare').click(function(){merchant._triggerAskAFriend();});$YPCA(".jsBtnMore").click(function(e){e.preventDefault();$YPCA(this).closest(".jsParentContainer").toggleClass("less");});$YPCA(".jsDetailsToogle").click(function(e){e.preventDefault();$YPCA(this).closest('.jsBusinessDetailsContainer').toggleClass('merchant__details--show merchant__details--hide');merchant._toggleMPDetail();if($YPCA(this).hasClass('show__details')){$YPCA(document).trigger('mp/showDetails','.jsStickyMPMobileOffset');}});$YPCA(".jsModuleToogle").click(function(e){e.preventDefault();merchant._moduleToogle(this);});$YPCA('.jsPrintButton').on('click',function(){window.print();});$YPCA(".jsScrollOpenHours").click(function(){if(YP.Utils.isDevicePhone()){YP.Utils.scrollPage($YPCA('#openHours'));}});YP.Common.hoverToShowHidden(".jsHeaderChart",".jsHeaderChartTooltip",200,200);$YPCA('#ypgBody').on('click','.goToByScroll',function(e){e.preventDefault();merchant.goToByScroll(this.hash);});$YPCA(document).one('click','.jsThumbToggle',function(e){$YPCA(this).toggleClass('ypicon-thumb-full ypicon-thumb-o');$YPCA('.jsThumbToggle').addClass('cursor-default').removeAttr('data-toggle data-original-title data-placement data-analytics');return false;});$YPCA(".icon-close").click(function(e){e.preventDefault();$YPCA(this).parent().hide();});$YPCA('.jsShowMenu').click(function(e){e.preventDefault();$YPCA(this).toggleClass('shares__item--active');});$YPCA(".goToQestions").click(function(e){e.preventDefault();merchant.goToByScroll(this.hash);$YPCA('#merchantQuestions').addClass('module--show').removeClass('module--hide');});$YPCA(".jsUploadImagePreview").click(function(e){e.preventDefault();merchant._imageUploadClick($YPCA(this));});$YPCA('#jsModalContainer').on('click','.jsBtnSaveMerchant',function(e){e.preventDefault();var $btn=$YPCA(this);if($YPCA('.jsAddressBookAnalyticsConfig').length>0){merchantSettings.settings=$YPCA.extend(merchantSettings.settings,YP.Utils.getJson($YPCA('.jsAddressBookAnalyticsConfig')));YPCA.Analytics.clicks($btn,merchantSettings.settings.analytics.add_now);}YP.Yid.login(function(loginStatus){YP.Favourites.setFavourite($btn,$btn.data('analytics-confirm'),loginStatus.isSignUpAutologin);location.href=$YPCA('.jsUserFavoritesUrl').attr('href');},'FAVOURITE');});$YPCA('.jsViewTravelDistance').click(function(){var $elem=$YPCA(this),$loader=$YPCA('.jsLoadingIcon');if($elem.data('lat')!=='' & & $elem.data('lng')!==''){$loader.removeClass('hidden');YPCA.Analytics.clicks($elem,$elem.data('analytics-intent'));YP.LocationService.fetchLocation(function(data){YP.TravelDistance.getDistance({lat:data.latitude,lng:data.longitude},{lat:$elem.data('lat'),lng:$elem.data('lng')}).then(function(result){merchant._hideTravelTimeElements({$elem:$elem,$loader:$loader});merchant._renderTravelTime(result);YPCA.Analytics.clicks($elem,$elem.data('analytics-success'));}).fail(function(result){merchant._hideTravelTimeElements({$elem:$elem,$loader:$loader});merchant._renderTravelTime(result);});},function(error){YP.Common.traceLog(error);$elem.addClass('hidden');},false);}});$YPCA('.jsBookNowDiv').on('click','.jsBookNowButton',merchant._onMyTimeClick);$YPCA('.jsLaunchBookNow').click(function(){merchant._launchMyTimeModal();});$YPCA('.jsSuggestAnUpdate').click(function(){$YPCA("#ypSuggestUpdateOwner").modal();var $config=$YPCA('#view_suggest_update');if($config.length>0){var config=YP.Utils.convertDataToJSON($config);YPCA.Analytics.pageView(config.impression_suggest_update_warning);}});},_onMyTimeClick:function(){if(!YP.Utils.urlParamHash('visitor_id',merchantSettings.$urlMyTime) & (window.tc_vars) & (ypdad)){merchantSettings.$urlMyTime=merchantSettings.$urlMyTime+' _id='+ypdad.getVisitorId()+' _id='+window.tc_vars.session_id+' _environment='+window.tc_vars.cf_environment;$YPCA('.jsMytimeIframe').attr('src',merchantSettings.$urlMyTime);}if(YP.Utils.convertDataToJSON($YPCA('.jsIsSafariOrIE')).safariOrIE==="true"){window.open(merchantSettings.$urlMyTime,'_blank');}else{$YPCA('.jsMyTimeBookNow').modal('show');}},_loadMap:function(){var $mapContainer=$YPCA('.jsMapOutput');if($mapContainer.length===0){$mapContainer=$YPCA('.jsStaticPrintMapContainer');}$YPCA.get($mapContainer.data('url')).done(function(success){if($mapContainer.selector==='.jsStaticPrintMapContainer'){$mapContainer.html(success);YP.StaticMap.createStaticMap();}else{$mapContainer.html(success).promise().done(function(){if($YPCA('.jsStaticMapContainer').length>0 & (YP.StaticMap)){YP.StaticMap.createStaticMap();}});}}).fail(function(){YP.Common.traceLog('error getting ajax map');});},_launchMyTimeModal:function(){if(YP.Utils.isDefined('.jsMyTimeBookNow')){$YPCA('.jsBookNowButton').trigger('click');}},_checkHashParams:function(){if(YP.Utils.urlParamHash('source')==='imageUpload'){var accountIsConfirmed=merchant._isAccountConfirmed();YP.Modal.show('#jsModalContainer','/ajax/photoconfirmation?accountConfirmed='+accountIsConfirmed);}if(window.location.hash!=='' & !=='#'){merchant.goToByScroll(window.location.hash);}if(YP.Utils.urlParamHash('#')==='editorsPick'){merchant.goToByScroll('#editorsPick');}if(YP.Utils.urlParamHash('action')==='writeReview'){setTimeout(function(){$YPCA('.jsWriteReview').trigger('click');});}if(YP.Utils.urlParamHash('reviewsPageNumber')!==0){window.location.href=YP.Utils.removeParam("reviewsPageNumber",window.location.href);}},_moduleToogle:function(selector){$YPCA(selector).closest('.jsModuleContainer').toggleClass('module--show module--hide');},_dynamicAddImageTop:function(){var $dataElem=$YPCA('.jsImagesConfigHandlebar');if($dataElem.length!==0){var data=YP.Utils.convertDataToJSON($dataElem),html=YP.Utils.getHandlebarHtml('#jsMediaImgTmpl',data);$YPCA('.jsEmptyMedia:first').before(html);$YPCA('.jsEmptyMediaAppend').append(html);}},_copyLink:function(){var selector='.jsCopyLink',$btn=$YPCA(selector);if($btn.length!==0){new Clipboard(selector).on('success',function(){$YPCA('.jsShares').append(' '+YP.Common.getMessage('copy.link.tooltip')+' ');$YPCA('.jsCopyFeedback').fadeIn(400);setTimeout(function(){$YPCA('.jsCopyFeedback').fadeOut(400,function(){$YPCA(this).remove();});},1000);});}},_setVerticalBar:function(){if(!($YPCA('.jsBusinessDetailsRating').length>0 & & $YPCA('.jsBookNowDiv').length>0)){$YPCA('.merchant__mytime__booknow').addClass("includeBar");}},_hideTravelTimeElements:function(opts){opts.$loader.addClass('hidden');opts.$elem.addClass('hidden');},_isAccountConfirmed:function(){var userInfo=YP.User.getUserInfo(),isConfirmed=merchantSettings.settings.uploadPhoto.user.isConfirmed==='true';if(merchantSettings.settings.uploadPhoto.isPhotoWithoutLogin==='true' & ===''){isConfirmed=true;}return isConfirmed;},_toggleDineToClass:function(){$YPCA('.food-menu--item').each(function(){if($YPCA(this).find('.food-menu--price__multiple').length>0){$YPCA(this).addClass('food-menu--item__multipleMeal');}});},_menuAddTooltip:function(){$YPCA('.deviceDesktop .jsMenuNav.loaded .okayNav__menu-toggle').attr({'data-toggle':'tooltip','data-placement':'top','title':YP.Common.getMessage("merchant.menu.toggle")}).tooltip();},_menuTextNav:function(){var $menuNavItem=$YPCA('.jsMenuNav li'),classActiveName='active',menuContent=$YPCA('.menu__content');$YPCA('.jsMenuNav').on('click','li',function(){var content_id=$YPCA(this).attr('data-content');$menuNavItem.removeClass(classActiveName);menuContent.removeClass(classActiveName);$YPCA(this).addClass(classActiveName);$YPCA("#"+content_id).addClass(classActiveName);$YPCA('.okayNav__menu-toggle.icon--active').trigger('click');merchant.goToByScroll('#menu');});},_removeHideBtnMenu:function($elem){var containerHeight=$elem.height(),isMenuBigger=containerHeight < =200;$YPCA('.jsMenuExpand').toggle(isMenuBigger);$YPCA('.jsMenuContainer').toggleClass('module--expandable module--hide',isMenuBigger);},_removeHideBtnMenuLoad:function(){if($YPCA('.jsMenuContent').length===1){merchant._removeHideBtnMenu($YPCA('.jsMenuContent'));}},_renderTravelTime:function(result){var template={sizeTransport:Object.keys(result).length,transportList:result},source=Handlebars.compile($YPCA('.jsTravelTimeTemplate').html());$YPCA('.jsTravelDistanceOutput').html(source(template));},_setConfig:function(){var $config=$YPCA('#facebook-resource');if($config.length>0){merchantSettings.facebook=$YPCA.extend(merchantSettings.facebook,JSON.parse($config.html()));}$config=$YPCA('.jsMapResource').last();if($config.length>0 & & $YPCA('.mapWrap').length>0){merchantSettings.settings=$YPCA.extend(merchantSettings.settings,JSON.parse($config.html()));}$config=$YPCA('#sponsored-listings-config');if($config.length>0){merchantSettings.settings=$YPCA.extend(merchantSettings.settings,JSON.parse($config.html()));}$config=$YPCA('.jsUploadPhotoGenericConfig');if($config.length>0){merchantSettings.settings=$YPCA.extend(merchantSettings.settings,JSON.parse($config.html()));}},_triggerAskAFriend:function(){if(typeof FB!=='undefined' & !==null){FB.ui({display:'popup',method:'share',href:merchantSettings.facebook.canonicalUrl+'?ypcampaign=askyourfriends =facebook =social'},function(){if(merchantSettings.facebook.popupUrl!==''){window.open(merchantSettings.facebook.popupUrl,'_blank','height='+merchantSettings.facebook.height+',width='+merchantSettings.facebook.width);}});}},_dealerMobileMap:function(){var isMapParsed=false;$YPCA('.jsDealerToggle').on('click',function(){$YPCA('body').toggleClass("dealerMap");if(!isMapParsed & & $YPCA('body').hasClass('dealerMap')){YPCA.publish('Data/Parsed');isMapParsed=true;}});$YPCA('.jsResultsList').on('click','.jsPagination',function(){isMapParsed=false;});},attachDomListeners:function(){var $fallback=$YPCA('.fallback');if($fallback.length>0){$fallback.hide();}},goToByScroll:function(anchor){var $anchorDiv=$YPCA(anchor);if($anchorDiv.length>0){$YPCA('html, body').animate({scrollTop:$anchorDiv.offset().top-($YPCA('.deviceDesktop .jsHeader').height()+$YPCA('.jsHeaderWrapper').height())},500);}},_toggleMPDetail:function(){if($YPCA('.jsBusinessDetailsContainer').hasClass('merchant__details--hide') & ()){YP.Utils.scrollPage($YPCA('#ypgBody'));}},_imageUploadClick:function(elem){var userInfo=YP.User.getUserInfo();if(!userInfo.authenticated){YPCA.Analytics.clicks(elem,merchantSettings.settings.uploadPhoto.analytics.intent);}if(merchantSettings.settings.uploadPhoto.isPhotoWithoutLogin==='true'){window.location=merchantSettings.settings.uploadPhoto.urlUploadPhotoPreview;}else{YP.Yid.login(function(){YPCA.Analytics.clicks(elem,merchantSettings.settings.uploadPhoto.analytics.confirm);setTimeout(function(){window.location=merchantSettings.settings.uploadPhoto.urlUploadPhotoPreview;},250);});}},_addHolidayTitle:function(){if($YPCA(".isHolidayHour").length>=1){$YPCA(".holidayTitle").show();}},_comingFromEmail:function(){if(window.location.href.indexOf("reviewApprovalEmail")>-1){var $config=$YPCA('#review_notification_email');if($config.length>0){var config=YP.Utils.convertDataToJSON($config);YPCA.Analytics.pageView(config.review_notification_email);}}},_comingFromBestReview:function(){if(window.location.href.indexOf("ypgBestReview")>-1){if($YPCA(".jsYpReviewTab").length>0){setTimeout(function(){if(YP.Utils.isDevicePhone()||YP.Utils.isDeviceTablet()){$YPCA('.mobile_tab_hide').hide();$YPCA(".merchant__review").show();$YPCA(".merchantContent").hide();$YPCA('.merchant_tab').removeClass("active");$YPCA('.review_merchant_tab').addClass("active");}$YPCA(".jsYpReviewTab").click();var text=YP.Utils.urlParamHash("ypgBestReview");var reviewSection=$YPCA('.review-content_text:contains("'+text+'")');if(reviewSection.length>0){var page=reviewSection.closest(".reviewPages").data("page");if(page>1){$YPCA(".reviewPage"+page).trigger("click");}$YPCA('html, body').animate({scrollTop:($YPCA('.review-content_text:contains("'+text+'")').offset().top-($YPCA(reviewSection).height()+175))},500);}},200);}}},_setMerchantPageDisplay:function(){if($YPCA(".sameDay").length>0){$YPCA(".sameDay2").removeClass("sameDay2");}if($YPCA(".openow").length>0){$YPCA(".open_hour_dropdown").html($YPCA(".openow").html());}else if($YPCA(".openow").length < =0){$YPCA(".open_hour_dropdown").html($YPCA(".closed_today").html());}if($YPCA(".freeText").length>0 & & $YPCA(".openow").length < =0 & & $YPCA(".sameday").length < =0 & & $YPCA(".sameday2").length < =0){$YPCA(".open_hour_dropdown").remove();}if($YPCA(".mlr__submenu__item__social").length===0){$YPCA(".merchant__useful_section__social").remove();}$YPCA('body').on('click',function(){$YPCA(".openHours-table").hide();});$YPCA('body').on('click','.open_hour_dropdown',function(e){e.stopPropagation();if($YPCA(".openHours-table").css('display')==='none'){$YPCA(".openHours-table").show();}else{$YPCA(".openHours-table").hide();}});$YPCA('body').on('click','.openHours-table',function(e){e.stopPropagation();if($YPCA(".openHours-table").css('display')==='none'){$YPCA(".openHours-table").show();}else{$YPCA(".openHours-table").hide();}});$YPCA('body').on('click','.see-hours',function(e){e.stopPropagation();if(YP.Utils.isDevicePhone()){$YPCA('.info_merchant_tab ').trigger("click");}$YPCA(".openHours-table").show();merchant.goToByScroll("#openHourScroll");});},_tabGestion:function(){if(!YP.Utils.isDeviceDesktop()){$YPCA('.merchant_tab').click(function(){$YPCA('.merchant_tab').removeClass("active");$YPCA(this).addClass("active");});$YPCA('.info_merchant_tab').click(function(){$YPCA('.mobile_tab_hide').hide();$YPCA(".merchant__box").show();$YPCA(".merchantContent").show();});$YPCA('.location_merchant_tab').click(function(){$YPCA('.mobile_tab_hide').hide();$YPCA(".merchant__Location").show();$YPCA(".merchantContent").hide();});$YPCA('.review_merchant_tab').click(function(){$YPCA('.mobile_tab_hide').hide();$YPCA(".merchant__review").show();$YPCA(".merchantContent").hide();});$YPCA('.details_merchant_tab').click(function(){$YPCA('.mobile_tab_hide').hide();$YPCA(".merchant__details_description").show();$YPCA(".merchantContent").hide();});$YPCA('body').on('click','.mlr__item--booknow',function(){$YPCA('.info_merchant_tab').trigger("click");merchant.goToByScroll("#moduleBookenda");});$YPCA('.listing-count, .listing__ratings__count, .ypStars-wrapper').click(function(){$YPCA('.review_merchant_tab').trigger("click");});$YPCA('.listing__editorPick__link').click(function(){$YPCA('.info_merchant_tab').trigger("click");});}},_viewReviewFromSerp:function(){if(window.location.href.indexOf("ypgReviewsHeader")>-1){$YPCA('.review_merchant_tab').trigger("click");setTimeout(function(){merchant.goToByScroll("#ypgReviewsHeader");},700);}},_viewInfoFromSerp:function(){if(window.location.href.indexOf("moduleBookenda")>-1){$YPCA('.info_merchant_tab').trigger("click");setTimeout(function(){merchant.goToByScroll(window.location.hash);},100);}},_tripAdviserFromSerp:function(){if(window.location.href.indexOf("taReviewsHeader")>-1){$YPCA('.review_merchant_tab').trigger("click");setTimeout(function(){$YPCA('.jsShowAllReviews').trigger("click");},100);}}};$YPCA(function(){merchant._init();});$YPCA(window).load(function(){merchant._loadMap();});return{goToByScroll:merchant.goToByScroll};})($YPCA,window);"use strict";var YP=window.YP||{};YP.Stars=(function($YPCA,document){var stars={_init:function(){stars._mouseoverEvent();stars._mouseleaveEvent();},publicFunctions:{selectRating:function($element){$element.siblings().andSelf().removeClass('active clicked');$element.prevAll().andSelf().addClass('active clicked');$element.parent().next('.jsRateText').html($element.attr('title'));},isRatingSelected:function($element){return $element.children('.clicked').length!==0;},resetStarsText:function(){var $rateText=$YPCA('.jsRateText');$rateText.each(function(){if(!stars.publicFunctions.isRatingSelected($YPCA(this).siblings('span'))){$YPCA(this).html($YPCA(this).data('text'));}});}},_mouseoverEvent:function(){$YPCA(document).on('mouseover','.jsStarReview:not(".noHover")',function(){var self=$YPCA(this),parent=self.parent();self.siblings().andSelf().removeClass('active');parent.next('.jsRateText').html(self.attr('title'));self.closest('.jsStarsContainer').find('.jsRateText').html(self.attr('title'));self.prevAll().andSelf().addClass('active');});},_mouseleaveEvent:function(){$YPCA(document).on('mouseleave','.jsStarsRate:not(".noHover")',function(){var self=$YPCA(this),activeLength=self.children('.clicked').length;self.children('span').removeClass('active').each(function(){$YPCA(this).toggleClass('active',$YPCA(this).hasClass('clicked'));});var $selfEm=self.siblings('.jsRateText');if(activeLength>0){$selfEm.html(self.children('.clicked').last().attr('title'));}else{stars.publicFunctions.resetStarsText();}});}};$YPCA(function(){stars._init();});return stars.publicFunctions;})($YPCA,document);"use strict";YP.ReviewService=(function($YPCA){var review={defaultRequest:{sessionToken:"",merchantId:null,overallRating:0,reviewText:'',reviewTitle:'',atmosphereRating:0,foodRating:0,serviceRating:0,category:'',subCategory:'',price:'',file:'',images:null,isMobile:false,userEmailAlerts:true,userEmail:null,reviewType:null,imageTokens:[]},imageFiles:[],imageFilesData:[],tempImgData:null,imageUrl:[],imageChanged:false,templateHandlebars:'',refreshAfterClosingModal:false,loginTriggered:false,engagement:{settings:{}},settings:{constants:{BAD_REQUEST:400,MIN_CHARS_REVIEW:20,YP_REVIEWS_PAGINATION_NB_BTN:4,TIMEOUT_TIME:500},keypressTimer:null,isEmailExistInYid:false,isUserRegisteredLive:false,$ratingStarsContainer:'',$writeReviewModal:$YPCA('#jsModalContainer')},_init:function(){review._getConfig();},_activeRightNbStars:function(){var nbStars=review.settings.$ratingStarsContainer.find("span.active").length;$YPCA('#ypInput_overallRating span').removeClass('active');$YPCA('#ypInput_overallRating span:lt('+nbStars+')').addClass('active');$YPCA('.ypRateControl em').text($YPCA('#ypInput_overallRating span.star'+nbStars).attr('title'));},_addEventListeners:function(){review.keypressTimer=null;var _index;review.settings.$writeReviewModal.on('hidden.bs.modal',function(){review._removeEventListeners();YP.Analytics.hideOverlay();$YPCA('#jsModalContainer').html('');$YPCA('.jsStarReview').removeClass('active on clicked');YP.Stars.resetStarsText();$YPCA(this).off('hidden.bs.modal');});$YPCA('.jsWriteReviewForm').on('click','.jsStarsRate',function(){$YPCA('.jsGlobalRatingContainer').removeClass('error');});$YPCA('.jsWriteReviewForm').on('click','.jsStarReview',function(){review.publicFunctions.selectRating($YPCA(this));});$YPCA('.jsGlobalRatingContainer').on('click','.jsStarReview',function(){var optionalCommentField=$YPCA('.jsOptionalComment');optionalCommentField.toggleClass('hidden',$YPCA(this).data('star') < 3)});$YPCA('.jsWriteReviewForm').on('keypress','.jsStarReview',review._checkSpaceOrEnterPressed);$YPCA('.jsWriteReviewForm').on('keyup blur','.jsReviewEmail',review._checkEmailExistInYid);$YPCA('.jsProjectTypeDropdown').on('change',review._populateSubCategoryDropdown);$YPCA('.jsProjectPrice').on('keydown',function(){var charCode=(event.which)?event.which:event.keyCode;return YP.ValidationUtils.isDigitOnly(charCode);});$YPCA(document).on('User/LogIn',function(){if(YPCA.Utils.storageAPI.get('session','reviewInfo')!==null){review._preSubmitReview();}});$YPCA('.category__images').on('click','.jsYpDelete',function(){var imgToDel=$YPCA(this).next().attr('src');review.imageFilesData.forEach(function(img,index){if(img==imgToDel){_index=index;}});review.imageFiles.splice(_index,1);review.imageFilesData.splice(_index,1);$YPCA(this).parent().remove();review.imageChanged=true;});$YPCA('.jsAddReviewImage').click(function(){$YPCA('#UploadReviewImagefile').trigger('click');});$YPCA('#UploadReviewImagefile').change(function(){review._showPreviewImage($YPCA(this)[0]);review.imageChanged=true;$YPCA(this).val('');});$YPCA('.jsWriteReviewForm').on('keypress','.jsStarReview',review._checkSpaceOrEnterPressed);},_showPreviewImage:function(input){var $err=false;if(input.files & [0]){var reader=new FileReader(),inputFiles0=input.files[0],fileSize=input.files[0].size/1048576;review.tempImgData=input.files[0];reader.onload=function(e){var image=new Image();image.src=e.target.result;review.imageFilesData.forEach(function(img){if(img==e.target.result){$err=true;$YPCA('.err1043').show();setTimeout(function(){$YPCA('.err1043').fadeTo(1000,0,function(){$YPCA('.err1043').hide();});},3500);$YPCA('.err1043').css('opacity',1);}});if(!$err){if(fileSize>10){$err=true;$YPCA('.err1044').show();setTimeout(function(){$YPCA('.err1044').fadeTo(1000,0,function(){$YPCA('.err1044').hide();});},3500);$YPCA('.err1044').css('opacity',1);}}if(!$err){image.onload=function(){if(this.width < 480||this.height < 480){$err=true;$YPCA('.err1039').show();setTimeout(function(){$YPCA('.err1039').fadeTo(1000,0,function(){$YPCA('.err1039').hide();});},3500);$YPCA('.err1039').css('opacity',1);}if(this.width/this.height>2.333||this.width/this.height < 0.4285){$err=true;$YPCA('.err1040').show();setTimeout(function(){$YPCA('.err1040').fadeTo(1000,0,function(){$YPCA('.err1040').hide();});},3500);$YPCA('.err1040').css('opacity',1);}if(!$err){review.imageFilesData.push(e.target.result);review.imageFiles.push(review.tempImgData);if(YP.Utils.isDeviceDesktop()){$YPCA('.jsAddReviewImage').before(' ');}else{$YPCA('.jsAddReviewImage').before(' ');}}};}}reader.readAsDataURL(input.files[0]);}},_getDataURI:function(url,callback){var image=new Image();image.crossOrigin='anonymous';var canvas=document.createElement("canvas"),canvasContext=canvas.getContext("2d");image.onload=function(){canvas.width=image.width;canvas.height=image.height;canvasContext.drawImage(image,0,0,image.naturalWidth,image.naturalHeight);callback(canvas.toDataURL());};image.src=url;},_dataURItoFile:function(dataURI){var byteString;if(dataURI.split(',')[0].indexOf('base64')>=0)byteString=atob(dataURI.split(',')[1]);elsebyteString=unescape(dataURI.split(',')[1]);var mimeString=dataURI.split(',')[0].split(':')[1].split(';')[0];var ia=new Uint8Array(byteString.length);for(var i=0;i 0;if(hasConfig){review.engagement.settings=$YPCA.extend(review.engagement.settings,JSON.parse($config.html()));}},_getReviewModalConfig:function(){var $config=$YPCA('.jsWriteReviewModalConfig');review.settings=$YPCA.extend(review.settings,JSON.parse($config.html()));},_fetchDropdownTemplate:function(){review.templateHandlebars=Handlebars.compile($YPCA('.jsProjectSubTypeDropdownTemplate').html());$YPCA('.jsProjectSubTypeDropdown').html(review.templateHandlebars(''));},_formReviewsAddValidationMethods:function(){$YPCA.validator.addMethod("nbStars",function(value,element,param){var starNumber=$YPCA('.jsGlobalRatingContainer .jsStarsRate .active').length,commentsLength=$YPCA('.jsReviewComment').val().length,showOneTwoStarError=!(0 < =param & 0){$YPCA('.jsProjectSubTypeDropdown').html(review.templateHandlebars(data));$YPCA('.jsProjectSubTypeDropdown select').prop('disabled',false);}},error:function(){YP.Common.traceLog('error loading sub categories');}});}else{$YPCA('.jsProjectSubTypeDropdown select').val('').attr('selected',true);$YPCA('.jsProjectSubTypeDropdown select').prop('disabled',true);}},_overwriteSettings:function(elem){review.settings.reviewBody=elem.find('.jsUserReviewBody').text();review.settings.reviewTitle=elem.find('.jsUserReviewTitle').text();review.settings.nbStarsFood=elem.find('.jsUserAdditionalRating[data-type="food"]').data('rating');review.settings.nbStarsAtmosphere=elem.find('.jsUserAdditionalRating[data-type="atmosphere"]').data('rating');review.settings.nbStarsService=elem.find('.jsUserAdditionalRating[data-type="service"]').data('rating');review.settings.nbStars=elem.data('rating');review.settings.reviewId=elem.data('reviewid');review.imageUrl=[];for(var i=0;i 0) & ==false){$YPCA('.errterms').show();$YPCA('.jsSubmitWriteReview').prop('disabled',false);setTimeout(function(){$YPCA('.errterms').fadeTo(1000,0,function(){$YPCA('.errterms').hide();});},3500);}else{$YPCA('.progressbar').show();if(review.imageFiles.length>0){review.defaultRequest.imageTokens=[];for(var i=0;i 100){pct=100;}}$YPCA('.progressbar div').css('width',pct+'%').delay(200);$YPCA('.progressbar').fadeOut(1500);},success:successCallback});}else{$YPCA('.jsSubmitWriteReview').prop('disabled',false);$YPCA('.jsGlobalRatingContainer').addClass('error');}YPCA.Utils.storageAPI.set('session','reviewInfo',null);}},_getTokens:function(file,successCallback,errorCallback,request){var elem=$YPCA(this);var fd=new FormData();fd.append("file",file);$YPCA.ajax({url:'/ajax/merchant/ratingImageUpload/'+review.settings.merchantId,type:"POST",data:fd,processData:false,contentType:false}).done(function(data){if(data!=null & !="" & (data)){review.defaultRequest.imageTokens.push(data);if(review.defaultRequest.imageTokens.length==review.imageFiles.length){review._submitReview(request,successCallback,errorCallback);}}else{errorCallback$YPCA('.jsReviewModalMessage').removeClass('hidden').html(review.settings.messageReviewValidation.signup.error);$YPCA('.progressbar').fadeOut(1500);}}).fail(function(){errorCallback$YPCA('.jsReviewModalMessage').removeClass('hidden').html(review.settings.messageReviewValidation.signup.error);$YPCA('.progressbar').fadeOut(1500);});},_triggerAnalytics:function(analyticsType){var clickAnalytics=review.settings.action==='edit'?review.settings.analytics.modify:review.settings.analytics.write;YPCA.Analytics.clicks($YPCA('.jsSubmitWriteReview'),clickAnalytics[analyticsType]);},_updateAnalyticsWithAccountCreated:function(forceValue){var defaultValue=$YPCA('.jsReviewAgreementCheckbox').is(':checked')?"Yes":"No";try{review.settings.analytics.write.intent["account_created"]=forceValue?forceValue:defaultValue;}catch(e){YP.Common.traceLog('no analytics founded for Review Submit Button Success');}},_addAccountCreatedToAnalytics:function(){$YPCA('.jsReviewAgreementCheckbox').change(function(){review._updateAnalyticsWithAccountCreated();});},_hideTypeOfWOrkSection:function(){$YPCA('.jsTypeOfWOrkPrice').hide();},_getUserReview:function(data,params){var isAllowed=params.origin==='mp'||params.origin==='profile';if(YP.Utils.isDefined(YP.Reviews)){YP.Reviews.appendTopReview(data);}if(review.publicFunctions.userHasReviewed() & ){review.settings.action=params.action='edit';if($YPCA('.jsUserReviewWrapper').length>0){review._overwriteSettings($YPCA('.jsUserReviewWrapper:first'));}else{review._overwriteImages($YPCA('.jsUserReviewWrapper:first'));}}if(review.publicFunctions.hasMerchantReplies()){$YPCA(document).trigger("Reviews/UserMerchantReplies");}else{review._checkImages(data);review.publicFunctions.displayWriteReviewModal(params,review._preWriteReviewModalDisplay(params,isAllowed),function(jqXHR,textStatus){YP.Common.traceLog("Request failed: "+textStatus);});}},_checkImages:function(data){if(review.imageUrl.length==0){var elem=$YPCA($YPCA.parseHTML(data));for(var i=0;i < 3){$YPCA('.jsWarningLowRatingMessage').removeClass('hidden');}if(review.publicFunctions.userHasReviewed() & ){review._hideTypeOfWOrkSection();}},publicFunctions:{deleteReview:function(setting){return $YPCA.ajax({type:"POST",url:setting.url,data:JSON.stringify({sessionToken:setting.sessionToken,reviewId:setting.reviewId}),contentType:"application/json"});},displayWriteReviews:function(params){review.defaultRequest.merchantId=params.merchantId;review.settings.origin=params.origin;review.settings.action=params.action;review.settings.editreviewurl=params.editReviewAjaxUrl;review.settings.reviewId=params.reviewId;YP.Yid.loginForRating(function(){review.publicFunctions.getUserReview({url:params.userReviewAjaxUrl}).done(function(data){review._getUserReview(data,params);}).fail(function(jqXHR,textStatus){YP.Common.traceLog("Request failed: "+textStatus);});},'REVIEW');},displayWriteReviewsFavorite:function(params){review.defaultRequest.merchantId=params.merchantId;review.settings.origin=params.origin;review.settings.action=params.action;review.settings.editreviewurl=params.editReviewAjaxUrl;review.settings.reviewId=params.reviewId;YP.Yid.loginForRating(function(){review.publicFunctions.getUserReview({url:params.userReviewAjaxUrl}).done(function(data){review._getUserReviewFavorite(data,params);}).fail(function(jqXHR,textStatus){YP.Common.traceLog("Request failed: "+textStatus);});},'REVIEW');},displayWriteReviewModal:function(settings,callback,errorCallback){review.settings.origin=settings.origin;review.settings.action=settings.action;review.settings.editreviewurl=settings.editReviewAjaxUrl;$YPCA.ajax({url:settings.writeReviewAjaxUrl,type:'get',dataType:'html'}).done(function(data){review.settings.$writeReviewModal.html('');if(review.settings.$writeReviewModal.html()===''){review.settings.$writeReviewModal.html(data);review._getReviewModalConfig();review._fetchDropdownTemplate();review._addAccountCreatedToAnalytics();review.settings.$btnSubmitWriteReview=$YPCA('.jsSubmitWriteReview');review.publicFunctions.initWriteReview(settings);review.publicFunctions.formReviewsValidation();review.settings.$writeReviewModal.find('.modal').modal({show:true});$YPCA('.jsCounter').text($YPCA('.jsCounter').attr('data-maxlength')-$YPCA('.jsReviewComment').val().length);$YPCA('.ReviewImageNo').remove();review.imageUrl.forEach(function(img,j){if(j < 3){review._getDataURI(img,function(dataUri){review.imageFilesData.push(dataUri);review.imageFiles.push(review._dataURItoFile(dataUri));if(YP.Utils.isDeviceDesktop()){$YPCA('.jsAddReviewImage').before(' ');}else{$YPCA('.jsAddReviewImage').before(' ');}});}});$YPCA('.loader-lds').hide();YP.Modal.hideBackdrop();if(callback){callback();}}}).fail(function(jqXHR,textStatus){YP.Common.traceLog("Request failed: "+textStatus);if(errorCallback()){errorCallback();}});},displayPostWriteReview:function(params,callbackSuccess,callbackError){var url=params.url+'?rating='+params.ratings+' ='+params.type+" ="+params.isOptOutPhoto+" ="+params.isRatingOnly;review.refreshAfterClosingModal=params.refreshAfterClosingModal;YP.Modal.show("#jsModalContainer",url,function(){review._addPostReviewModalEventListeners();if($YPCA('.modal-backdrop').length>1){$YPCA($YPCA('.modal-backdrop')[0]).remove();}if(callbackSuccess){callbackSuccess();}});},formReviewsValidation:function(){var $form=$YPCA("#ypgWriteReviewForm"),$counter=$YPCA('.jsCounter'),$reviewText=$YPCA('.jsReviewComment'),counterMaxLength=$counter.data('maxlength'),$submitBtn=$YPCA('.jsSubmitWriteReview');var reviewFormValidate=$form.validate({rules:{reviewEmail:{email:true,emailValidationBasic:true,required:true},reviewComment:{nbStars:2},reviewTitle:{required:false}},messages:review.settings.messageReviewValidation,invalidHandler:function(event,validator){var errors=validator.numberOfInvalids();if(errors){review._triggerAnalytics('error');}},submitHandler:function(){var starNumber=$YPCA('.jsGlobalRatingContainer .jsStarReview.active').length,$emailField=$YPCA('.jsReviewEmail');$submitBtn.prop('disabled',true);$YPCA('.jsGlobalRatingContainer').removeClass('error');$YPCA('.jsReviewModalMessage').addClass('hidden');reviewFormValidate.resetForm();review.settings.isUserRegisteredLive=false;if(starNumber===0){$YPCA('.jsGlobalRatingContainer').addClass('error');$submitBtn.prop('disabled',false);review._triggerAnalytics('error');}else{if(YP.Yid.isAuthenticated()){review._setReviewLocally();review._preSubmitReview();}else{if(review.settings.isEmailExistInYid){var email=$emailField.val();review._setReviewLocally();review.loginTriggered=true;YP.Modal.show("#jsModalContainer","/ajax/user/signin");$YPCA(document).trigger('WriteReview/Login',{userEmail:email,alertMessage:review.settings.messageReviewValidation.lostReview});}else{if($YPCA('.jsReviewAgreementCheckbox').is(':checked')){YP.YidService.createPasswordlessUser($emailField.val()).done(function(){review.settings.isUserRegisteredLive=true;$emailField.prop('readonly',true);$YPCA('.jsReviewAgreementContainer').addClass('hidden');review._updateAnalyticsWithAccountCreated("No");review._setReviewLocally();}).fail(function(jqXHR,textStatus){$YPCA('.jsReviewModalMessage').removeClass('hidden').html(review.settings.messageReviewValidation.signup.error);$submitBtn.prop('disabled',false);YP.Common.traceLog("Request failed: "+textStatus);});}else{$YPCA('.jsReviewModalMessage').removeClass('hidden').html(review.settings.messageReviewValidation.checkbox.required);$submitBtn.prop('disabled',false);}}}}},onkeyup:function(elm){reviewFormValidate.resetForm();var nbCharLeft=counterMaxLength-$reviewText.val().length;$counter.html(nbCharLeft).toggleClass('noMoreChar',nbCharLeft===0);elm.value=YP.YidService.checkForQuotes(elm);}});},getUserReview:function(setting){return $YPCA.ajax({type:"GET",url:setting.url,contentType:"application/json"});},hideWriteReviews:function(){review.settings.$writeReviewModal.find('.modal').modal('hide');review.settings.$writeReviewModal.on('hidden.bs.modal',function(){review.settings.$writeReviewModal.html('');});},initWriteReview:function(params){review.defaultRequest.imageTokens=[];review.imageFiles=[];review.imageFilesData=[];review.loginTriggered=false;var oParams={nbStars:review.settings.nbStars?review.settings.nbStars:params.nbStars,nbStarsAtmosphere:params.nbStarsAtmosphere?params.nbStarsAtmosphere:review.settings.nbStarsAtmosphere,nbStarsFood:params.nbStarsFood?params.nbStarsFood:review.settings.nbStarsFood,nbStarsService:params.nbStarsService?params.nbStarsService:review.settings.nbStarsService,reviewTitle:params.reviewTitle?params.reviewTitle:review.settings.reviewTitle,reviewBody:params.reviewBody?params.reviewBody:review.settings.reviewBody};review.settings.$ratingStarsContainer=$YPCA('.jsWriteReviewForm .jsStarsRate');review._addEventListeners();$YPCA('.jsWriteReviewForm .jsStarsRate span:lt('+oParams.nbStars+')').addClass('active clicked');$YPCA('.jsGlobalRatingContainer .jsStarsRate + em').text($YPCA('#ypInput_overallRatingAlt .active:last').attr('title'));if(oParams.nbStars>2){$YPCA('.jsOptionalComment').removeClass('hidden');}if(review.settings.action==='edit'){$YPCA('.jsRatingOptionAtmosphere .jsStarReview:lt('+oParams.nbStarsAtmosphere+')').addClass('active clicked');$YPCA('.jsRatingOptionAtmosphere .jsStarReview + em').text($YPCA('.jsRatingOptionAtmosphere .jsStarReview.active:last').attr('title'));$YPCA('.jsRatingOptionFood .jsStarReview:lt('+oParams.nbStarsFood+')').addClass('active clicked');$YPCA('.jsRatingOptionFood .jsStarReview + em').text($YPCA('.jsRatingOptionFood .jsStarReview.active:last').attr('title'));$YPCA('.jsRatingOptionService .jsStarReview:lt('+oParams.nbStarsService+')').addClass('active clicked');$YPCA('.jsRatingOptionService .jsStarReview + em').text($YPCA('.jsRatingOptionService .jsStarReview.active:last').attr('title'));$YPCA('.jsReviewTitleTextfield').val(oParams.reviewTitle);$YPCA('.jsReviewComment').val(oParams.reviewBody);}review._formReviewsAddValidationMethods();review._checkPrivateMode();},loginAndSubmitReview:function(request,successCallback,errorCallback){YP.Yid.loginForRating(function(loginStatus){request.sessionToken=loginStatus.sessionToken;if(YP.Utils.isDefined(YP.Reviews)){YP.Reviews.getUserReviewStatus(review.merchantId,function(){if(review.settings.action==='edit'){review._overwriteSettings($YPCA('.jsUserReviewWrapper'));request.reviewUrl=review.settings.editreviewurl;}else{request.reviewUrl="/ajax/reviews/postreview";}review._submitReviewShort(request,successCallback,errorCallback);});}else{review._submitReviewShort(request,successCallback,errorCallback);}});},hasMerchantReplies:function(){return $YPCA('.jsUserReviewWrapper[data-editable="false"]').length>0;},removeEventOnStars:function(){$YPCA('#ypInput_overallRating .jsStarReview').addClass('noHover');$YPCA('#ypInput_overallRating').addClass('noHover').data('rating','rating'+$YPCA("#ypInput_overallRating .active").length);},selectRating:function($element){return YP.Stars.selectRating($element);},submitReview:function(loginStatus){var request={sessionToken:loginStatus.sessionToken};if(YPCA.Utils.storageAPI.get('session','reviewInfo')!==null){request=$YPCA.extend(request,JSON.parse(YPCA.Utils.storageAPI.get('session','reviewInfo')));}review._triggerAnalytics('intent');YP.ReviewService.loginAndSubmitReview(request,function(data){review.settings.$writeReviewModal.off('hidden');review._removeRatingListeners();review._activeRightNbStars();review.publicFunctions.removeEventOnStars();$YPCA('.jsSubmitWriteReview').prop('disabled',false);$YPCA(document).trigger("Reviews/PostReviewCallback",{$btnSubmit:review.settings.$btnSubmitWriteReview,origin:review.settings.origin,data:data,overallRating:request.overallRating,merchantId:request.merchantId,reviewText:request.reviewText,priceAmount:request.price,workType:request.category+','+request.subCategory,isUserRegisteredLive:review.settings.isUserRegisteredLive,analyticsData:review.settings.action==='edit'?review.settings.analytics.modify:review.settings.analytics.write,isRatingOnly:request.isRatingOnly});},function(){review._triggerAnalytics('error');});},userHasReviewed:function(){return $YPCA('.jsBtnWriteReview').length===0;}}};$YPCA(function(){review._init();});return review.publicFunctions;})($YPCA);'use strict';var YP=window.YP||{};YP.Reviews=(function($YPCA,window,document){var reviewSortBy="submissionTime:desc",selectedLang='all',moreAjaxLoading=true,reviews={constants:{BAD_REQUEST:400,CALLBACK_MODAL_TIMEOUT:2000,MIN_CHARS_REVIEW:20,YP_REVIEWS_PAGINATION_NB_BTN:4},settings:{},cacheElement:{$reviewsSection:$YPCA('.module.reviews')},taReviewHeader:YP.Utils.urlParamHash('#')==="taReviewsHeader",ypTabActive:$YPCA(".reviewTab_yp").hasClass('active'),taTabActive:$YPCA(".reviewTab_ta").hasClass('active'),bkTabActive:$YPCA(".reviewTab_bk").hasClass('active'),taHasReviews:false,$reviewsTop:$YPCA('.jsReviewsTop'),$paginationWrapper:$YPCA('.jsPaginationWrapper'),analyticNum:null,maxPagesReview:$YPCA('.jsPaginationWrapper').data('max-pages')||1,writeReviewTop:null,user:{sessionToken:''},_init:function(){var $config=$YPCA('#reviews-config');if($config.length>0){reviews.settings={$writeReviewModal:$YPCA('#jsModalContainer'),$replyReviewModal:$YPCA('#jsModalContainer'),$deleteReviewModal:$YPCA('#jsModalContainer')};reviews.settings=$YPCA.extend(reviews.settings,JSON.parse($config.html()));reviews._addRatingListeners();reviews._addListeners();reviews._checkTabActiveReviews();reviews._showWriteReview();reviews._checkHashParams();}},_resetWriteTop:function(){reviews.writeReviewTop=false;},_removeBtnWriteReview:function(){$YPCA('.jsBtnWriteReview').remove();},_appendTopReview:function(data,callback){reviews.$reviewsTop.nextAll().remove();reviews.$reviewsTop.after(data);if($YPCA('#ypInput_overallRating').data('rating')!=='rating0'){YP.ReviewService.removeEventOnStars();}if(callback){callback();}},_showRatesActions:function(){if($YPCA('.jsBtnWriteReview').length===0){$YPCA('.jsStarsContainer').remove();}},_displayReplyReview:function($elem){reviews.analyticNum=$elem.data('num');$YPCA(document).on('loaded',reviews.settings.$replyReviewModal,YP.Reviews.formReplyReviewValidation);},submitReplyReview:function(){var replyReview={qa:[]};$YPCA('#ypgReplyReviewForm .input-sm').each(function(){var answer={"comment":$YPCA(this).val()};replyReview.qa.push(reviews._createJson($YPCA(this).data('q'),answer));});$YPCA.ajax({type:"POST",url:$YPCA('#ypgReplyReviewForm').data('href'),data:JSON.stringify(replyReview),contentType:"application/json",success:function(jqXHR){if(jqXHR.code==="0"){$YPCA('#ypgReplyReviewOverlay .responseMessage').html(YP.Common.getMessage("modal.review.reply.submit.ok"));$YPCA('#ypgReplyReviewOverlay .modal-body').removeClass('success error').addClass('success');var successAnalytic=JSON.parse($YPCA('.jsResponseAnalytic').attr('data-analytic-success'));successAnalytic.lk_pos_num=reviews.analyticNum;YPCA.Analytics.clicks($YPCA('.jsResponseAnalytic'),successAnalytic);}else{$YPCA('#ypgReplyReviewOverlay .responseMessage').html(YP.Common.getMessage("modal.review.reply.submit.error"));$YPCA('#ypgReplyReviewOverlay .modal-body').removeClass('success error').addClass('error');}},error:function(){$YPCA('#ypgReplyReviewOverlay .modal-body').removeClass('success error').addClass('error');$YPCA('#ypgReplyReviewOverlay .responseMessage').html(YP.Common.getMessage("modal.review.reply.submit.error"));}});},_createJson:function(q,a){return{"q":q,"a":a};},_showRightYIDMessage:function(className,optionalMsg){var $reviewSection=$YPCA('#reviewPreview'),message=optionalMsg?optionalMsg:$reviewSection.data(className);if(!$reviewSection.hasClass(className)){$reviewSection.addClass(className).prepend(' '+message+" ");}},_showErrorYIDMessage:function(msg){if($YPCA('.jsWriteReviewOverlay').is(':visible')){$YPCA('.jsReviewModalMessage').removeClass('hidden').html(msg);}else{reviews._showRightYIDMessage('error',reviews.settings.editReview.messages.hasMerchantReply);}},_postToFacebook:function(){if($YPCA('#ypgPostToFacebook').is(':checked')){YP.SocialNetworks.publishToFacebook(reviews.settings.canonicalUrl,$YPCA('#ypInput_comment').val());}},_displayMoreReviews:function(feeder){if(YPCA.Utils.isDefined(feeder)){$YPCA('.jsReviewsWrap').removeClass('show');$YPCA('#reviewDetails_'+feeder).addClass('show');$YPCA('.reviewTabs li').removeClass('active');$YPCA('li.reviewTab_'+feeder).addClass('active');}},_showOneTypeReview:function(type){if(!reviews[type+'HasReviews'] & & $YPCA('.reviewTab_'+type).length!==0 & & !reviews[type+'TabActive']){reviews.getMoreReviews(1,true,'reviewDetails_'+type,false);reviews[type+'HasReviews']=true;}},_showAllReview:function(){reviews.cacheElement.$reviewsSection.removeClass('previewMode');},_createTmpPagination:function(page,specialClass){var newClass=YP.Utils.isDefined(specialClass)?' '+specialClass:'';return' '+page+' ';},gotoReviewPage:function($event,page,reviewSortByThis,language,languageSwitch){var currentSection=$event.closest('section').attr('id'),$reviewContainer=$YPCA('#'+currentSection+' .jsReviewsList'),$reviewPages=$YPCA('#'+currentSection+' .jsNbResults'),countPages=$reviewPages.length,currentPage=YP.Utils.isDefined($reviewPages.filter(':visible').data('page'))?$reviewPages.filter(':visible').data('page'):0,newQuery=false;if(reviewSortByThis!=='' & & (reviewSortBy!==reviewSortByThis||selectedLang!==language)){$YPCA('#'+currentSection).remove('.reviewPages');reviewSortBy=reviewSortByThis;selectedLang=language;countPages=1;newQuery=true;}if(page==='prev'){page=((currentPage-1) < =0?currentPage=1:currentPage-1);}else if(page==='next'){if(currentPage+1>reviews.maxPagesReview){currentPage=reviews.maxPagesReview;}else{currentPage=currentPage+1;}page=currentPage;}if(page>=1 & < =reviews.maxPagesReview & ){$reviewPages.hide();if(page>countPages||newQuery){moreAjaxLoading=false;if(newQuery){$reviewContainer.html('');}reviews.getMoreReviews(page,newQuery,currentSection,languageSwitch);if(newQuery){$reviewPages.hide();$YPCA('#'+currentSection+' .reviewItem').show();var reviewItemCount=$YPCA('#'+currentSection+' .jsReviewItem').length;for(var i=reviewItemCount;i>reviews.constants.YP_REVIEWS_PAGINATION_NB_BTN;i--){$YPCA('#'+currentSection+' .reviewItem_'+i).remove();}}else{if($YPCA('#'+currentSection+' .reviewItem_'+page).length===0){var newReviewItem=reviews._createTmpPagination(page);$YPCA('#'+currentSection+' .reviewItem_'+(page-reviews.constants.YP_REVIEWS_PAGINATION_NB_BTN)).hide();$YPCA('#'+currentSection+' li.next').before(newReviewItem);}}}else{var $paginationVisible=$YPCA('#'+currentSection+' .jsReviewItem:visible');if($paginationVisible.length===reviews.constants.YP_REVIEWS_PAGINATION_NB_BTN){if(page>($YPCA('#'+currentSection+' .jsReviewItem').index($paginationVisible.eq(reviews.constants.YP_REVIEWS_PAGINATION_NB_BTN-1))+1)){$paginationVisible.eq(0).hide();}if(page < ($YPCA('#'+currentSection+' .jsReviewItem').index($paginationVisible.eq(0))+1)){$paginationVisible.eq(reviews.constants.YP_REVIEWS_PAGINATION_NB_BTN-1).hide();}$YPCA('#'+currentSection+' .reviewItem_'+page).removeAttr('style');}}$reviewPages.eq(page-1).show();$YPCA('#'+currentSection+' .jsReviewItem a').removeClass('active');$YPCA('#'+currentSection+' .reviewItem_'+page+' a').addClass('active');YP.Utils.scrollPage($YPCA('.jsReviewsNav'));reviews._togglePrevNextBtn(page,reviews.maxPagesReview);}},_togglePrevNextBtn:function(posPage,lastPage){$YPCA('.jsReviewsWrap:visible .jsPaginationPrev').toggleClass('hidden',posPage===1);$YPCA('.jsReviewsWrap:visible .jsPaginationNext').toggleClass('hidden',posPage===lastPage);},toggleLoadingVisuel:function(show){reviews.cacheElement.$reviewsSection.toggleClass('loading',show);},getReadReviewsAjaxUrl:function(currentSection,pageSize,page){var getThisQuery=null;if(currentSection==='reviewDetails_yp' & (pageSize) & (page)){getThisQuery=reviews.settings.readReviewsAjaxUrls.yellowPages+' ='+page+' ='+pageSize+' ='+reviewSortBy+' ='+selectedLang;}else if(currentSection==='reviewDetails_ta'){getThisQuery=reviews.settings.readReviewsAjaxUrls.trip_advisor;}return getThisQuery;},_resetPagination:function(nbResults,currentSection){$YPCA('.jsReviewItem').remove();$YPCA('.jsReviewsWrap:visible .jsReviewItem').remove();var maxPages=Math.ceil(nbResults/5),nbBtnPagination=maxPages>reviews.constants.YP_REVIEWS_PAGINATION_NB_BTN?reviews.constants.YP_REVIEWS_PAGINATION_NB_BTN:maxPages,html='';for(var i=0;i!==nbBtnPagination;i++){html+=reviews._createTmpPagination(i+1,i===0?'active':'');}$YPCA('#'+currentSection+' .jsPaginationNext').before(html);},getMoreReviews:function(page,newQuery,currentSection,languageSwitch){var pageSize=newQuery?20:5,getThisQuery=reviews.getReadReviewsAjaxUrl(currentSection,pageSize,page);if(getThisQuery){reviews.toggleLoadingVisuel(true);$YPCA.ajax({url:getThisQuery,type:'get',dataType:'html',success:function(data){$YPCA('#'+currentSection+' .jsReviewsList').append(data);moreAjaxLoading=true;reviews.toggleLoadingVisuel(false);if(languageSwitch & & $YPCA('.jsNbResults').length!==0){var nbResults=$YPCA('.jsNbResults').data('nb-results');reviews.settings.reviewsTotal[currentSection]=nbResults;reviews._resetPagination(nbResults,currentSection);reviews._togglePrevNextBtn(1,reviews.maxPagesReview);}reviews._refreshReviewCount();},error:function(){reviews.toggleLoadingVisuel(false);var $dropDown=$YPCA('.jsErrorTimeout'),errorHtml=' '+$dropDown.data('timeout')+' ';$YPCA('#'+currentSection+' .reviews-content.reviewList').append(errorHtml);$YPCA('.reviews-pagination.reviewNav').hide();}});}},sortReviews:function($select,currentSection,language,languageSwitch){var reviewSortByThis=$select.val(),reviewSortByThisText=$select.find("option:selected").text();$YPCA('#'+currentSection+' .jsSortReviews').val(reviewSortByThis);reviews.gotoReviewPage($YPCA('.jsSortReviews'),1,reviewSortByThis,language,languageSwitch);},_refreshReviewCount:function(){if($YPCA('.jsReviewCountRefreshed:first').length>0){$YPCA('.jsYPReviewCount').text($YPCA('.jsReviewCountRefreshed:first').text());}},_addRatingListeners:function(){$YPCA(document).one('click','.jsShowAllReviews',function(e){e.preventDefault();reviews._showAllReview();});$YPCA(document).on('click','.jsScrollToYpReview',function(e){if(!$YPCA('.jsYpReviewTab').parent().hasClass('active')){$YPCA('.jsYpReviewTab').trigger('click');}});$YPCA(document).on('click','.reviewTabs li:not(.reviewTab_yp) a',function(e){e.preventDefault();reviews._showOneTypeReview($YPCA(this).data('feeder'));});$YPCA(document).on('click','#ypInput_overallRating .jsStarReview:not(.noHover), .jsStarsContainer .jsStarReview:not(.noHover)',function(){var $self=$YPCA(this);YP.Merchant.goToByScroll('#ypgReviewsHeader');$YPCA('.jsGlobalRatingContainer').removeClass('error');YP.Stars.selectRating($self);var nbStars=$self.prevAll().andSelf().length;YP.ReviewService.displayWriteReviewModal({nbStars:nbStars,editReviewAjaxUrl:reviews.settings.editReviewAjaxUrl,writeReviewAjaxUrl:reviews.settings.writeReviewAjaxUrl,userReviewAjaxUrl:reviews.settings.userReviewAjaxUrl,merchantId:reviews.settings.merchantId,origin:'mp',action:'write'});});$YPCA(document).on('Reviews/PostReviewCallback',function(event,params){if(params.origin==='mp'){var result=params.data;reviews._removeBtnWriteReview();if(result.httpStatusCode===YP_COMMON.HTTP_STATUS_CODE.SUCCESS){params.analyticsData.success.price_amount=params.priceAmount;params.analyticsData.success.work_type=params.workType;YPCA.Analytics.clicks(params.$btnSubmit,params.analyticsData.success);reviews._postCallbackReviewSuccess({isUserRegisteredLive:params.isUserRegisteredLive,reviewText:params.reviewText,result:result,overallRating:params.overallRating,isRatingOnly:params.isRatingOnly});}else{reviews._showErrorYIDMessage(result.errorMessage);YPCA.Analytics.clicks(params.$btnSubmit,params.analyticsData.error);$YPCA('.jsSubmitWriteReview').prop('disabled',true);setTimeout(location.reload(),10000);}reviews._resetWriteTop();}});$YPCA(document).on('Reviews/UserMerchantReplies',function(event,params){reviews._showRightYIDMessage('error',reviews.settings.editReview.messages.hasMerchantReply);});},_showWriteReview:function(){if(YP.Utils.urlParamHash('#')==='writeReview'){$YPCA('.jsBusinessDetailsContainer .jsWriteReview').trigger('click');}},_postCallbackReviewSuccess:function(data){var analyticsTypeReviewSubmit='';YP.ReviewService.hideWriteReviews();reviews._postToFacebook();reviews._showRatesActions();if(reviews.writeReviewTop){analyticsTypeReviewSubmit=data.reviewText.length>0?'writereview-confirm-rateAndReview_top_bar':'writereview-confirm-rateOnly_top_bar';}else{analyticsTypeReviewSubmit=data.reviewText.length>0?'writereview-confirm-rateAndReview':'writereview-confirm-rateOnly';}YP.Analytics.callReviewAnalytic(analyticsTypeReviewSubmit);var urlEmail='/yid/v1.0/user/'+YP.User.getUserCookiesInfo().u+'/email';$YPCA.ajax({type:"get",url:urlEmail});if(data.isUserRegisteredLive & < 4){YP.Modal.show("#jsModalContainer",'/ajax/user/pwResetAndConfirm');YP.Modal.hideBackdrop();}else{YP.ReviewService.displayPostWriteReview({url:reviews.settings.postReviewPromotionAjaxUrl,ratings:data.overallRating,type:'success',refreshAfterClosingModal:false,isOptOutPhoto:reviews.settings.isOptedOutOfImages,isRatingOnly:data.isRatingOnly},function(){YPCA.Analytics.resendCurrentPageView();});}},_addListeners:function(){$YPCA('div.reviews').on('click','.jsReplyResponse',function(e){e.preventDefault();reviews._displayReplyReview($YPCA(this));});$YPCA('.jsYpNoReviews').on('click',function(e){e.preventDefault();var settings={nbStars:null,editReviewAjaxUrl:reviews.settings.editReviewAjaxUrl,userReviewAjaxUrl:reviews.settings.userReviewAjaxUrl,writeReviewAjaxUrl:reviews.settings.writeReviewAjaxUrl,merchantId:reviews.settings.merchantId,origin:'mp',action:'write'};if(YP.Yid.isAuthenticated()){YP.ReviewService.displayWriteReviews(settings);}else{YP.ReviewService.displayWriteReviewModal(settings);}});$YPCA('#ypgBody').on('click','.jsWriteReview',function(e){e.preventDefault();var settings={nbStars:null,editReviewAjaxUrl:reviews.settings.editReviewAjaxUrl,writeReviewAjaxUrl:reviews.settings.writeReviewAjaxUrl,userReviewAjaxUrl:reviews.settings.userReviewAjaxUrl,merchantId:reviews.settings.merchantId,origin:'mp',action:'write'};if(YP.Yid.isAuthenticated()){YP.ReviewService.displayWriteReviews(settings);}else{YP.ReviewService.displayWriteReviewModal(settings);}});$YPCA('#ypgBody').on('click','.jsWriteReviewBtnTop',function(){reviews.writeReviewTop=true;});$YPCA('.jsShowAllReviews').on('click',function(e){e.preventDefault();reviews._displayMoreReviews($YPCA(this).data('feeder'));});$YPCA('div.reviews').on('click','.jsPagerReview',function(e){e.preventDefault();var $self=$YPCA(this);reviews.gotoReviewPage($self,$self.data('page'),($self.data('sortBy')||''),selectedLang,false);});$YPCA('.jsSortReviews').on('change',function(e){e.preventDefault();var self=$YPCA(this);reviews.sortReviews(self,self.data('currentselection'),selectedLang,false);});$YPCA('.jsSortByLang').on('change',function(e){e.preventDefault();var $self=$YPCA(this);reviews.gotoReviewPage($self,1,reviewSortBy,$self.val(),true);$YPCA('.jsReviewsDisclaimer').toggleClass('hidden',$self.val()!=='all');});$YPCA('#anchorAnimateTA').on("click",function(){$YPCA('html, body').animate({scrollTop:$YPCA('#reviewPreview').offset().top},1000);});$YPCA('#jsModalContainer').on("click",'.jsStarReview',function(){YPCA.Analytics.clicks($YPCA(this),$YPCA(this).data('analytics-stars-modal'));});$YPCA('.jsStarsContainer').on("click",'.jsStarReview:not(".noHover"), .jsWriteReview',function(){YPCA.Analytics.clicks($YPCA(this),$YPCA(this).data('analytics-stars-mp'));});$YPCA('.jsReviewsList').on("click",'.jsEditReview',function(){var elem=$YPCA(this);YP.Yid.login(function(loginStatus){reviews.user.sessionToken=loginStatus.sessionToken;reviews.settings.reviewId=elem.data('reviewid');YP.ReviewService.displayWriteReviews({reviewBody:elem.parents('.jsReviewContentParent').find('.jsReviewContentText').text(),reviewTitle:elem.parents('.jsReviewContentParent').find('.jsReviewTitle').text(),nbStarsFood:elem.parents('.jsReviewContentParent').find('.jsAdditionalRating[data-type="food"]').data('rating'),nbStarsAtmosphere:elem.parents('.jsReviewContentParent').find('.jsAdditionalRating[data-type="atmosphere"]').data('rating'),nbStarsService:elem.parents('.jsReviewContentParent').find('.jsAdditionalRating[data-type="service"]').data('rating'),nbStars:elem.data('overallrating'),writeReviewAjaxUrl:reviews.settings.writeReviewAjaxUrl,editReviewAjaxUrl:reviews.settings.editReviewAjaxUrl,userReviewAjaxUrl:reviews.settings.userReviewAjaxUrl,merchantId:reviews.settings.merchantId,reviewId:reviews.settings.reviewId,origin:'mp',action:'edit'});});});$YPCA('.jsReviewsList').on("click",'.jsDeleteReview',function(){var elem=$YPCA(this);YP.Yid.login(function(loginStatus){reviews.user.sessionToken=loginStatus.sessionToken;reviews.settings.reviewId=elem.data('reviewid');YP.Modal.show("#jsModalContainer",reviews.settings.deleteReviewModalAjaxUrl);});});reviews.settings.$deleteReviewModal.on("click",'.jsDeleteReviewConfirm',function(){YP.ReviewService.deleteReview({url:reviews.settings.removeReviewAjaxUrl,sessionToken:reviews.user.sessionToken,reviewId:reviews.settings.reviewId}).done(function(data){$YPCA('.jsModalReviewDelete').modal('hide');if(data.httpStatusCode===YP_COMMON.HTTP_STATUS_CODE.SUCCESS){reviews._showRightYIDMessage('success',reviews.settings.removeReview.messages.success);$YPCA('.jsReviewItemBlock[data-reviewid="'+reviews.settings.reviewId+'"]').fadeOut(250);}else{reviews._showRightYIDMessage('error',data.errorMessage);}}).fail(function(){$YPCA('.jsModalReviewDelete').modal('hide');reviews._showRightYIDMessage('error',reviews.settings.removeReview.messages.fail);});YP.Merchant.goToByScroll('#ypgReviewsHeader');});$YPCA('.jsYPReview').on("click",'.jsReportInappropriate',function(){var elem=$YPCA(this);YP.Yid.login(function(loginStatus){$YPCA.when(YP.Modal.show('#jsModalContainer',elem.data('url')),$YPCA.Deferred(function(deferred){$YPCA(deferred.resolve);})).done(function(){YP.Modal.hideBackdrop();setTimeout(function(){YP.ReviewInappropriate.createInappropriateReview({sessionToken:loginStatus.sessionToken,reviewId:elem.data('reviewid'),responseId:elem.data('responseid')});},reviews.constants.CALLBACK_MODAL_TIMEOUT);});});});},_checkTabActiveReviews:function(){var defaultActiveTab=$YPCA('.jsReviewContainer').data('default-open-tab'),hashParamEmpty=YP.Utils.urlParamHash('#')!=='taReviewsHeader' & ('#')!=='ypgReviewsHeader',isYpHashParam=YP.Utils.urlParamHash('#')==='ypgReviewsHeader' & & $YPCA('.jsYpNoReviews').length===0;if(!$YPCA('body').hasClass('expandMapList')){if(reviews.taTabActive){reviews.getMoreReviews(1,true,'reviewDetails_ta',false);}if($YPCA('.reviewTab_yp').length>0 & ){YP.Merchant.goToByScroll('#ypgReviewsHeader');$YPCA('.reviewTab_yp a').trigger('click');}if(reviews.taReviewHeader){YP.Merchant.goToByScroll('#ypgReviewsHeader');$YPCA('_ta a').trigger('click');}if(reviews.bkTabActive & ){$YPCA('.reviewTab_bk a').trigger('click');}}if((YP.Utils.isDefined(defaultActiveTab) & !=='') & ){switch(defaultActiveTab){case'TRIPADVISOR':$YPCA('.reviewTab_ta a').trigger('click');break;case'BOOKENDA':$YPCA('.reviewTab_bk a').trigger('click');break;case'YP':$YPCA('.reviewTab_yp a').trigger('click');break;}}},_checkHashParams:function(){if(window.location.href.indexOf('reviewsPageNumber')!==-1){var currentPage=YP.Utils.urlParamHash('reviewsPageNumber');$YPCA('.jsPagerReview').removeClass('active').filter('[data-page="'+currentPage+'"]').addClass('active');}},publicFunctions:{appendTopReview:function(data){reviews._appendTopReview(data);},formReplyReviewValidation:function(){$YPCA("#ypgReplyReviewForm").validate({rules:{business:{required:true},name:{required:true},phone:{required:true,phoneUS:true},email:{required:true,email:true},message:{required:true}},messages:{"business":{"required":YP.Common.getMessage("modal.review.reply.error.required")},"name":{"required":YP.Common.getMessage("modal.review.reply.error.required")},"phone":{"required":YP.Common.getMessage("modal.review.reply.error.required"),"phoneUS":YP.Common.getMessage("modal.review.reply.error.phone.validation")},"email":{"required":YP.Common.getMessage("modal.review.reply.error.required"),"email":YP.Common.getMessage("modal.review.reply.error.email.validation")},"message":{"required":YP.Common.getMessage("modal.review.reply.error.required")}},submitHandler:function(){reviews.submitReplyReview();}});},getUserReviewStatus:function(mid,callback,errorCallback){YP.ReviewService.getUserReview({url:reviews.settings.userReviewAjaxUrl}).done(function(data){reviews._appendTopReview(data,callback);}).fail(function(jqXHR,textStatus){YP.Common.traceLog("Request failed: "+textStatus);errorCallback();});}}};$YPCA(function(){reviews._init();});return reviews.publicFunctions;})($YPCA,window,document);(function($,window,undefined){var hasOnProgress=("onprogress"in $.ajaxSettings.xhr());if(!hasOnProgress){return;}var oldXHR=$.ajaxSettings.xhr;$.ajaxSettings.xhr=function(){var xhr=oldXHR.apply(this,arguments);if(xhr instanceof window.XMLHttpRequest){xhr.addEventListener('progress',this.progress,false);}if(xhr.upload){xhr.upload.addEventListener('progress',this.progress,false);}return xhr;};})(jQuery,window);"use strict";var YP=window.YP||{};YP.StaticMap=(function($YPCA,window){var staticMap={settings:null,$mapContainer:$YPCA('.jsStaticMapContainer'),json:{width:0,height:0},timeout:null,_init:function(){if(staticMap.$mapContainer.length!==0){staticMap.settings=YP.Utils.getJson($YPCA('#static-map-resource'));if(YP.Utils.isDefined(YP.MostWanted)){YP.MostWanted.setConfig(staticMap);}staticMap._initValue();staticMap._resize();staticMap._initResize();}},_getLatLong:function(){var features=staticMap.settings.geoJson.features;staticMap.json.coordinates=[];for(var i=0;i!==features.length;i++){staticMap.json.coordinates.push({latitude:features[i].coordinates[0],longitude:features[i].coordinates[1]});}},_initValue:function(){staticMap._getLatLong();staticMap.json.scale=Math.ceil(window.devicePixelRatio);staticMap.json.useCenter=YP.Utils.isDefined(staticMap.settings.useCenter)?staticMap.settings.useCenter:false;staticMap.json.zoom=YP.Utils.isDefined(staticMap.settings.zoom)?staticMap.settings.zoom:14;},_initResize:function(){$YPCA(window).resize(function(){clearTimeout(staticMap.timeout);staticMap.timeout=setTimeout(staticMap._resize,500);});},_getWidth:function(){var widthParent=staticMap.$mapContainer.width(),widthChange=false;if(widthParent!==staticMap.json.width){staticMap.json.width=staticMap.$mapContainer.width();widthChange=true;}return widthChange & !==0;},_getHeight:function(){var heightParent=staticMap.$mapContainer.height(),heightChange=false;if(heightParent!==staticMap.json.height){staticMap.json.height=staticMap.$mapContainer.height();heightChange=true;}return heightChange & !==0;},_getImage:function(){if(staticMap.json.coordinates.length!==0){if(YP.Utils.getMapProvider()!=='osm'){$YPCA.ajax({type:"post",url:staticMap.settings.mapUrl,data:JSON.stringify(staticMap.json),contentType:"application/json",success:function(url){if(url.length!==0){staticMap._insertMap(url,true);}else{staticMap.$mapContainer.hide();}}});}else{staticMap._insertMap('https://cdn.staticmap.yellowpages.ca/staticmap.php?center='+staticMap.settings.geoJson.features[0].coordinates[0]+','+staticMap.settings.geoJson.features[0].coordinates[1]+' ='+staticMap.json.width+'x'+staticMap.json.height+' =15',true);}}},_insertMap:function(src,insertPin){var pin=staticMap.json.useCenter & ?' ':'',img=' ';staticMap.$mapContainer.html(pin+img);},_resize:function(){var widthChange=staticMap._getWidth(),heightChange=staticMap._getHeight();if(widthChange||heightChange){staticMap._getImage();}},publicFunctions:{createStaticMap:function(value){if(value!==null & (value)){staticMap.$mapContainer=value;}else{staticMap.$mapContainer=$YPCA('.jsStaticMapContainer');}staticMap._init();}}};$YPCA(function(){staticMap._init();});return staticMap.publicFunctions;})($YPCA,window); 'use strict';(function(factory){if(typeof define==='function' & ){define(['jquery'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'));}else{factory(jQuery||Zepto);}}(function($){var Mask=function(el,mask,options){var p={invalid:[],getCaret:function(){try{var sel,pos=0,ctrl=el.get(0),dSel=document.selection,cSelStart=ctrl.selectionStart;if(dSel & ('MSIE 10')===-1){sel=dSel.createRange();sel.moveStart('character',-p.val().length);pos=sel.text.length;}else if(cSelStart||cSelStart==='0'){pos=cSelStart;}return pos;}catch(e){}},setCaret:function(pos){try{if(el.is(':focus')){var range,ctrl=el.get(0);if(ctrl.setSelectionRange){ctrl.focus();ctrl.setSelectionRange(pos,pos);}else{range=ctrl.createTextRange();range.collapse(true);range.moveEnd('character',pos);range.moveStart('character',pos);range.select();}}}catch(e){}},events:function(){el.on('keydown.mask',function(e){el.data('mask-keycode',e.keyCode||e.which);}).on($.jMaskGlobals.useInput?'input.mask':'keyup.mask',p.behaviour).on('paste.mask drop.mask',function(){setTimeout(function(){el.keydown().keyup();},100);}).on('change.mask',function(){el.data('changed',true);}).on('blur.mask',function(){if(oldValue!==p.val() & & !el.data('changed')){el.trigger('change');}el.data('changed',false);}).on('blur.mask',function(){oldValue=p.val();}).on('focus.mask',function(e){if(options.selectOnFocus===true){$(e.target).select();}}).on('focusout.mask',function(){if(options.clearIfNotMatch & & !regexMask.test(p.val())){p.val('');}});},getRegexMask:function(){var maskChunks=[],translation,pattern,optional,recursive,oRecursive,r;for(var i=0;i 0){if(el[method]()!==v){el[method](v);}r=el;}else{r=el[method]();}return r;},getMCharsBeforeCount:function(index,onCleanVal){for(var count=0,i=0,maskL=mask.length;i -1 & >-1;};}else{lastMaskChar=maskLen-1;check=function(){return m 0,[val,e,el,p.invalid,options]);}};el=$(el);var jMask=this,oldValue=p.val(),regexMask;mask=typeof mask==='function'?mask(p.val(),undefined,el,options):mask;jMask.mask=mask;jMask.options=options;jMask.remove=function(){var caret=p.getCaret();p.destroyEvents();p.val(jMask.getCleanVal());p.setCaret(caret-p.getMCharsBeforeCount(caret));return el;};jMask.getCleanVal=function(){return p.getMasked(true);};jMask.getMaskedVal=function(val){return p.getMasked(false,val);};jMask.init=function(onlyMask){onlyMask=onlyMask||false;options=options||{};jMask.clearIfNotMatch=$.jMaskGlobals.clearIfNotMatch;jMask.byPassKeys=$.jMaskGlobals.byPassKeys;jMask.translation=$.extend({},$.jMaskGlobals.translation,options.translation);jMask=$.extend(true,{},jMask,options);regexMask=p.getRegexMask();if(onlyMask===false){if(options.placeholder){el.attr('placeholder',options.placeholder);}if(el.data('mask')){el.attr('autocomplete','off');}p.destroyEvents();p.events();var caret=p.getCaret();p.val(p.getMasked());p.setCaret(caret+p.getMCharsBeforeCount(caret,true));}else{p.events();p.val(p.getMasked());}};jMask.init(!el.is('input'));};$.maskWatchers={};var HTMLAttributes=function(){var input=$(this),options={},prefix='data-mask-',mask=input.attr('data-mask');if(input.attr(prefix+'reverse')){options.reverse=true;}if(input.attr(prefix+'clearifnotmatch')){options.clearIfNotMatch=true;}if(input.attr(prefix+'selectonfocus')==='true'){options.selectOnFocus=true;}if(notSameMaskObject(input,mask,options)){return input.data('mask',new Mask(this,mask,options));}},notSameMaskObject=function(field,mask,options){options=options||{};var maskObject=$(field).data('mask'),stringify=JSON.stringify,value=$(field).val()||$(field).text();try{if(typeof mask==='function'){mask=mask(value);}return typeof maskObject!=='object'||stringify(maskObject.options)!==stringify(options)||maskObject.mask!==mask;}catch(e){}},eventSupported=function(eventName){var el=document.createElement('div'),isSupported;eventName='on'+eventName;isSupported=(eventName in el);if(!isSupported){el.setAttribute(eventName,'return;');isSupported=typeof el[eventName]==='function';}el=null;return isSupported;};$.fn.mask=function(mask,options){options=options||{};var selector=this.selector,globals=$.jMaskGlobals,interval=globals.watchInterval,watchInputs=options.watchInputs||globals.watchInputs,maskFunction=function(){if(notSameMaskObject(this,mask,options)){return $(this).data('mask',new Mask(this,mask,options));}};$(this).each(maskFunction);if(selector & !=='' & ){clearInterval($.maskWatchers[selector]);$.maskWatchers[selector]=setInterval(function(){$(document).find(selector).each(maskFunction);},interval);}return this;};$.fn.masked=function(val){return this.data('mask').getMaskedVal(val);};$.fn.unmask=function(){clearInterval($.maskWatchers[this.selector]);delete $.maskWatchers[this.selector];return this.each(function(){var dataMask=$(this).data('mask');if(dataMask){dataMask.remove().removeData('mask');}});};$.fn.cleanVal=function(){return this.data('mask').getCleanVal();};$.applyDataMask=function(selector){selector=selector||$.jMaskGlobals.maskElements;var $selector=(selector instanceof $)?selector:$(selector);$selector.filter($.jMaskGlobals.dataMaskAttr).each(HTMLAttributes);};var globals={maskElements:'input,td,span,div',dataMaskAttr:'*[data-mask]',dataMask:true,watchInterval:300,watchInputs:true,useInput:eventSupported('input'),watchDataMask:false,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{'0':{pattern:/\d/},'9':{pattern:/\d/,optional:true},'#':{pattern:/\d/,recursive:true},'A':{pattern:/[a-zA-Z0-9]/},'S':{pattern:/[a-zA-Z]/}}};$.jMaskGlobals=$.jMaskGlobals||{};globals=$.jMaskGlobals=$.extend(true,{},globals,$.jMaskGlobals);if(globals.dataMask){$.applyDataMask();}setInterval(function(){if($.jMaskGlobals.watchDataMask){$.applyDataMask();}},globals.watchInterval);}));"use strict";YP.ContactEmail=(function($YPCA){var contactEmail={cachedElements:{},isPresence:$YPCA('body').hasClass('presence'),$modal:null,_init:function(){$YPCA('.fromDirection').focus();contactEmail._onLoadContentShareEmail();contactEmail._onLoadShareDirections();$YPCA('#ypModal .ypConfirmEmail .resend').click(function(){contactEmail.resendEmail($YPCA("#ypModal .ypConnect input[name=identifier]").val());});},attachGenericDomListeners:function($modal){var $form=$modal.find('form');contactEmail.$modal=$modal;if($form.length!==0){contactEmail.createValidator($modal,$form);$modal.on('click','.btn-close, .btns .btn-cancel',function(e){e.preventDefault();$modal.modal('hide');});$modal.on('keyup','.content textarea',function(){var delta=$YPCA(this).attr("maxlength")-$YPCA(this).val().length;$modal.find('.content span strong').text(delta);});$modal.on('input','.jsEmailField',function(){this.value=YP.YidService.checkForQuotes(this);});}},_filterContentTypeValidation:function($modal){var defaultValidation={required:true,minlength:20,maxlength:5000};if($modal.attr('id')==='shareEmail'||$modal.attr('id')==='shareEmailDirections'){defaultValidation={maxlength:5000};}return defaultValidation;},_onSuccessEmailSent:function(data,$submitButton){if(data.code==="0"){contactEmail.$modal.addClass('successSend').removeClass('errorOnce');$YPCA('.jsContactMsgSuccess').removeClass('hidden');contactEmail.sendSuccessAnalytics($submitButton);$.ajax({url:"https://www.googletagmanager.com/gtag/js?id=AW-794878240",dataType:"script",success:gtag_report_conversion("email-confirm")});}else if(contactEmail.$modal.hasClass('errorOnce')){contactEmail.$modal.addClass('errorTwice').removeClass('errorOnce');$YPCA('.jsErrorOnce').removeClass('hidden');contactEmail.sendErrorAnalytics($submitButton);YP.Captcha.reset();}else{contactEmail.$modal.addClass('errorOnce');contactEmail.sendErrorAnalytics($submitButton);$YPCA('.jsErrorOnce').removeClass('hidden');YP.Captcha.reset();}$submitButton.show();},_onLoadContentShareEmail:function(){$YPCA('#contentShareEmail').on('show.bs.modal',function(){contactEmail.attachGenericDomListeners($YPCA('#contentShareEmail'));});},_onLoadShareDirections:function(){$YPCA('#shareEmailDirections').on('show.bs.modal',function(){YPCA.Analytics.triggerPageView('shareDirectionPageView',null,'serpoverlay');contactEmail.attachGenericDomListeners($YPCA('#shareEmailDirections'));contactEmail.setUrlShareDirection();});},createValidator:function($modal,$form){var contentEmailValidation=contactEmail._filterContentTypeValidation($modal);return $form.validate({rules:{to:{required:true,email:true},toSms:{required:true,phoneUS:true},from:{required:true,email:true},fromSms:{required:true,minlength:2,maxlength:30,lettersOnly:true},contentEmail:contentEmailValidation},messages:{to:{required:YP.Common.getMessage("merchant.emailForm.error.to.required"),email:YP.Common.getMessage("merchant.emailForm.error.email.validation")},toSms:{required:YP.Common.getMessage("merchant.sms.error.max.digits"),phoneUS:YP.Common.getMessage("merchant.sms.error.max.digits")},subject:{maxlength:YP.Common.getMessage("merchant.emailForm.error.max.characters60")},contentEmail:{required:YP.Common.getMessage("merchant.emailForm.error.min.characters20"),minlength:YP.Common.getMessage("merchant.emailForm.error.min.characters20"),maxlength:YP.Common.getMessage("merchant.emailForm.error.max.characters5000")},from:{required:YP.Common.getMessage("merchant.emailForm.error.from.email"),email:YP.Common.getMessage("merchant.emailForm.error.email.validation")},fromSms:{lettersOnly:YP.Common.getMessage("merchant.sms.error.name.lettersOnly"),required:YP.Common.getMessage("merchant.sms.error.name.required"),minlength:YP.Common.getMessage("merchant.sms.error.name.min.characters2"),maxlength:YP.Common.getMessage("merchant.sms.error.name.max.characters30")}},submitHandler:function(form){var $submitButton=$YPCA(form).find('.jsBtnSendForm');if((YP.Captcha.isValidated()||YP.Captcha.featureDisabled())||contactEmail.isPresence){$YPCA('.jsErrorOnce').addClass('hidden');YP.Captcha.toggleErrorClass('');$submitButton.hide();$YPCA.post($YPCA(form).attr("action"),$YPCA(form).serialize(),function(data){contactEmail._onSuccessEmailSent(data,$submitButton);});}else{YP.Captcha.toggleErrorClass('add');return false;}}});},resendEmail:function(email){var url='/yid/v1.0/user/'+email+'/email';$YPCA.ajax({type:"get",url:url,async:false});},sendSuccessAnalytics:function($submitButton){var analytics=$submitButton.attr('data-analytics-success');if(YP.Utils.isDefined(analytics)){YPCA.Analytics.clicks($submitButton,JSON.parse(analytics));}},sendErrorAnalytics:function($submitButton){var analytics=$submitButton.attr('data-analytics-error');if(YP.Utils.isDefined(analytics)){YPCA.Analytics.clicks($submitButton,JSON.parse(analytics));}},setUrlShareDirection:function(){var url=$YPCA('.jsShareDirectionUrl').data('share-url');url+=' ='+encodeURIComponent($YPCA('.jsAvoidHighways').is(':checked'));url+=' ='+encodeURIComponent($YPCA('.jsAvoidTolls').is(':checked'));url+=' ='+encodeURIComponent($YPCA('.optionDestination a.active').text());url+=' ='+encodeURIComponent($YPCA('.directionType .active').data('transportation'));url+=' ='+encodeURIComponent($YPCA('.directionWrap div input[type=text]:not([readonly="readonly"])').val());url+=' ='+encodeURIComponent($YPCA('.directionWrap div:first-child input[readonly]').length===0);url+=' =1';$YPCA("#shareEmailDirections [name='directionsUrl']").val(url);}};$YPCA(function(){contactEmail._init();});return contactEmail;})($YPCA);"use strict";YP.SmsApps=(function($YPCA){var smsApps={$forms:$YPCA('.jsFormSms'),$defaultMsg:$YPCA('.jsDefaultMsg'),classNameActive:'active',classNameHidden:'hidden',classNameErrorPhone:'errorPhone',classCaptchaContainer:'captchaError',classNameLoading:'loading',config:{phoneNumber:null},key:null,_init:function(){smsApps.key=$YPCA('#jsCaptcha').data('sitekey');smsApps._events();},_generateCaptcha:function(){if(smsApps.key){grecaptcha.render('jsCaptcha',{'sitekey':smsApps.key,'callback':function(){YP.SmsApps.removeErrorForCaptcha();}});}},_validatePhone:function($form){smsApps.config.phoneNumber=$form.find('.jsInputPhone').val();$YPCA.get(smsApps.config.phoneValidationUrl+'?phoneNumber='+smsApps.config.phoneNumber,function(data){smsApps._toggleClassError($form,false);if(data.valid){$form.find('.jsBtnSmsModal').trigger('click');if(YP.Utils.isDefined(smsApps.config.analytic.sendNumber) & !==''){YPCA.Analytics.clicks(smsApps.$forms,smsApps.config.analytic.sendNumber);}}else{if(YP.Utils.isDefined(smsApps.$forms,smsApps.config.analytic.sendNumberError) & !==''){YPCA.Analytics.clicks(smsApps.$forms,smsApps.config.analytic.sendNumberError);}smsApps._toggleClassError($form,true);}});},_toggleClassError:function($form,showError){$form.toggleClass(smsApps.classNameErrorPhone,showError);},_sendSms:function(){var hasCaptchaResponse=YP.Utils.isDefined($YPCA('.g-recaptcha-response').val()) & & $YPCA('.g-recaptcha-response').val().length>0,captcha=$YPCA('.g-recaptcha-response').val();if(hasCaptchaResponse||YP.Captcha.featureDisabled()){var captchaParam=!YP.Captcha.featureDisabled()?' ='+captcha:' =';smsApps.$defaultMsg.addClass(smsApps.classNameLoading);$YPCA('.jsErrorCaptcha').addClass(smsApps.classNameHidden);$YPCA.get(smsApps.config.sendSmsUrl+' ='+smsApps.config.phoneNumber+captchaParam,function(data){if(data.code==='0'){smsApps.$defaultMsg.addClass(smsApps.classNameHidden);$YPCA('.jsThanksMsg').removeClass(smsApps.classNameHidden);$YPCA('.jsPhoneNumberSend').html(smsApps.config.phoneNumber);$YPCA('.jsCaptchaContainer').removeClass(smsApps.classCaptchaContainer).addClass(smsApps.classNameHidden);$YPCA('.jsBtnCaptchaContainer').addClass(smsApps.classNameHidden);if(YP.Utils.isDefined(smsApps.$forms,smsApps.config.analytic.sendLink) & !==''){YPCA.Analytics.clicks(smsApps.$forms,smsApps.config.analytic.sendLink);}$YPCA(document).trigger('smsAppsend');}else{$YPCA('.jsErrorCaptcha').removeClass(smsApps.classNameHidden);}});}else{smsApps._setWidthErrorCaptcha();YPCA.Analytics.clicks(smsApps.$forms,smsApps.config.analytic.sendLinkError);$YPCA('.jsCaptchaContainer').addClass(smsApps.classCaptchaContainer);}},_setWidthErrorCaptcha:function(){var widthError=$YPCA('.jsCaptchaContainer').find('iframe').outerWidth();$YPCA('.jsErrorCaptca').css('width',widthError);},_resetForm:function(){smsApps.$forms.removeClass(smsApps.classNameHidden+" "+smsApps.classNameActive).find('input').val('').focus();smsApps.removeErrorForCaptcha(smsApps.$forms.find('.jsCaptchaContainer'));$YPCA('#smsSend').modal('hide');},_events:function(){$YPCA('.jsBtnValidSms').click(function(e){e.preventDefault();smsApps.config=YP.Utils.getConfigJson($YPCA(this).closest('.jsFormWrap').next('.jsAppResources'));smsApps._validatePhone($YPCA(this).closest('.jsFormSms'));});$YPCA('.jsInputPhone').keypress(function(){smsApps._toggleClassError($YPCA(this),false);});smsApps.$forms.submit(function(e){e.preventDefault();smsApps._validatePhone($YPCA(this));});$YPCA('.jsReset').click(function(){smsApps._resetForm();});$YPCA(document).on('click','.jsBtnSendSms',function(){smsApps._sendSms();});$YPCA('#smsSend').on('hidden.bs.modal',function(){$YPCA('.jsCaptchaContainer').remove(smsApps.classNameHidden);smsApps.$defaultMsg.addClass(smsApps.classNameHidden);$YPCA('.jsErrorCaptcha').removeClass(smsApps.classNameHidden);$YPCA('.jsThanksMsg').addClass(smsApps.classNameHidden);$YPCA('.jsInputPhone').val('');$YPCA('#jsCaptcha').remove();$YPCA('.jsCaptchaContainer').prepend(' ');});},removeErrorForCaptcha:function(){$YPCA('.jsCaptchaContainer').removeClass(smsApps.classCaptchaContainer);}};$YPCA(function(){smsApps._init();});return{removeErrorForCaptcha:smsApps.removeErrorForCaptcha};})($YPCA);"use strict";YP.Captcha=(function($YPCA){var captcha={config:{$captchaContainer:$YPCA('.jsCaptchaContainer'),classCaptchaContainer:'captchaError'},_init:function(){},_setWidthBox:function(){var widthError=captcha.config.$captchaContainer.find('iframe').outerWidth();$YPCA('.jsErrorCaptcha').css('width',widthError);},publicFunctions:{captchaHandleResponse:function(response,btnSend,captchaResponse){var btnSubmit=YP.Utils.isDefined(btnSend)?btnSend:$YPCA('.jsBtnSendForm'),captchaRespond=YP.Utils.isDefined(captchaResponse)?captchaResponse:$YPCA('.jsCaptchaResponse');btnSubmit.prop('disabled',response.length===0);captchaRespond.val(response);$YPCA('.jsErrorCaptcha').addClass('hidden');$YPCA('.jsErrorOnce').addClass('hidden');$YPCA('.jsCaptchaContainer').removeClass('captchaError');},create:function(sitekey,callback,expiredCallback){grecaptcha.render('jsCaptcha',{'sitekey':sitekey,'callback':function(response){callback(response);},'expired-callback':function(){expiredCallback();}});},featureDisabled:function(){return $YPCA('.jsCaptchaFeatureEnabled').length===0;},isValidated:function(){if($YPCA('.g-recaptcha-response').length!==0){var captcha=$YPCA('.g-recaptcha-response').val();return captcha.length>0;}else{return false;}},reset:function(){if(captcha.config.$captchaContainer.length!==0){grecaptcha.reset();captcha.publicFunctions.captchaHandleResponse('');}},toggleErrorClass:function(param){if(captcha.config.$captchaContainer.length!==0){captcha.config.$captchaContainer.removeClass(captcha.config.classCaptchaContainer);if(param==='add'){captcha.config.$captchaContainer.addClass(captcha.config.classCaptchaContainer);captcha._setWidthBox();}}}}};$YPCA(function(){captcha._init();});return captcha.publicFunctions;})($YPCA);"use strict";YP.MerchantDeals=(function($YPCA,window,document){var nextPage=1,deals={settings:{isMerchantDealPage:$YPCA(".ypg_merchantDeals").length>0,offsetOneDealHeight:$YPCA('.ypg-header').height()+$YPCA('.busCardContainer').height()+20},_init:function(){var $config=$YPCA('#merchantDeals-resource');if($config.length>0){deals.settings=$YPCA.extend(deals.settings,JSON.parse($config.html()));nextPage=deals.settings.yp_dealsNextPage;}if(!$YPCA('body').hasClass('ypg_merchant') & & $YPCA('.deals a.loadmore[data-ajaxpageurl]').length>0 & & $YPCA('.deals a.loadmore[data-ajaxpageurl]').attr('data-ajaxpageurl')!==''){$YPCA('.deals a.loadmore[data-ajaxpageurl]').css('display','block');}deals._customEventsListeners();YP.Common.showMRLBar();deals._dealsAjaxCall();},_extractDealsTeaser:function(){$YPCA('.jsDealDesc').each(function(){var dealDesc=$YPCA(this).children("p:first").text();$YPCA(this).parents('.jsDealDescWrapper').before(' '+dealDesc+' We are sorry, we were not able to provide you with an itinerary for those locations. Think your friends might be familiar with this business? Ask your friends on Facebook to see what they think. National advertising powered by  Mediative.com .Yellow Pages TM , Walking Fingers  &  Design TM ,  YP.ca TM , Find.  &  Design TM , YellowPages.ca TM , Canada411 TM  and YP Shopwise TM  are trademarks of  Yellow Pages Digital  &  Media Solutions Limited  in Canada.All other trademarks are the property of their respective owners.  Copyright   2019  Yellow Pages Digital  &  Media Solutions Limited . All Rights Reserved. 6.12.0.0 (rev 20191210.1342) Your recent locations have been cleared 